//Aim.js

//Make all object, variables, method local to avoid clash with other libaries
//<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous">
(
    function(win){
        //Aim Finder ShortHand =>  _(selector)
       var Aim = function(selector){
           
         return Aim.Engine.Finder.Find(selector);
       }
       //AIm Requires
       Aim.Requires = {
           "w3css":"https://www.w3schools.com/w3css/4/w3.css",
           "fontawsome":"https://use.fontawesome.com/releases/v5.2.0/css/all.css"
       }
    
       var _UND = Aim.UND = "undefined",
       _Sec = Aim.Sec = 1000,//Seconds
       _Min = Aim.Min = _Sec * 60,//Minute
       _Hour = Aim.Hour = _Min * 60,//Hour
       _Day = Aim.Day = _Hour * 24,//Day
       _Week = Aim.Week = _Day * 7,//Week
       _Month = Aim.Month =  _Week * 4,//~Month
       _Year = Aim.Year = _Day * 365;//~Year
         //the requestAnimationFrame
        RequestFrame = window.requestAnimationFrame
    || window.mozRequestAnimationFrame
    || window.webkitRequestAnimationFrame
    || window.msRequestAnimationFrame
    || function(f){return setTimeout(f, 1000/60)}

       CancelFrame = window.cancelAnimationFrame
    || window.mozCancelAnimationFrame
    || window.webkitCancelAnimationFrame
    || window.msCancelAnimationFrame
    || function(requestID){clearTimeout(requestID)}

    Aim.Version = 1;

       Aim.LoadingImg = "data:image/gif;base64,R0lGODlhrAOQAfABAEHI9P///yH/C05FVFNDQVBFMi4wAwEAAAAh/wtYTVAgRGF0YVhNUDw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMy1jMDExIDY2LjE0NTY2MSwgMjAxMi8wMi8wNi0xNDo1NjoyNyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDpBNDc2NTQzMzNCNjVFMzExQTM1QkNGREZFMzIyQzQ3OCIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDo3QjU1MTExRTY1M0IxMUUzQkE3ODk5RDIxNDlGQjIxRCIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDo3QjU1MTExRDY1M0IxMUUzQkE3ODk5RDIxNDlGQjIxRCIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M2IChXaW5kb3dzKSI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkE1NzY1NDMzM0I2NUUzMTFBMzVCQ0ZERkUzMjJDNDc4IiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOkE0NzY1NDMzM0I2NUUzMTFBMzVCQ0ZERkUzMjJDNDc4Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+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";

       Aim.ErrImg = " data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAL4AAAC+CAYAAACLdLWdAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYxIDY0LjE0MDk0OSwgMjAxMC8xMi8wNy0xMDo1NzowMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNS4xIFdpbmRvd3MiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6Qzg3QkNFNjMwMDhBMTFFMkJGRDlDODYyQzJCMzcyMTciIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6Qzg3QkNFNjQwMDhBMTFFMkJGRDlDODYyQzJCMzcyMTciPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDpDODdCQ0U2MTAwOEExMUUyQkZEOUM4NjJDMkIzNzIxNyIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDpDODdCQ0U2MjAwOEExMUUyQkZEOUM4NjJDMkIzNzIxNyIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/Ptvh/WUAADD5SURBVHja7Z17vxXF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"

    

    
       
       //AIM Engine
       //************************************************* */
       //All internal aim operations will be decleard here
       //#Engine
       Aim.Engine ={
        mutationObserver:new MutationObserver(function(mutations) {
            mutations.forEach(function(mutation) {
              console.log(mutation);
            });
          }),
        //Resolve aim url (root://)
        AimUrl:function(aimurl){
          return aimurl.replace("root://",Aim.Engine.Dom.Loader.Domain)
        },
        //Create and add a stylesheet to the document loading aim
       Style:(function() {
        // Create the <style> tag
        var style = document.createElement("style");
        // WebKit hack :(
        //style.appendChild(document.createTextNode(""));
        // Add the <style> element to the page
        document.head.appendChild(style);
        //style.sheet.insertRule("body::before{content:'Loading...';position:absolute;width:100%;height:100%;z-index:10000;background-color:#EEE;font-size:1.3em;left: 0px; top: 0px; display: block}");
        return style;
        })(),
        //Aim function for adding Rule to aim style sheet
        //#AddRule
    AddRule:function(selector, rules, index) {
        
        if("insertRule" in Aim.Engine.Style.sheet) {
            index = typeof index == _.UND?Aim.Engine.Style.sheet.cssRules.length:index;
            return Aim.Engine.Style.sheet.insertRule(selector + "{" + rules + "}",index);
           
        }
        else if("addRule" in Aim.Engine.Style.sheet) {
            return Aim.Engine.Style.sheet.addRule(selector, rules,index);
        }
    },
     //Aim function for remove Rule in aim style sheet
        //#RemoveRule
        RemoveRule:function(index) {
            
            if("deleteRule" in Aim.Engine.Style.sheet) {
                Aim.Engine.Style.sheet.deleteRule(index); 
            }
            else if("removeRule" in Aim.Engine.Style.sheet) {
                return Aim.Engine.Style.sheet.removeRule(index);
            }
        },
        //Aim function to stop default effect of an event
        //should be called with return keyword
        //#StopDefault
        StopDefault:function (e)
    {
        if (e && e.preventDefault)
        {
            e.preventDefault();
        }
        else
        {
            window.event.returnValue = true;
        }
        return false;
    },
       //Global object holding functions to globalize
         GlobalMethods : [],
        //Property to hold all added template strings
        //-----------------------------------
        //hold the template string which can be filled with data using placeholder to identify data position in the template string
        //#Template
        Template:{
            //#Template.Add
            Add:function(TID,TemplateStr){
            //TID - the key of the template string in Aim.Engine.Template object
           //TemplateStr - string containing placeholder(optional) to be filled
           //NB - if TIB alredy exist in _.Template, will overwrite
           if("" != _.Trim(TemplateStr))_.Engine.Template[TID] = TemplateStr;
            },
            //Fill the placeholders of the template string with data
            //#Template.Fill
            Fill:function(TID,FillData){
            //TID - the key of the template string in Aim.Engine.Template object
            //FillData - the object containing key=>data to fill, (key-placeholder name, data - data to replace)
                if(typeof _.Engine.Template[TID] == _.UND)return ""; //if no such template exist return empty string
                var rtn = _.Engine.Template[TID]; 
            if(_.IsObject(FillData)){ //if filldata is an object
                for (var key in FillData) { //loop through all the data and replace in template string, searching using the filldata key and replace placeholder
                    //NB- placeholder are enclosed with {{placeholder}}
                    if (FillData.hasOwnProperty(key)) {
                        var element = FillData[key].toString();
                        //replace placeholder with data
                        rtn = _.Replace('{{'+key+'}}',element,rtn);
                    }
                }
                //when done filling all data return the resultant filled string
                return rtn;
            }else if(_.IsArray(FillData)){ //if an array of filldata sent
                //maening template need to be fill repeatedly e.g (loading a select element with option htmls)
                var arrrtn = "";
                for(var ss=0; ss<FillData.length ; ss++){ //loop through all fill data
                    //perform filling operation by calling same function, the form a comprehensive fill string
                    arrrtn += _.Engine.Template.Fill(TID,FillData[ss]); 
                }
                return arrrtn;
            }else{ //if filldata is not a valid type return template string
                return _.Engine.Template[TID];
            }
        }
        },
        
       

        //Replace all ocurence of a search string in a string
        //#Replace
       Replace:function(strSearch,strReplace,str){
           //strSearch - the search string to replace - Required
           //strReplace - the string to replace search string - Required
           //str - the domain string - string where the replacement will be done (Array Allowed) - Required
          
        if(_.IsArray(str)){ //if is an array replace in all item of the array
          var newstr = [];
          for(var ns=0; nsMstr.length; ns++){
             var rplstr = _.Engine.Replace(strSearch,strReplace,str[ns]);
             if(_.IsArray(rplstr))newstr = newstr.concat(rplstr);
             if(_.IsString(rplstr))newstr.push(rplstr);
          }
          return newstr;
        }else{
            var newstr = "";
str = str.toString()
            if(_.Trim(str) != ""){
                var strarr = str.split(strSearch);
                newstr = strarr.join(strReplace);
            }
        }
        
        return newstr;
    },

       //function to return the actual type of supplied object
        //----------------------------------------
        //main advantage is, it checks array and return as array type not conventional javascript object type
        //#CheckType
        CheckType:function(obj){
            var tp = "";
            //obj - Holds the object/Element to Check Type - Required
            if(typeof obj == _UND || obj == null) return null; //if obj is null or not supplied return null
            //Check if obj is not a string and can have children 
            if (typeof obj != "string" && typeof obj.length != _UND ){
                if (Array.isArray){ //if isArray is supported
                  tp = Array.isArray(obj)?'array':typeof obj;
                }else{
                    try{ //Check if it is an array, by running native array function on the Obj. if no error occur, return 'array' else return the type of the element/Argurment
                        var a = obj.sort();
                        var b = obj.slice(0);
                        tp = "array"
                    }catch(e){
                        tp = typeof obj;
                    }
                }
            }else{ 
                tp = typeof obj;
            }
            //check if it is html element
            if(tp.toLowerCase() == "object"){
                tp =(typeof obj.tagName != _.UND)?"element":tp;
            }
            return tp;
        },

        //The Working Include, Include allow extending the functionality of Aim
        //----------------------------------------------------------------------
        //#Include
        Include:function(inc,obase){
         //obase - the base object to add or extend property or method(functionality) (Array Allowed)
         //NB- if obase is an array add to all item of the obase reculsively
         //inc - the object containing all method/properties(functionality) to be added
         obase = (typeof obase == _.UND || obase == null)?Aim:obase; //if no obase supplied us aim
         if(typeof inc == _.UND) return obase; //if no functionality supplied return the base object

         //if obase is an array, include all functionality to all the obase item
         if(Aim.Engine.CheckType(obase) == "array"){ 
            for(var ob=0; ob<obase.length; ob++){
               Aim.Engine.Include(inc,obase[ob]);
            }
        }else if(Aim.Engine.CheckType(obase) == "string"){ //if obase is string
          //get the element(s) and perform include
          Aim.Engine.Include(inc,Aim(obase));
        }else{ //assume is an object
         for (var key in inc) {
             if (inc.hasOwnProperty(key)) {
                 //alert(inc[key])
                 var element = inc[key];
                    obase[key] = element; //inludes the functionality to Aim
                 
             }
         }
        }
          //Aim[inc.Name] = Aim.prototype[inc.Name] = inc.Value;
          //Object.prototype[inc.Name] = inc.Value;
        },

        //adding methods to global base objects, (String, Array, Object, Function)
        /* "Value".Globalize({
    set:function(val){_.Value(This(this),val);},
    get:function(){return _.Value(This(this));}
},[Array,Object,String]); */

        //--------------------------------------------------------
        Globalize:function(BaseObject,nam,func){
           // alert(nam);
             for(var d=0; d<BaseObject.length; d++){
                if(_.IsFunction(func)){   
                BaseObject[d].prototype[nam] = func;
                }else if(_.IsObject(func)){
                 Object.defineProperty(BaseObject[d].prototype,nam,func);
                }else{
                    _.Include({
                        nam:func
                    });
                }
             }
        },


        


        //function to return element if parameter is either the elemnt or ID(Resolve Parameter)
        //-----------------------------------------------------------------
        //#RP
        RP:function(parameter){
            if(typeof(parameter) == "object"){
                return parameter;
            }else if(typeof(parameter) == "string"){
                //return document.getElementById(parameter)
                return _(parameter);
            }
    },


    //process/render response from aim server (NB:everey response from server is expected to be a json string)
    //#Server
    Server:function(response){
        
            var res;
            try {
                
                 res = JSON.parse(response);
                // _.Log(response);
                
                 if(typeof res.Error != _.UND){
                     res['HasError'] = true;
                 }else{
                     //alert(response);
                    //alert(res['UseData'])
                     res['Data'] = typeof res['Data'] == _.UND || res['Data'].Trim() == ""?{}:JSON.parse(res['Data']);
                 }

            } catch (error) {
                //alert(response)
               // _.Log(response);
                res = {"HasError":true,"Error":{"Code":"SV01","Message":"Invalid Server Response - "+response,"Abort":true}}
            }
            return res;
        },

        
    

    //#IsSet
    IsSet :function(variable){
        //alert(variable)
        return (typeof variable == _.UND)?false:true;
    },
   

    //return the textContent/value of any supplied object
    //-----------------------------------------------------------------
    //#Text
    Text :function(objs,set,optionval){
         //objs - the object to get its textContent or value (string - classname, id, tagname, css selector | object - DOM Object | array - array items could be string,object or both) - Required
         //set - if set, set the textContent or value(input) of the objs
         //optionval - determine if select option value or textContent is to be set or gotten
        //NB: false=>textContent (default); true=>value
        optionval = typeof optionval == _.UND?false:optionval;
            objs = _.Engine.RP(objs);//get the element to referense the textContent or value
            
            if(_.IsArray(objs)){
                
                //if array of object found
                var newarr = new Array(); //this empty array will hold the value/textContent of each element
                for(var s=0; s < objs.length ; s++){ //loop through all the array object
                    //if null just move to the next element
                    if(_.IsNull(objs[s])){continue;}
                    //run a recursive call
                    var rtn = _.Engine.Text(objs[s],set,optionval);
                    //if array return just concatinate it
                    if(_.IsArray(rtn)){ 
                        newarr =  newarr.concat(rtn);
                    }else{ //else if just a string(textContent or value) add to the array
                        newarr.push(rtn);
                    }
                }
                return newarr;
            }else if(_.IsObject(objs)){ //if element is an object
                
                if(typeof objs.options != _.UND){// if it is a select element
                    //get the textContent of the selected option
                    //NB - to get the selected option value, Use _.Value(---);

                    if(!optionval){ //if select option textcontent is to be used
                    //if the text content is supply, i.e a set operation set it before returning
                    if(typeof(set) != _.UND && set != null){
                        //change the text Content of the Selected Option
                        objs.options[objs.selectedIndex].textContent = set.toString()}
                    return typeof objs.options[objs.selectedIndex] != _.UND?objs.options[objs.selectedIndex].textContent:set;
                    }else{ //if select option value is to be used
                        if(typeof(set) != _.UND && set != null){
                            //change the text Content of the Selected Option
                            objs.value = set.toString()}
                        return typeof objs.options[objs.selectedIndex] != _.UND?objs.options[objs.selectedIndex].value:set;
                    }
                }else if(typeof(objs.value) != _.UND){ //if it is an input element or elment that has value attribute
                    //_.Log(objs.type);
                    //if the value is supply, i.e a set operation set it befor returning
                if(typeof(set) != _.UND  && set != null){objs.value = set.toString()}
                //if radio button or checkbox
                if(_.IsElement(objs) && objs.tagName.toLowerCase() == "input" && (objs.type.toLowerCase() == "checkbox" || objs.type.toLowerCase() == "radio")){
                    
                    /*if(!objs.checked){ //if not selected
                        return null;
                    }*/
                    return objs.checked;
                }
                return objs.value;
                }else if(typeof(objs) != _.UND){
                    
                    //if the textContent is supply, i.e a set operation set it befor returning
                    if(typeof(set) != _.UND  && set != null){objs.textContent = set.toString()}
                    
                    return objs.textContent
                }
            }else{
                return "";
            }
	
},


    //Internal Function to perform string trimimg operation
    //(LeftTrim, RightTrim, Character Trim e.t.c)
    //-----------------------------------------------------
    //#StrTrimDir
    StrTrimDir:function(val,n,dir){
        //val - represent the object to trim (string,number,object,DOM object) (Array allowed) - Required
    //n - represent the number of character or string to trim (Array allowed)
    //NB - if n not set, trim spaces
	//dir - represent the trim direction i.e right - r or left - l or both - b

	n = typeof n == _.UND?null:n;
	dir = typeof dir == _.UND?'b':dir; 
  if(_.IsString(val)){ //if is a string
	if(_.IsNull(n)){ //if n is null i.e no number of trim item sent, trim spaces only
		if(dir == "r"){ //if direction is right
		return val.replace(/\s+$/g,''); //trim all leading(right) white spaces
		}else if(dir == "l"){ //if direction is left
		return val.replace(/^\s+/g,''); //trim all trailing(left) white spaces	
		}else{
		return val.replace(/^\s+|\s+$/g,'');
		}
	}
	if(_.IsNumber(n)){ //if n is sent and is number
	  if (val != null && val.length > n){ //if the string to trim is greater than the number of character to trim
		  if(dir == "r"){ //if to trim right
		  val = val.substr(0,val.length-n); //trim n number of character from the right
		 }else if(dir == "l"){//if to trim left characters
			val = val.substr(n);
			//val = val.substr(n,val.length-n); 
		  }else{//if to trim both left and right characters
			if(val.length > n * 2){ //if the total character length if greater than the total removable character (n X 2)
			val = val.substr(n,val.length-(n * 2));
			}else{
				//return empty string if the total removable character is greater than or equals to the character length, meaning all character are trimed
				return "";
			}
		  }
	  }else{//if the total number of character to trim is greater than the real string return empty string
		val = "";  
	  }
	  return val; //return the resultant string
	}
	if(_.IsString(n)){ //if n  is a string trim the string
		var strlen = n.length; // get the lenght of the string to trim off
		if(strlen > val.length)return val; //if the trim lenght is greater than the real string, return back the string
		var lststr_r = ""; //the right trimable character
		var lststr_l = ""; //the left trimable character
		 if(dir == "r" || dir == "b"){//if to trim string from right or both
		//get last part of the string
		 lststr_r = val.substr(val.length - strlen,strlen);
		 }
		 if(dir == "l" || dir == "b"){//if to trim from left or both
           //get first part of the string
		 lststr_l = val.substr(0,strlen); 
		 }
		
			if((dir == "r" || dir == "b") && lststr_r == n){ //if right trim or both and right trimable character is same as sent trim character
				//return the trimed string
			val = val.substr(0,val.length - strlen);
			}
			
			if((dir == "l" || dir == "b") && lststr_l == n){//if left trim or both and left trimable character is same as sent trim character
			//return val.substr(strlen,val.length - strlen);
			val = val.substr(strlen);
			}
		
		return val;
	}
	if(_.IsArray(n)){ //if n is an array, meaning loop through all the item of n and use each item to run the trim function.
       for(var s=0;s<n.length;s++){
		   val = _.Engine.StrTrimDir(val,n[s],dir);//update val to the new trimed val
	   }
	   return val;
	}
	//if n is not any of the above checked type, just return val
	return val;
  }else if(_.IsArray(val)){//if val sent is an array, perform the trim on all elements of the array and return an array of trimed items
		var  newarr = new Array();
		if(val.length > 0){
			for(var a=0; a<val.length; a++){
			 var strtrim = _.Engine.StrTrimDir(val[a],n,dir);
			 //if an array returned after trim just concatinate it to the result array
			  if(_.IsArray(strtrim))newarr=newarr.concat(strtrim);
			  //if a string is returned after trim, add it to the result array
			  if(_.IsString(strtrim))newarr.push(strtrim);	
			}
			
		}
		return newarr;
		
  }else if(_.IsObject(val)){ //if an object
	//perform trim on its text element (input - value, block elemet- textContent)
	  return _.Engine.StrTrimDir(_.Text(val),n,dir);
  }	
        
    },


    //Handle phone number validation
    //----------------------------------
    //#ChkPhoneNum
    ChkPhoneNum:function(number, mindigit, maxdigit){
        //number - the number to check its validity (Array Allowed)
        //NB - if number is an array, check if all the items of the array are valid phone number
        //NB - if number is DOM object, perform check on its textContent / value(input)
        //mindigit - minimum number of of digit expected - default => 6
        //maxdigit - maximum number of of digit expected - default => 15
        mindigit = typeof mindigit == _.UND?6:mindigit;
        maxdigit = typeof maxdigit == _.UND?15:maxdigit;
        
        if(_.IsString(number)){ //if is sent as a string
            if("" == _.Trim(number))return false;
            //trim out special phone prefix
            number = number.TrimLeft(["+","-"]); //TrimLeft function trim leading character
            //Check if all character is a digit
            for(var s=0; s <number.length; s++){ //loop through all characters
                var char = number[s]; //get current character
                //if(typeof parseInt(char) == "NaN"){
                    if(isNaN(parseInt(char))){ //check if not an integer number
                        return false; //return false; meaning not a valid phone number
                    }
                //}
            }
            //check if number is between 6 to 15 digit(Can be modified to cater for any range) - idea => it will be beter if it is dynamic user defined
            if(number.length >= mindigit && number.length <= maxdigit){
                return true;
            }else{
                return false;
            }
        }else if(_.IsNumber(number)){ //if argument sent is a numeric
            //convert to string and rerun the function on it
            return _.Engine.ChkPhoneNum(number.toString(), mindigit, maxdigit);
        }else if(_.IsArray(number)){ //if the number sent is an array of items
            if(0 == number.length)return false; //if array is empty return false
            for(var cp=0; cp<number.length; cp++){ //loop through all item of the array and run reculsively.
                if(_.Engine.ChkPhoneNum(number[cp], mindigit, maxdigit) == false){
                    //if any of the array item is an invalid phone number return false
                    return false;
                }
            }
            //if no invalid phone number found, return true
            return true;
        }else{ //if not any of the above tested type (assume is an object)
            var objtxt = _.Text(number); //get the textContent or value as required
            if(objtxt == "")return false; //if notting gotten, return false (invalid)

            //Check if valid phone number and return as required
            return _.Engine.ChkPhoneNum(objtxt, mindigit, maxdigit);
        }
    },

    //Handles Email Address Validation
    //-------------------------------------------
    //#ChkEmail
ChkEmail:function(obj){
	//obj - holds the user sent email (string, object) (Array Allowed)
   
    if(_.IsArray(obj)){
        //if obj is an array, check if all the items of the array are valid email address
        for (var index = 0; index < obj.length; index++) {
            var element = obj[index];
            if(!_.Engine.ChkEmail(element)){
               return false
            }
        }
        return true;
    }else if(_.IsObject(obj)){
        //if obj is an object, check if the textContent or value(input) is a valid email address
        return _.Engine.ChkEmail(_.Text(obj));
    }else if(_.IsString(obj)){ //if obj is string
        if("" == _.Trim(obj))return false; //if obj is empty return false
        var regexp = /^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/
        var test = regexp.test(obj);//test if sent email string matches the email regexp 
        return test;
    }else{
        return false;
    }
	
	
},

//check if valid date
IsDate:function(dob,sep){
		sep = sep || ["/","\\","-"," ","_"]
		sep = !_.IsArray(sep)?[sep]:sep;
		var dobarr = [];
		for(var se=0;se<sep.length;se++){
			 dobarr = dob.split("/");
			 if(dobarr.length == 3)break;
		}
		
	  if(dobarr.length != 3){ //check invalid date of birth patern
		  return "Wrong Date";
	  }
	  //check day
	  var dd = parseInt(dobarr[0],10);
	  if(isNaN(dd)){
		  return "Wrong Day";
	  }
	  if(dd < 1 || dd > 31){
		  return "Wrong Day";
	  }
	  //check month
	  var mm = parseInt(dobarr[1],10);
	  if(isNaN(mm)){
		  return "Wrong Month";
	  }
	  if(mm < 1 || mm > 12){
		  return "Wrong Month";
	  }
	  //check year
	  /*var yy = parseInt(dobarr[2],10);
	   if(isNaN(yy)){
		  return "Wrong Year";
	  }
	  if(dobarr[2].length != 2 && dobarr[2].length != 4){
		  return "Wrong Year";
	  }*/
	  var isy = _.Engine.IsYear(dobarr[2]);
	  if(isy !== true)return isy;
	  return true;	
    },
    //check if a valid year
    IsYear:function(year){
		 var yy = parseInt(year,10);
	   if(isNaN(yy)){
		  return "Wrong Year";
	  }
	  if(year.length != 2 && year.length != 4){
		  return "Wrong Year";
	  }
		return true;
	},


//#Validate
Validate:function(input){
   // alert('ssss');
  input = _.Engine.RP(input);
  var rt = true;
  if(_.IsFound(input)){
     input = _.IsArray(input)?input:[input];
     
     for(var sj=0;sj<input.length;sj++){
         inpelem = input[sj];
         var fdescr = typeof inpelem.placeholder != _.UND && inpelem.placeholder.Trim() != ""?inpelem.placeholder+" - ":typeof inpelem.title != _.UND && inpelem.title.Trim() != ""?inpelem.title+" - ":"";
         //check if required
         if(typeof inpelem.required != _.UND && (inpelem.required == true || inpelem.InClass('aim-input-required')) && inpelem.Value.Trim() == ""){
           
             return fdescr+" field is required";
         }
         //check required filepicker
         if(inpelem.InClass('aim-filepicker') && inpelem.InClass('aim-input-required') && _.Attribute(inpelem,'aim-filepicker-loaded') == "false"){
             //alert(inpelem.required)
            return "File upload required";
         }
         /*if(_.IsFound(_(inpelem.ID+'_file')) && _(inpelem.ID+'_file').value.Trim() == ""){

         }*/
        
         //check email
         if((inpelem.InClass("aim-input-email") || (typeof inpelem.type != _.UND && inpelem.type.toLowerCase() == "email")) && !_.IsEmail(inpelem.Text) && inpelem.Text.Trim() != ""){
             return fdescr+"Invalid email address supplied";
         }
         //check phone
         if((inpelem.InClass("aim-input-phone") || (typeof inpelem.type != _.UND && inpelem.type.toLowerCase() == "tel")) && !_.IsPhoneNumber(inpelem.Text)  && inpelem.Text.Trim() != ""){
            return fdescr+"Invalid phone number supplied ";
        }

        //check date
        if((inpelem.InClass("aim-input-date") || (typeof inpelem.type != _.UND && inpelem.type.toLowerCase() == "date")) && _.IsDate(inpelem.Text) !== true && inpelem.Text.Trim() != ""){
            return fdescr+"Invalid date supplied ";
        }

        //check aim filepicker

     }
  }
  return rt;
},

//This function create a copy of an element
//#Cloner
Cloner:function(elems,withevent,deep){
    withevent = withevent || false;
    deep = deep || true;
    
    var EventAsigner = function(oldelem,newelem){
        var eventassigns = _.Engine.Handlers.Assigns;
         //get event assigned to elem using aim assign
         if(typeof eventassigns[oldelem.ID] != _.UND){
            var elemfuncs = eventassigns[oldelem.ID];
            
               for (var elemev in elemfuncs) {
                   if (elemfuncs.hasOwnProperty(elemev)) {
                       var funarr= elemfuncs[elemev];
                       var clen = funarr.length + 0;
                       //alert(funarr.length); 
                       //assign all the function to the clone element
                       for(var cnt = 0;cnt<clen;cnt++){
                           //_.Log(clen);
                        //_.Log(newelem.ID + " : "+elemev+ " : "+funarr[cnt]);
                        //newelem.addEventListener(elemev, funarr[cnt],false);
                        //_.Engine.Handlers.Assigns[element.ID][eventName].push(rhandler);
                        
                        _.Assign(elemev,newelem,funarr[cnt],false,false);
                       }
                   }
               }
           }
           return true;
    }
    elem = _.Engine.RP(elems);
    if(_.IsFound(elem)){ //if element found
        if(_.IsArray(elem)){ //if multiple element found
            //copy each and form array of clone elements
           var rtnarr = [];
           for(var ss=0;ss<elem.length;ss++){
               var newclone = elem[ss].cloneNode(deep);
               if(withevent)EventAsigner(elem[ss],newclone);
            rtnarr.push(newclone);

           }
           return rtnarr;
        }else{
           var newclone= elem.cloneNode(deep); 
           if(withevent)EventAsigner(elem,newclone);
          // if(withevent)_.Log("old:"+elem.ID+" new:"+newclone.ID);
           return newclone;
        }
    }else{
        return elems;
    }
    
    
},

//This function replace an element or node with another element or node
ReplaceWith:function(oldelem,newelem){
  oldelem = _.Engine.RP(oldelem); //get the element(s) to be replaced
  if(_.IsFound(oldelem)){ //if element to be replace exist
    newelem = _.Engine.RP(newelem); //get the new element
    if(_.IsFound(newelem)){ //if new element exist
        //make them array format if not
    oldelem = _.IsArray(oldelem)?oldelem:[oldelem];
    newelem = _.IsArray(newelem)?newelem:[newelem];
    //loop through all old and replace with new of same array index (if new not exist in the index use the last new)
    for(var re=0;re<oldelem.length;re++){
        var indoldelem = oldelem[re];
        //get the new in the new array with the current index
        var indnewelem = newelem[re];
        if(typeof indnewelem == _.UND)indnewelem = newelem[newelem.length - 1]; //if new does not exixt for the current index use the last
        //_.Log(indoldelem.id)
        //replace the old element with the new
        indoldelem.parentElement.replaceChild(indnewelem,indoldelem);
    }
    }
    
  }
},

    //This function displays or hides the element (CSS display)
    //#ShowHide
    ShowHide:function (ID,Show,display){
        
        //ID - Holds the Element or its id - Required (Array allowed)
        //NB - if array, perform the showhide operation on all the item of the array
        //Show - Holds which operation to perform on the Element (1 => Show, 0 => Hide, Any Other Value => Toggle) - Required
        //display - Holds the Element CSS display value ('block','inline','inline-block','table' e.t.c) - Default => 'block' (true = 'block', false = 'inline')
        display = (typeof display == _.UND || display === true)?"block":(display === false)?"inline":display; //handles the default setting of display argurment
        if(!_.IsObject(ID)){
        ID = _.Engine.RP(ID); //RP - Make Sure the ID is an element (cos ID can either be an element or the element ID)
        }
        if(ID == null)return; //if cannot get the element stop operation

        //If elem is an array, perform a recursive function call on all the element of the array
        if(_.IsArray(ID)){
           for(var s=0; s<ID.length; s++){
               _.Engine.ShowHide(ID[s],Show,display);
           }
        }else{
            if (Show == 1){ //if to display
                if(typeof ID.style != _.UND)ID.style.display = display; //set the css display attribute of the element to its display type
            }else if (Show == 0){
                //if to hide, set to none
                if(typeof ID.style != _.UND)ID.style.display = 'none';
            }else{ //toggle
                if(typeof ID.style != _.UND)ID.style.display = ID.style.display == 'none'?display:'none';
            }
        }
    },

     //This function displays or hides the element (CSS visibility)
    //#VisibleHide
    VisibleHide:function (ID,Show){
        //ID - Holds the Element or its id - Required (Array allowed)
        //NB - if array, perform the Visiblehide operation on all the item of the array
        //Show - Holds which operation to perform on the Element (1 => Visible, 0 => Hide, Any Other Value => Toggle) - Required
        
        if(!_.IsObject(ID)){
        ID = _.Engine.RP(ID); //RP - Make Sure the ID is an element (cos ID can either be an element or the element ID)
        }
        if(ID == null)return; //if cannot get the element stop operation

        //If elem is an array, perform a recursive function call on all the element of the array
        if(_.IsArray(ID)){
           for(var s=0; s<ID.length; s++){
               _.Engine.VisibleHide(ID[s],Show);
           }
        }else{
            if (Show == 1){ //if to make visible
                if(typeof ID.style != _.UND)ID.style.visibility = 'visible'; //set the css visibility attribute to visible
            }else if (Show == 0){
                //if to hide, set to hidden
                if(typeof ID.style != _.UND)ID.style.visibility = 'hidden';
            }else{ //toggle
                if(typeof ID.style != _.UND)ID.style.visibility = ID.style.visibility == 'hidden'?'visible':'hidden';
            }
        }
    },


    //Checks if an array , object or string contain items
    //#HasItem
  HasItem:function(obj,strict){
    strict = typeof strict == _.UND?true:strict;
      //obj - the object to check if it contain items in it
     //strict - ignore spaces while counting string character and count elements not nodes while counting dom object items - Default - true
     if(typeof obj == _.UND || obj == null)return false;
	if(_.IsArray(obj)){ //if an array check the length
		// alert(obj.length);
		return (obj.length > 0)?true:false;
	}else if(_.IsString(obj)){ //if is string
        obj = strict?_.Trim(obj):obj; //trim all surounding spaces if strict mode
        return (obj != "")?true:false;
		
    }else{ //assume to be Object
        //DOM Element
		if(typeof(obj.childNodes) != _.UND){
            //get the element children in strict mode ; the childNodes if not in strict mode
            var childlen = strict?obj.children.length:obj.childNodes.length 
            return (childlen > 0)?true:false;
        //if not a DOM element
		}else if(typeof(obj.length) != _.UND){ //if has .length
		 return (obj.length > 0)?true:false;
		}else{
			return false;
		}
	}
  },

    //Check if suplied object / item exist in the base item
    //return false, if obj not exist in base item
    //return obj key in base item, if exist
    //#InItem
    InItem:function(base,obj,deep){
       //arr - the lookup item to check existence from
       //obj - the object to check if exist in arr
       //deep - if to do a deep search, i.e incase of nexted array found - default - false
       if(typeof base == _.UND || _.IsNull(base) || !_.HasItem(base,false))return false;
       var arr = base;
       if(_.IsString(obj) && !_.HasItem(obj,false))return false; //if the search object is a string and is empty
       deep = typeof deep === _.UND?false:deep; //set deep default
       //if searching an array
       if(_.IsArray(arr)){
           //if array has no item return false
           if(arr.length < 1)return false;
           //look for obj in array (first look up)
         var ind = arr.indexOf(obj);
         if(ind > -1)return ind; //if object exist return the index
         if(deep){ //if not found and deep search mode is set
           //loop through the array
           for(ae=0; ae<arr.length; ae++){
              var arrelem = arr[ae];
              //still check if object exist and return the index
              if(arrelem == obj) return ae;
              if(_.IsArray(arrelem)){ //if a nexted array
                var overallInd = ae; //keep the current array level index
                //perform a check on the nexted array
                 var nxtae = _.Engine.InItem(arrelem,obj,deep);
                 if(nxtae !== false){ //if obj found in nexted array
                    //form an overall search indexes (concatinated with _)
                    overallInd += "_"+nxtae;
                    return overallInd;
                 }
              }
           }
           //if not found after looping through all the arrays
           return false;
         }else{ //if not deep search
           return false;
         }
       }else if(_.IsString(arr)){ //if searching a String
         //if the obj is a string
         if(_.IsString(obj)){
             var ind = arr.indexOf(obj);
             return ind < 0?false:ind;
         }else if(_.IsObject(obj)){ //if search obj is an object
            //get the Text
            var txt = _.Text(obj);
            if(txt == "")return false; //if no text content or value found return false
            var ind = arr.indexOf(txt);
            return ind < 0?false:ind;
         }else if(_.IsArray(obj)){
             //loop through all the search object and perform the Search
             //if any of the object does not exist in base string, return false
             var indarr = []; //array to hold index of all found obj
             for (var index = 0; index < obj.length; index++) {
                 var objell = obj[index];
                 var srst = _.Engine.InItem(arr,objell,deep); //check if the obj item exist
                 if(srst === false) return false; //if not return false
                 indarr.push(srst); //add to the dound index array
             }
             return indarr; //if all obj exist in string, return array of there index
         }else{
             //any other obj type, just convert to string and perform the search
            return _.Engine.InItem(arr,obj.toString(),deep);  
         }
       }else if(_.IsObject(arr)){ //if searching an Object
        //get all child nodes
        var arrChildndes = arr.childNodes;
        if(arrChildndes.length < 1)return false;
        for(var dd=0; dd<arrChildndes.length; dd++){
            var currChild = arrChildndes[dd];
            //if the obj is a string
            if(_.IsString(obj)){
                if(_.Text(currChild) == obj)return dd;
            }else if(_.IsObject(obj)){
                if(currChild == obj)return dd;
            }else if(_.IsArray(obj)){
                var indarr = []; //array to hold index of all found obj
                for (var index = 0; index < obj.length; index++) {
                    var objell = obj[index];
                    var srst = _.Engine.InItem(currChild,objell,deep); //check if the obj item exist
                    if(srst === false){ indarr = []; break;} //if not return false
                    indarr.push(srst); //add to the dound index array
                }
                if(indarr.length > 0)return indarr; //if all obj exist in currChild, return array of there indexes
                
            }else{ //unknown obj type (convert to string and check)
                if(_.Text(currChild) == obj.toString())return dd;
            }
            //if not the curent child
            //try deep search on currChild
            if(deep){
                var deeprst = _.Engine.InItem(currChild,obj,deep);
                if(deeprst !== false)return dd+"_"+deeprst;
            }
        }
        //if not exist in arr
        return false   

       }else{ //unknown arr type (convert to string and check)
             return _.Engine.InItem(arr.toString(),obj,deep);
       }
    },

    //function to combine all argument into one array
    //#Merge
    Merge:function(arguments){
        
        var merge = [];
        if(arguments.length < 1)return merge; //if no item send
        
        var items = arguments;
        if(items.length == 1){ //if only one argument sent
            
                items =  items[0];  
                if(typeof items.length == _.UND)return items;
        }
        //alert(items)
        //loop through all items, check if array concatinate, else add to merge array
        for (var index = 0; index < items.length; index++) {
            var element = items[index];
            if(_.IsArray(element)){
                
                if(_.HasItem(element))merge = merge.concat(element);
                //alert(merge);
            }else{
                merge.push(element);
            }
        }
        return merge;
    },

    //function to resolve array, making sure all element of the array contain valid value and there are no duplicate
    //#ArrayExact
    ArrayExact:function(arrayobj,strict){
    //arrayobj - the array tperform operation on
    //strict - false (default) - only dupliacte; true - and null, empty string
    strict = typeof strict == _.UND?false:true;
    if(_.IsArray(arrayobj) && _.HasItem(arrayobj)){
        //use the array filter function if latest browser
       // if(typeof arrayobj.filter != _.UND){
        return arrayobj.filter(function(val,ind,arr){
            //check duplicate if not null and not an empty string and not an empty array or a valid object

            /*alert("Index:" + ind);
            if(val == title2){
                alert("seen:" + ind)
            }*/
            if(this.strict){
            return (arr.indexOf(val) === ind && !_.IsNull(val) && (((_.IsString(val) || _.IsArray(val)) && _.HasItem(val)) || _.IsObject(val)));
            }else{
                return (arr.indexOf(val) === ind)  
            }
        },{strict:strict});
    //}

    //Older browser
       /* var rtnarr = new Array();
        //if(typeof num == "undefined"){
          for(var f=0; f<arrayobj.length;f++){
             var val =  arrayobj[f];
             //check if not null and not an empty string and not an empty array or a valid object
             if(strict){
             if(arrayobj.indexOf(val) === f && !_.IsNull(val) && (((_.IsString(val) || _.IsArray(val)) && _.HasItem(val)) || _.IsObject(val))){
                 rtnarr[rtnarr.length] = val;
             }
            }else{
                if(arrayobj.indexOf(val) === f){
                    rtnarr[rtnarr.length] = val;
                }
            }
          }
        return rtnarr;*/
    }else{
       return arrayobj; 
    }
    },

    //Get the common item of two or more arrays sent as argurment
    //#Intersect
    Intersect:function(arguments){
        
       if(arguments.length < 1)return []; //if no arguments sent retuen emty array
       if(arguments.length == 1){ //if only one
        //find the common item of  
           /*if(_.IsArray(arguments[0])){
           //check for return duplicate items as intersect
            
                return arguments[0].filter(function(val,ind,arr){
                     //check for coomon items
                     return (arr.indexOf(val) != arr.lastIndexOf(val))
                }).Exact(true); //remove duplicate, null and empty string
            
           }else{
               return arguments[0]; 
           }*/
           
           arguments = arguments[0];
       }//else{
           //if to find interset betwen 2 or more array
          // alert(arguments.length)
           //get the first array
           //NB - make array if not array
           var ints = _.IsArray(arguments[0])?arguments[0]:[arguments[0]];

           //loop through other array
           for(var f=1; f<arguments.length; f++){
               //get the next arry
               var curit = _.IsArray(arguments[f])?arguments[f]:[arguments[f]];
               //if no intersect seen return empty array
               if(!_.HasItem(ints))return [];
               //alert(ints.toString() + " ; "+ curit.toString());
              // if(_.IsArray(ints)){
                  //return all value of curent formed intersecton array that exist in the new test array
               ints = ints.filter(function(val,ind,arr){
                   rtnval = _.Contains(this.arr,val);
                      return rtnval === false?false:true;
               },{arr:curit});
              // alert(ints)
            //}
           }
           //return the intersections found, removing all duplicate and null and emptystrings
           return ints.Exact(true);
      // }

    },

    //function to subtract array item from base array
    //NB - the resultant array is the base array after subtract array items found are removed
    //NB - Lookup in Base Array only
    Subtract :function(){

    },

    //function to perform differnce operation on arrays
    //#Difference
    Difference : function(arrelems){
        //alert(arrelems);
        if(arrelems.length < 1)return [];
       // if(arrelems.length == 1)return arrelems;
       // var mainelem = arrelems[0]; //the first operand
      //  for(var d=1; d <arrelems.length; d++){
           arrelems = arrelems.length == 1?arrelems[0]:arrelems;
            //new pertern
            //////////////////////////////
            var union = _.Union(arrelems); //get the union of the first and second
            //alert('Union =>' + union)
            var int = _.Intersect(arrelems); //get the intersection of the first and second
            //alert('Intersection =>' + int)
            //subtract the intersection from the union and set as first
            mainelem = union.filter(function(val,ind,arr){
                 var seen = this.intarr.Contains(val);
                return seen === false?true:false; //return item that are not in itersection
             },{intarr:int});
             return mainelem;
           // alert('Diff =>' +mainelem);
            //////////////////////////
             
        //}
        
   //return mainelem;
        
    },

    //convert Number to monitary string
    ToMoney:function(num,addzeros){
       /*  _.Log("num :"+num);
        _.Log("num.toString() :"+num.toString());
        _.Log("num.toString().Replace(\",\",\"\") :"+num.toString().Replace(",",""));
        _.Log("num.toString().Replace(\",\",\"\").ToNumber() :"+num.toString().Replace(",","").ToNumber());
        _.Log("num.toString().Replace(\",\",\"\").ToNumber().toFixed(2) :"+num.toString().Replace(",","").ToNumber().toFixed(2));
        _.Log("num.toString().Replace(\",\",\"\").ToNumber().toFixed(2).ToNumber() :"+num.toString().Replace(",","").ToNumber().toFixed(2).ToNumber());
        _.Log("num.toString().Replace(\",\",\"\").ToNumber().toFixed(2).ToNumber().toLocaleString() :"+num.toString().Replace(",","").ToNumber().toFixed(2).ToNumber().toLocaleString()); */
//breakdown the fractionanl part
var strs = num.toString().Replace(",","");

var frp = strs.split(".");
      // rtnval = num.toString().Replace(",","").ToNumber().toFixed(2).ToNumber().toLocaleString();
       rtnval = frp[0].ToNumber().toFixed(2).ToNumber().toLocaleString();
      
if(frp.length > 1){
    dp = frp[1];
//dp = Math.round()
    rtnval += "."+dp;
    //_.Log(rtnval);
}
      //rtnval = num.toString().replace(/[^\d]/g,'').replace(/(\d\d?)$/,'.$1');
      if(typeof addzeros == _.UND || addzeros == false){
          return rtnval; 
      }else{
        //_.Log(rtnval);
        rtnval = rtnval.Replace(",","").ToNumber().toLocaleString(undefined,{maximumFractionDigits: 2});
      rtnarr = rtnval.split(".");
        return rtnarr.length > 1?rtnval:rtnval+".00";
      }
       
       
    },

    //Convert obj to Array type
    //#ToArray
    ToArray:function(obj,delimiter,innerdelimeter,keyType){
        //obj => item to convert to array
        //delimiter => hold the string delimiter that joins onj items
        //innerdelimeter => delimiter that joins key and value of individual obj items
        //keyType => the type of key to return
        //0=>Asscociate key ; 1=>Numeric key; 2=>Both(default)
        delimiter = typeof delimiter == _.UND?"":delimiter;
        innerdelimeter = typeof innerdelimeter == _.UND?"":innerdelimeter;
        keyType = typeof keyType == _.UND?2:keyType;
        var newarr = [];
        if(obj == null)return newarr;
        
        //if obj is a string break individual characters to array
        if(_.IsString(obj)){
            if(obj.Trim() == "")return [];
        if(delimiter == ""){
            for(var s=0 ; s<obj.length; s++){
              newarr.push(obj[s]);	
            }
        }else{
            //if split delimeter exist split string to form array
            var brarr = obj.split(delimiter).Exact();

            //if no key - value delimiter, return the formed array
            if(innerdelimeter == "")return brarr;
            
            //if items found
            if(brarr.length > 0){
                //loop through all items and break individual string to get key and value, using the innerdelimeter
                for(var s=0 ; s<brarr.length; s++){
                    var indbr = brarr[s];
                    
                    //split using inner delimeter to get key-value
                    var indbrsp = indbr.split(innerdelimeter);
                    
                    //if key and value found
                    if(indbrsp.length < 2){
                        indbrsp[1] = indbrsp[0]; //use the value as key
                    }
                    //Asscociate key
                    if(keyType == 0 || keyType == 2){
                        //set the newarr to hold the value in the key location
                        newarr[indbrsp[0]] = indbrsp[1];
                        }

                        //Numeric key
                        if(keyType == 1 || keyType == 2){
                        //set numeric location as well
                        newarr[s] = indbrsp[1];
                        }
                    //alert(newarr.length);
                  }
                  //insert the length, so that it can be assessible
                  newarr['length'] = brarr.length;
            }
        }
        //if number break individual digit to array
        }else if(_.IsNumber(obj)){
            
            /*obj = obj.toString();
            for(var s=0 ; s<obj.length; s++){
                var digit = obj[s];
                if(digit != "."){
                    digit = Number(digit);
                }
              newarr.push(digit);	
            }*/
            return _.Engine.ToArray(obj.toString(),delimiter,innerdelimeter)
            
        }else if(IsArray(obj)){
            newarr = obj;
        }else{ //other types
            newarr = Array.prototype.slice.call(obj);
            
        }
        
        
        return newarr;
    },

    //Convert Object, asscociate array to string
    ToString:function(obj,arraydel,keyvaldel){
       //obj - holds the array or accociate array  to convert
       //arraydel - hold the delimiter that joins each object items
       //keyvaldel - hold the delimeter that join individual items key and value

       arraydel = typeof arraydel == _.UND?"":arraydel;
       keyvaldel = typeof keyvaldel == _.UND?"":keyvaldel;

       //if obj is string
       if(_.IsString(obj))return obj;

       //if element
       if(_.IsElement(obj))return obj.toString();

       if(_.IsObject(obj) || _.IsArray(obj)){
           var strf = "";
           for (var key in obj) {
               if (obj.hasOwnProperty(key)) {
                   var element = obj[key];
                   var str = keyvaldel != ""?key+keyvaldel+element.toString():element.toString();
                   strf += str + arraydel;
               }
           }
           return arraydel == ""?strf:_.TrimRight(strf,arraydel);
       }
       return obj.toString();
    },

    //Aim Finder Module
    //#Finder
    
    Finder:{
        //Finder Utility
       Brackets:[], //tempuaryly hold the bracket control strings
       //replace bracket controls with place holders, which will be kept as key with the bracket selector string as the value in Finder.Brackets object
       RemoveBracket:function(selectorstr){
           var starter = 0;
           var mainstr = selectorstr;
         if(_.IsString(selectorstr)){ //if a valid selector string sent
            while(starter >= 0 ){
            var open = selectorstr.indexOf('(');
            if(open > -1){ //if contain braket
              //get the close index
              var close = selectorstr.indexOf(")",open);
              if(close < 1)return selectorstr;
              //get the iner string 
              var innerstr = selectorstr.substr(open + 1,close - (open + 1));
              //for a placeholder name
              var ph = "B"+Math.floor(Math.random() * 100000);
              while(typeof _.Engine.Finder.Brackets[ph] != _.UND){
                ph = "B"+Math.floor(Math.random() * 100000);
              }
              _.Engine.Finder.Brackets[ph] = innerstr;
              //replace the string as place holder
              selectorstr = selectorstr.replace("("+innerstr+")"," "+ph+ " ");
              starter = close;
            }else{
                return selectorstr;
            }
        }
            
         }
         return selectorstr;
       },

        //Finder Module
        //#Finder.Find
    Find:function(selector,baseobj){
       // _.Log(baseobj);
       try {
        baseobj = typeof baseobj == _.UND?document:baseobj;
       // alert(baseobj);
        selector = _.Engine.Finder.RemoveBracket(selector);
        if(_.IsString(selector)){
            
        //Locate Bracket Flow Control
        //Nested Bracket not supported


        //break down for Difference string (Order - Evaluate Third) 
        var DifferenceArr = selector.split("~");
        //if difference operation found
            if(DifferenceArr.length > 1){
                var diffrtnarr = [];
                for(var ff=0;ff<DifferenceArr.length; ff++){
                    //alert(_.Engine.Finder.Find(_.Trim(DifferenceArr[ff])));
                    var indstr = _.Trim(DifferenceArr[ff]);
                    //check if a bracket operation
                    if(typeof _.Engine.Finder.Brackets[indstr] != _.UND){
                        indstr =  _.Engine.Finder.Brackets[indstr];
                        //delete entring
                         delete(_.Engine.Finder.Brackets[indstr]);
                         _.Engine.Finder.Brackets.splice(indstr, 1);
                    }
                    diffrtnarr.push(_.Engine.Finder.Find(indstr));
                }
                //alert(diffrtnarr.length)
                return _.Difference(diffrtnarr);
            }

        // Union break down (Order - Evaluate Second) 
        var UnionArr = selector.split('+');
        //if union operation found
        if(UnionArr.length > 1){
            var unrtnarr = [];
            for(var ff=0;ff<UnionArr.length; ff++){
                var indstr = _.Trim(UnionArr[ff]);
                //check if a bracket operation
                if(typeof _.Engine.Finder.Brackets[indstr] != _.UND){
                    indstr =  _.Engine.Finder.Brackets[indstr];
                    //delete entring
                     delete(_.Engine.Finder.Brackets[indstr]);
                     _.Engine.Finder.Brackets.splice(indstr, 1);
                }
                unrtnarr.push(_.Engine.Finder.Find(indstr));
            }
            return _.Union(unrtnarr);
        }

        // Intersection break down (Order - Evaluate First) 
        var IntersectionArr = selector.split('&');
        //if intersection operation found
        if(IntersectionArr.length > 1){
            var intrtnarr = [];
            for(var ff=0;ff<IntersectionArr.length; ff++){
                var indstr = _.Trim(IntersectionArr[ff]);
                //check if a bracket operation
                if(typeof _.Engine.Finder.Brackets[indstr] != _.UND){
                    indstr =  _.Engine.Finder.Brackets[indstr];
                    //delete entring
                     delete(_.Engine.Finder.Brackets[indstr]);
                     _.Engine.Finder.Brackets.splice(indstr, 1);
                }
                intrtnarr.push(_.Engine.Finder.Find(indstr));
                
            }
            //alert(unrtnarr.length)
            return _.Intersect(intrtnarr);
        }

        //try to get by queryselector
        
        baseobj = _.IsFunction(baseobj.querySelectorAll)?baseobj:document
        var qsel = baseobj.querySelectorAll(selector);
        if(qsel.length > 0){
          var arrRtn = Array.prototype.slice.call(qsel); 
          return arrRtn.length == 1?arrRtn[0]:arrRtn;
        }
        
        
        //by id (baseobj if set, not allowed, only document)
        var qsel = document.getElementById(selector);
        if(!_.IsNull(qsel))return qsel;

        //by classname
        var qsel = baseobj.getElementsByClassName(selector);
        if(qsel.length > 0){
            var arrRtn = Array.prototype.slice.call(qsel); 
            return arrRtn.length == 1?arrRtn[0]:arrRtn;
          }

        //by name (baseobj if set, not allowed, only document)
        var qsel = document.getElementsByName(selector);
        if(qsel.length > 0){
            var arrRtn = Array.prototype.slice.call(qsel); 
            return arrRtn.length == 1?arrRtn[0]:arrRtn;
          }

        //if not found
        return [];


        }else if(_.IsArray(selector)){ //if selector is array
          var mainarr = [];
          if(selector.length > 0){
              //loop through the array and use each itemitem as selector for finding
              //form a comprehensive result in mainarr
              for(var ma=0; ma<selector.length; ma++){
                  var finds = _.Engine.Finder.Find(selector[ma]);
                  if(_.IsArray(finds)){
                    mainarr = mainarr.concat(finds);
                  }else{
                      mainarr.push(finds);
                  }
              }
          }
          return mainarr;
        }else{ //if it is an object already
            return selector;
        }
        
           
       } catch (error) {
        return [];   
    }

    }
},

//End Finder Object
//Walk moves through all childrem of a particular object
//#Walk
 Walk: function(type,elemarr,funct,passval){
     //Type - the operation type, 1->Walk, 2-Each
     //The type specify how parameter will be sent to the loop function
     //Type 1(Walk) - index/name/key, value/object/element, user parameter
     //Type 2(Each) - value/object/element, user parameter, index/name/key
     //Type 3(Loop) - { Item => value/object/element, 
     //                 Key => index/name/key,
  //                    Param =  user parameter
 //                     }
     //elemarr - the object/element/String to walk through
     //funct - the function to run on each item of the elemarr
    //passval is a parameter that will be passed into the funct function while calling it (optional)
   // passval = typeof passval == _.UND?window:passval;
    //passval.func = funct;
    var runFunc = function(t,f,k,v,p){
        //Run the iteration function based on the signature type
        if(t == 2){ //Each operation
          f(v,p,k);
        }else if(t == 3){ //Loop Operation
            f({"Item":v,"Key":k,"Param":p});
        }else{ //Walk Operation
            f(k,v,p);
        }
    }
    type = typeof type == _.UND?1:type;
	if(_.IsNull(elemarr))return;
	if(_.IsObject(elemarr)){ //if elemarr is an object  and it has children pass the current child into the supplied function (funct)
		if(elemarr.childNodes.length != "undefined"){
			for(var i=0; i<elemarr.childNodes.length; i++){
                runFunc(type,funct,i,childNodes[i],passval);
                    //funct(i,elemarr.childNodes[i],passval); 
			}
		}else{
			return;
		}
	}else if(_.IsArray(elemarr)){ //if elemarr is an array pass the each item of the array to the supplied function;
	  for(var i=0; i<elemarr.length; i++){
        runFunc(type,funct,i,elemarr[i],passval);
        //funct(i,elemarr[i],passval);
	  }
	}else if(_.IsString(elemarr)){ //if elemarr is string pass each character
	  for(var i=0; i<elemarr.length; i++){
        runFunc(type,funct,i,elemarr.charAt(i),passval);
        //funct(i,elemarr.charAt(i),passval);
	  }
	}else{ 
	   return;	
	}
},

//Function to confirm if object in a class (has a specific classname)
ClassNameIs:function(obj,Class){
     if(obj == null || Class == null)return false;
    //if obj is string use the aim finder to get the element(s)
    obj = _.IsString(obj)?_(obj):obj;

    //if obj is an array perform operation on each and return true if all obj is in the class
    if(_.IsArray(obj)){
        for(var oi =0; oi < obj.length; oi++){
            //if any of the obj is not in the class return false
            if(!_.Engine.ClassNameIs(obj[oi],Class)){
               return false;
            }
        }
        return true;
    }

    //Perform the checking
    if(_.IsElement(obj)){
    //Check if the object has the class name if Class is a string
        if(_.IsString(Class)){
            if (obj.classList) { //classList is supported
           return obj.classList.contains(Class);
            }else{
                objclassn = ":"+obj.className.Replace(" ",":")+":";
                return objclassn.indexOf(":"+_.Trim(Class)+":") > -1?true:false;
            }
        }
        //if Class is html object check if the two have the same classname
        if(_.IsElement(Class)){
            Class = Class.className;
           if(_.Trim(obj.className) == _.Trim(Class))return true;
           var ClassNamearr = Class.split(" ");
           if(ClassNamearr.length < 2)return false
           return _.Engine.ClassNameIs(obj,ClassNamearr);
        }

        //if Class is an array
        if(_.IsArray(Class)){
            for (var index = 0; index < Class.length; index++) {
                var element = Class[index];
                //if any of the class item is the classname of obj
                if(_.Engine.ClassNameIs(obj,element)){
                    return true;
                }
            }
            return false;
        }

        //if not the above tested type, convert to string and text
        return _.Engine.ClassNameIs(obj,Class.toString());
    }
    return false;
},

//Set the css style of an element
//#Style #SetStyle
SetStyle:function(obj,styl){
    //obj => the element(s) to set its style attribute (Array Allowed) -Required
    //NB: obj(String) - uses aim finder to get the element(s)
    //styl => the css rule to set -Required
    //NB: SetStyle updates rules or insert rules if not exist, does not delete existing rules
    
    obj = _.IsString(obj)?_(obj):obj; //if obj is string use finder to get the element

    //if obj is array perform it on all elemnts of the array
    if(_.IsArray(obj)){
        var rtnarr = [];
        _.Each(obj,function(iobj,styln){
            var st = _.Engine.SetStyle(iobj,styln);
            if(_.IsArray(st)){
               rtnarr = rtnarr.concat(st);
            }else{
                rtnarr.push(st);
            }
            
        },styl);
        return rtnarr;
    }
    if(!_.IsElement(obj))return "";

    if(_.IsEmpty(styl))return obj.style.cssText;
    //get current element rules in array format (associative array)
    var currRulearr =  obj.style.cssText.ToStyleArray();
    //convert new rul to array format (associative array)
    var newRulearr = styl.ToStyleArray();
    //insert or update style rule in current style array, by loop through all element of new style array
        for(atrn in newRulearr){
            currRulearr[atrn] = newRulearr[atrn];
        }
        //return the updated current style array to style string an set the object style
     obj.style.cssText = currRulearr.ToStyleString();  
    return obj.style.cssText;
},

//Convert value to numeric type
//#ToNum #ToNumber #ToInteger
 ToNum: function(val, type){
    // alert("Enter => "+val.toString());
     //val => the value to convert (Array Allowed) -Required
     //type => the numeric type to convert to
     //1=>float Number(default); 2=>Integer Numbers
     //NB: if convertion failed, 0 is returned
     type = typeof type == _.UND?1:type;

    if(_.IsString(val)){ //if val is string, perform convertion
       // alert("String Found => "+val)
        var rst= type == 2?parseInt(val):parseFloat(val);
        //_.Log(rst);
		return (isNaN(rst))?0:rst;
    }
    
    //if array of value is supplied
	if(_.IsArray(val)){
        //alert("Array Found => "+ val.toString())
        var newarr = [];
        //loop through all array and form new array of numeric type
		for(var q=0; q<val.length; q++){
           // alert(q+" Item =>" + val[q].toString());
			var rval = _.Engine.ToNum(val[q],type);
			if(_.IsArray(rval)){
              // alert("Array Result Concat => " + rval.toString())
              // alert("With => " + newarr.toString())
				newarr = newarr.concat(rval);
			}else{
                //alert("String Result Push => " + rval.toString())
				newarr.push(rval);
            }
            //alert("Updated Array New => "+ newarr.toString())
           
        }
        //alert("Return Array New => "+ newarr.toString())
		return newarr;
    }
    
	if(_.IsElement(val)){
		var txt = _.Text(val);
		if(!_.IsEmpty(txt)){
		   return _.Engine.ToNum(txt,type); 	
		}else{
			return 0;
		}
    }
    
		return _.Engine.ToNum(val.toString(),type);
	
},

//Function to get / set attribute of elements and javascript objects
//#Attr #Attribute
Attr:function(obj,attr,value){
//obj => the element to set -Required (Array Allowed)
//attr => Attribute Name -Required
//value => the attribute value to set
if(typeof obj == _.UND || obj == null)return null;
if(_.IsEmpty(attr))return null;
obj = _.Engine.RP(obj);
    //if mutiple element to set
    if(_.IsArray(obj)){
        var retn = [];
       for (var index = 0; index < obj.length; index++) {
           var atr = _.Engine.Attr(obj[index],attr,value);
           if(_.IsArray(atr)){
            retn = retn.concat(atr);
           }else{
               retn.push(atr);
           }  
       }
       return retn;
    }

    //if obj is an element
    if(_.IsElement(obj)){
        if(typeof value != _.UND){
           obj.setAttribute(attr,value)
        }
        var val = obj.getAttribute(attr);
        return _.IsString(val) && _.Trim(val) == ""?null:val;
    }

    //if obj is an object
    if(_.IsObject(obj)){
        if(typeof value != _.UND){
          obj[attr] = value
        }
        return obj[attr];
    }

    return null;


},

//object to deal with browser #url  manipulations (#Browser #history)
Url:{
	
	 //Set the hash part of the url
	 SetHash:function(hashval){
		 //alert(hashval);
		window.location.hash = (IsString(hashval))?escape(hashval):""; 
		_.Engine.Url.SetHashDone = true;
     },
     SetHashDone:false,
	  //get the hash part of the url
	 GetHash:function(){
		 //alert('sss');
		var hash = window.location.hash.substring(1); 
		return unescape(hash);   
	 },
	 //Has Change function
	 Init:function(){
		 window.onhashchange = Aim.Engine.Url.ChangeFunc;
	 },
	 
	 //this function will be triggered when the hash value of the url changes
	 ChangeFunc:function(e){
		 //checks if the operation changing the hash value is a set operation, dnt perform any thing set it back to false to allow next change operation if not a set operation
		 if(_.Engine.Url.SetHashDone){
            _.Engine.Url.SetHashDone = false;
			 return;
		 }else{
			 //if ProcessHashChange function is set run it, sending the current hash value as parameter
			if(!IsNull(_.Engine.Url.ProcessHashChange)){
				
				_.Engine.Url.ProcessHashChange(_.Engine.Url.GetHash());
			}else{return}
		 }
		 
	 },
	 //#Split #Url into individual part #Resolve
	 Resolve:function(url){
		 var obj = {Hash:"",Data:"",Url:"",File:"",Host:"",Ext:"",Port:"",Protocol:"",Dir:""};
         var urle = _.Trim(url);
         //determine the protocol
         var protbr = urle.split("://");
         if(protbr.length > 1){ //if protocol exist in url
            obj.Protocol = protbr[0]+"://";
           urle = _.TrimLeft(urle,obj.Protocol);
         }
		 if(urle.Trim() != ""){
             //break down the hash part
			 var arr = urle.split("#");
			 if(arr.length == 2){ //if has exist
				obj.Hash = arr[1]; //set the hash part
				 urle = arr[0]; //keep the reamaining part
			 }
             
             //brake down the data part
			 arr = urle.split("?");
			 if(arr.length == 2){ //if data part exist
				obj.Data = arr[1]; //set the data part
				 urle = arr[0]; //keep the remaining
			 }
			 
			 obj.Url = urle; //set remaining as url
			 arr = urle.split("/"); //break down remaining url to host, folders and the file name
             if(arr.length == 1){ //if just one item found
                //take it as the file name
				var file = urle;
				var arrfile = file.split("."); //breakdown file name to get extension
				if(arrfile.length == 2){
                    //set extention and file name
					obj.Ext = arrfile[1];
					obj.File = file;
                }
                obj.Dir = obj.Protocol;
			 }else if(arr.length > 1){// if host, folder or filename exist
				 var file = arr[arr.length - 1]; //get the last as the filename
                 var arrfile = file.split(".");
                 //Get and Set the file name and extention
				if(arrfile.length > 1){
					obj.Ext = arrfile[arrfile.length - 1];
					obj.File = file;
				}
				var host = "";
				 //for(s=0; s < arr.length - 1 ; s++){
					// host += arr[s] + "/";
					 
				// }
                 //obj.Host = host.TrimRight("/");
                 //take the first as host name
                 var hst = arr[0];
                 //breakdown to get port number
                 var hstarr = hst.split(":");
                 //Get and Set the host name and port number if it exist
                 obj.Host = obj.Protocol+hstarr[0];
                 obj.Port = typeof hstarr[1] != _.UND?hstarr[1]:"";
                 arr[arr.length - 1] = "";
                 //arr[0] = "";
                 obj.Dir = obj.Protocol+arr.join("/");
			 }
			 
			return obj; 
		 }else{
			return obj; 
		 }
	 },
	 
	 ProcessHashChange : null
	
 },

 //Cookie Management
 //#Cookie
 Cookie:{

    //Set a cookie variable
	Set : function(name,value,expires){
        //name => Name of the cookie variable
        //value => the value to set
        //expires => the expiring date/time
        if(typeof expires == _.UND)expires = 1*24*60*60*1000; //a day
		var currdat = new Date();
		var currGMT = currdat.getTime() - _.Engine.Cookie.AjustmentTime();
		expires = currGMT + expires;
		expires = new Date(expires);
		document.cookie = name + "=" + escape (value) + ((expires) ? "; expires=" + expires.toGMTString() : "");
		//alert(expires.toGMTString());
	},
    
    //recalculate datetime
	AjustmentTime:function(){
		var base = new Date(); 
		var testDate = base;
		 testDate = testDate.toLocaleString() ;
		testDate = new Date(testDate) ;
		return testDate.getTime() - base.getTime();
	},
    
    //Get the value of a cookie variable
	Get:function(labelName) {
        //labelName => the cookie variable name
		labelName = labelName + "=";
	var labelLen = labelName.length; // read cookie property only once for speed 
	var cookieData = document.cookie ;
	var cLen = cookieData.length ;
	var i = 0 
	var cEnd 
	while (i < cLen) { 
	  var j = i + labelLen ;
	  if (cookieData.substring(i,j) == labelName) { 
	    cEnd = cookieData.indexOf(";",j) ;
		if (cEnd == -1) { 
		 cEnd = cookieData.length 
		} 
		return unescape(cookieData.substring(j, cEnd)) 
	} 
	i++ 
	} 
	return "";
	}
},

//The random object - help to generate random numbers , string Both
//#Rand
Rand:{
    //generate random numbers
    Number:function(len){
        len = typeof len == _.UND?1:isNaN(parseInt(len))?1:parseInt(len);
        return Math.floor(Math.random() * len);
    },
    //generate random strings
    String:function(len,charset){
        len = typeof len == _.UND?1:isNaN(parseInt(len))?1:parseInt(len);
        var chr = "abcdefghijklmnopqrstuvwxyzQWERTYUIOPASDFGHJKLZXCVBNM";
        charset = typeof charset == _.UND?chr:charset;
        var str = "";
        for(var d=0; d < len ; d++){
            var rnum = _.Engine.Rand.Number(charset.length);
            str += charset.substr(rnum,1);
        }
        return str;
      
    }
},

//Function to get the id of an element, if no id set generarte and set new id for the element
//#GetId #ID
GetId:function(obj,id){
    //obj => represent the element to get/set id
 obj = _.IsString(obj)?_(obj):obj;

 //If array of object sent
 if(_.IsArray(obj)){
     var rst = [];
     for(var ddd=0; ddd<obj.length; ddd++){
       var oid = _.Engine.GetId(obj[ddd],id);
       if(_.IsArray(oid)){
           rst = rst.concat(oid);
       }else{
           rst.push(oid);
       }
     }
     return rst;
 }

 //if an element
 if(_.IsObject(obj)){
    
     //if no id for the element
     if(typeof obj.id == _.UND || _.Trim(obj.id) == ""){
       var newid = typeof id == _.UND || id == null || _.Trim(id) == ""?_.Engine.Rand.String(20):id;
       //alert(_.IsFound(_('sjjsjsksks')));
       while(_.IsFound(_(newid))){
         newid = _.Engine.Rand.String(20);
       }
       obj.id = newid
     }
    return obj.id;
 }

 return "";


},

//Browse Local File
//#BrowseFile #FileDialog #DialogBox #File
File:{
    Param:[],
    Local:function(param){
        //param => User defined parameter -Required
        //*FileID: the hide of the file input element to be created (must be unique)

        //* OnStart: function that will be executed on individual file selected before reading.
        //OnStart(param) - param =>all user set parameters + param.File,param.Index,param.Length

        //* OnLoad: function to run (individually) on selected file when read complete 
        //OnLoad(param) - param =>all user set parameters + param.File,param.Index,param.Length,param.Reader,param.Result

        //* OnError: function to run when error occur on individual file selected
        //OnError(param) - param =>all user set parameters + param.File,param.Index,param.Length,param.Error

        //* MinSize: the minimum file size allowed (in Byte)

        //* MaxSize: the maximum file size allowed (in Byte)

        //* Accept: the file type or extention allowed (File Element Accept attribute)

        //* Multiple: if multiple selection is allowed or not (true/false) 

        //* ReadType: the format file will be read, (Text-Default, DataURL, ArrayBuffer, BinaryString, FileName)

      //Create a virtual element so as to generate unique id using _.ID()
     // var obj = {id:"",tagName:"div"};
      objid = typeof param['FileID'] == _.UND || param['FileID'].Trim() == ""?_.ID({id:"",tagName:"div"}):param['FileID'];
      var fileid = objid; //the id of the file element to be created
      param = typeof param == _.UND?{}:param;
      //Set Default values as required
      param.Accept = typeof param.Accept == _.UND?"":param.Accept;
      param.Multiple = typeof param.Multiple == _.UND?false:param.Multiple;
       param.MinSize = typeof param.MinSize == _.UND?0:param.MinSize;
       param.MaxSize = typeof param.MaxSize == _.UND?0:param.MaxSize;
      _.Engine.File.Param[fileid] = param; //set the user difined parameter globally
      //form the multiple html file attribute
      var multsel = param.Multiple?"multiple":""
          //check if no file element exist with the current file id, create a new one
          if(!_.IsFound(_(fileid))){ //if not already exist
            //form the html code for the file element
            var htmls = '<input type="file" id="'+fileid+'" name="'+fileid+'" onchange="Aim.Engine.File.Process(this);" style="position:absolute;display:none;visibility:hidden" accept="'+param.Accept+'" '+multsel+' />';
            //append it to the body
           document.body.insertAdjacentHTML('beforeend',htmls);
          }

          //Click the new added file element, to start
          _(fileid).click();
          //return the newly created file element id
          return fileid;
        
      //}
     
    },
     //When onchange event handler for the aim file upload object File.Local
    Process:function(file){
        //file => the file element
        //if file(s) are selected
        if(file.files.length > 0){

             //function to calculate size in KB
        var FileSize = function(size){
            var sizestr = "";
            if(size > 1023){
                size = Math.floor(size / 1024);
               sizestr = size + "KB";
            }else{
                sizestr = size + "B";
            }
            return sizestr;
        }

        var param = _.Engine.File.Param[file.id];//get user defined parameters
        //loop through individual file selected
            for(var ind=0; ind<file.files.length; ind++){
                var err = ""; //Holds the error info
                var rfile = file.files[ind]; //the current file
                var cind = ind; //the current file index
                var fsize = ('size' in rfile)?rfile.size:rfile.fileSize;
                
                   if(fsize < param.MinSize){ //if file size is below min size
                      var sizestr = FileSize(param.MinSize);
                       err = "File too small; Minimum Upload Size ("+sizestr+")";
                  }else if(fsize > param.MaxSize && param.MaxSize > 0){
                      //file size above max size
                      var sizestr = FileSize(param.MaxSize);
                       err = "File exceeded Maximum Upload Size ("+sizestr+")";
                  }
                  //run the onstart handler, sending the file element and the current selected file index
                  if(typeof _.Engine.File.Param[file.id].OnStart != _.UND){
                    param.File = file;
                    param.Index = ind;
                    param.Length = file.files.length
                    
                    _.Engine.File.Param[file.id].OnStart(param)
                    
                  }
                  
                  
                  //if error occur
                  if(err != ""){
                      //if error function or object passed
                     if(typeof param.OnError != _.UND){
                        if(_.IsFunction(param.OnError)){
                            param.Error = err;
                            param.File = file;
                            param.Index = ind;
                            param.Length = file.files.length
                          param.OnError(param);
                        }else{ //if an element / selector string / array
                          _.Text(param.OnError,err);
                        }
                     }else{
                         alert(err);
                     }
                     
                     continue;
                  }

                  

                  //alert(rfile.type)
                  //if filename needed, get the current filename return param to user defined OnLoad method and ignore other operation, continue to the next file if exist and check if reader is not supported
                  if((typeof _.Engine.File.Param[file.id].ReadType != _.UND && _.Engine.File.Param[file.id].ReadType == "FileName") || typeof _.Engine.File.Param[file.id].ReadType == _.UND || (!window.FileReader || !window.Blob) || _.Trim(rfile.type) == ""){
                    param.Result = ('name' in rfile)?rfile.name:rfile.fileName;
                    param.File = file;
                    param.Index = ind;
                    param.Length = file.files.length;
                    param.Reader = {};
                    _.Engine.File.Param[file.id].OnLoad(param);
                    continue;
                  }
                  
                  
          //create the reader object
                  var reader = new FileReader();
                  //keep file index in reader (#=>Need Better way)
                  reader.id = ind;
                  
                  //the onload event handler of the reader
                  reader.onload = function(){
                      //check if user defined handler exist
                      //run it, sending the reader result, file element, the file index
                     if(typeof _.Engine.File.Param[file.id].OnLoad != _.UND){
                        // var param = _.Engine.File.Param[file.id];
                        param.Result = this.result;
                        param.File = file;
                        param.Index = this.id;
                        
                        param.Length = file.files.length;
                        param.Reader = this;
                        _.Engine.File.Param[file.id].OnLoad(param)
                     }   
                  }
                  //the onerror event handler
                  reader.onerror = function(){
                      //check if user defined handler exist
                      //run it, sending the reader error, file element, the file index
                      if(typeof _.Engine.File.Param[file.id].OnError != _.UND){
                        param.Error = this.error;
                        param.File = file;
                        param.Index = this.id;
                        param.length = file.files.length
                          _.Engine.File.Param[file.id].OnError(param)
                         } 
                  }

                  //check the user defined readType and read file based on it
                  //NB: default is readAsText ArrayBuffer BinaryString
                 // if(typeof _.Engine.File.Param[file.id].ReadType != _.UND){
                      var rtype = _.Engine.File.Param[file.id].ReadType;
                      if(rtype.toLowerCase().Trim() == 'dataurl'){
                          reader.readAsDataURL(rfile);
                      }else if(rtype.toLowerCase().Trim() == 'arraybuffer'){
                          reader.readAsArrayBuffer(rfile);
                      }else if(rtype.toLowerCase().Trim() == 'binarystring'){
                          reader.readAsBinaryString(rfile);
                      /*}else if(rtype == 'Text'){
                        reader.readAsText(rfile); */
                      }else{
                          reader.readAsText(rfile);
                      }
                  //}else{
                     // reader.readAsText(rfile);
                  //}
                  
          
             // }
            }
        }
        
       
       // var obj = _(file.id.split("_")[0]);
      

    }
       },

       //Method to get the width and height of an element
       //Globalized elemobj.Dimension()
       //#GetDimension #Dimension
       GetDimension:function(elemobj){
        //Get the elements dimension
        elemobj = _.Engine.RP(elemobj);
        elemobj = _.IsFound(elemobj)?elemobj:{}
        //if multiple object dimension is to be gotten
        if(_.IsArray(elemobj)){
            
            var newarr = [];
            for(var d=0;d<elemobj.length;d++){
                var dim = _.Engine.GetDimension(elemobj[d]);
                if(_.IsArray(dim)){
                    newarr = newarr.concat(dim);
                }else{
                    newarr.push(dim);
                }
            }
            return newarr;
        }
        
        var elemdim = _.IsElement(elemobj)?elemobj.getBoundingClientRect():elemobj;
        if(typeof elemdim.width == _.UND || typeof elemdim.height == _.UND || (_.ToInteger(elemdim.height) == 0 && _.ToInteger(elemdim.width) == 0 )){ //if getBoundingClientRect() not supported
            //_.Log(elemobj.offsetWidth);
            if(typeof elemdim.offsetWidth == _.UND || typeof elemdim.offsetHeight == _.UND || (_.ToInteger(elemdim.offsetHeight) == 0 && _.ToInteger(elemdim.offsetWidth) == 0 )){
                //if cannot get offset dimention
                //use calculated style
                var calstyle = window.getComputedStyle(elemobj);
                elemdim.width = _.ToInteger(calstyle.width);
                elemdim.height = _.ToInteger(calstyle.height);
                elemdim.top = _.ToInteger(calstyle.top);
                elemdim.left = _.ToInteger(calstyle.left);
                elemdim.right = _.ToInteger(calstyle.right);
                elemdim.bottom = _.ToInteger(calstyle.bottom);
            }else{//offset dimention is available
                elemdim.width = elemobj.offsetWidth;
                elemdim.height = elemobj.offsetHeight;
                elemdim.top = elemobj.offsetTop;
                elemdim.left = elemobj.offsetLeft;
                elemdim.right = elemobj.offsetRight;
                elemdim.bottom = elemobj.offsetBottom;
            }
        }
        return elemdim;
       },

       //function to automatically calculate the fit width and height
       //#GetFitSize
       GetFitSize:function (padW,padH,width,height){
           //padW - the containers width 
           //padH - the containers height 
           //width - the width to recalculate
           //height - the height to recalculate
           //margin - margin around the fit dimension(element)
           //if the allowable space arround the ajusting dimention and the containing dimention
            var orientation = ""; //hold the ajusting dimention orientation(p-protraite;l-landscape)
       
            //get the demention ratio
         var Ratio = width / height;
         //alert(Ratio);
         //determin if its landscape or portraite
       if(height > width){
           //if portraite
           orientation = "p";
           //check if height is greater than pad height
           if(height >= padH){
              height = padH;
              //calculate new width
             width = Math.floor(Ratio * height);
             
           }
           //after recalcualting the width and new width still bigger than the pad width (use the padW and recalculate the height)
           if(width >= padW){
                 width = padW;
                 //calculate new width
                 height = Math.floor(width / Ratio);
               }
       
       }else if(width > height){//if landscape
           orientation = "l";
           //check if width is greater than pad width
           if(width >= padW){
               width = padW;
               //claculate height
               height = Math.floor(width / Ratio);
              
               
       
           }
           //check if calculated height is greater than the pad height,
           //use the pad height and recalculate the width
            if(height >= padH){
                 height = padH;
                 //calculate new width
                 width = Math.floor(Ratio * height);
               }
       }
       
       //if square (no orientaion)
       if(orientation == ""){
           //if the height is grater than the pad height use the pad height and set the new height as the new width
          if(height >= padH){
                 height = padH;
                 width = height;
               }
           //if the new set width still graeter than the pad width, use the pad width for both the ajusting widht and height
                if(width >= padW){
                  width = padW;
                  height = width;
                 }
       }
       //return array of the new width, height and the orientation
       return {Width:width,Height:height,Orientation:orientation};
       },

       /*Screen Dimension Manager*/
       //#ScreenMgr #Screen
ScreenMgr:{
	//Screen Dimmentions
	Dimension:function(){
        return {
            'InnerWidth':window.innerWidth,
            'DocumentClientWidth':document.documentElement.clientWidth,
            'BodyClientWidth':document.body.clientWidth,
            'ScreenWidth':window.screen.width,
            'ScreenAvailableWidth':window.screen.availWidth,
            'OuterWidth':window.outerWidth,
            'InnerHeight':window.innerHeight,
            'DocumentClientHeight':document.documentElement.clientHeight,
            'BodyClientHeight':document.body.clientHeight,
            'ScreenHeight':window.screen.height,
            'ScreenAvailableHeight':window.screen.availHeight,
            'OuterHeight':window.outerHeight
        }
    },
    //check if the screen is full or not
	IsFullMode:function(){
		if (
            document.fullscreenElement ||
            document.webkitFullscreenElement ||
            document.mozFullScreenElement ||
            document.msFullscreenElement
        ) {
			return true;
		}else{
			return false;
		}
    },
    //the curent screen width
	get Width(){
		if(typeof window.innerWidth != _.UND)return window.innerWidth;
		if(typeof document.documentElement.clientWidth != _.UND)return document.documentElement.clientWidth;
		if(typeof document.body.clientWidth != _.UND)return document.body.clientWidth;
		return 0;
	},
	//the curent height of the screen
	get Height(){
		if(typeof window.innerHeight != _.UND)return window.innerHeight;
		if(typeof document.documentElement.clientHeight != _.UND)return document.documentElement.clientHeight;
		if(typeof document.body.clientHeight != _.UND)return document.body.clientHeight;
		return 0;
    },
    //Switch to Fullscreen mode
    FullMode:function(){
       // element = typeof page == _.UND?document.documentElement:page;
      element = document.documentElement;
      // Supports most browsers and their versions.
      var requestMethod = element.requestFullScreen || element.webkitRequestFullScreen || element.mozRequestFullScreen || element.msRequestFullscreen;
  
      if (requestMethod) { // Native full screen.
          requestMethod.call(element);
      } else if (typeof window.ActiveXObject !== "undefined") { // Older IE.
          var wscript = new ActiveXObject("WScript.Shell");
          if (wscript !== null) {
              wscript.SendKeys("{F11}");
          }
      }
    },

    //Exit Fullscreen Mode
    ExitFullMode:function(){
        if (document.exitFullscreen) {
            document.exitFullscreen();
        } else if (document.webkitExitFullscreen) {
            document.webkitExitFullscreen();
        } else if (document.mozCancelFullScreen) {
            document.mozCancelFullScreen();
        } else if (document.msExitFullscreen) {
            document.msExitFullscreen();
        }
    },
    //toggle fullscreen mode
    ToggleFullMode:function(page){
        if (_.Engine.ScreenMgr.IsFullMode()) {
             _.Engine.ScreenMgr.ExitFullMode();
        }else{
            _.Engine.ScreenMgr.FullMode();
        }
    }
},

//#Drag object
Drag:{
  CurrentElement:null, //hold the current element user for dragging ()
  Elements:[], //all registered element that is draggable
  ElementPos:[0,0,0,0], //holds positions of the current element ()
  //Register elements,
  Param:[],//hold the drag element parameters
  CurrentParam:null,//hold the current drag element parameters
  Element:function(obj,param){
    //obj => the element(s) to move when dragging (Array Allowed)
    //param
    //1. Handle => the element that user will click or drag to drag the obj.
    //NB: Handle is recormended to be inside obj
    //NB: if handle is not set the obj is used instead
    //2. MaximumX, MaximumY, MinimumX, MinimumY => use to set the maximum drag level of X and Y and the Minimum level of X and Y respectively
    //NB: if the mouse cursur moves beyond or below the limit level the drag operation will be terminated
    //3. Restricted: the confined drag area (usualy an element containing the drag element)
    //NB: if set as true will use the drag elment parentElement
    //NB: aim finder selector string is allowed
    //4. Direction: the direction of dragging ('Both'-default, X-move withen X axis only, Y-move withen Y axis only)
    //5. OnStart => event to trigger when drag starts (when mouse is press down for dragging). recieve ({Element:moving element, ClientX:curent mouse X location, ClientY:current Y mouse loation}) as argurment
    //6. OnDrag => event handler to be trigger durring drag. receive ({Element:elem,Top:elem css top,Left:elem css left})
    //7. OnFinsh => event handler to be trigger when drag ends (when mouse is released or drag is force to stop. receive ({Element:elem})


    //if know param set, create/set an empty object
    param = typeof param == _.UND?{}:param;

    
    //handle => the element to drag (recommended to be inside obj)
    //if handle not set use the obj 
    elmnt =  _.Engine.RP(obj);
    elmnt = _.IsArray(elmnt)?elmnt:[elmnt];

    //Set Default parameters
    handle = typeof param.Handle != _.UND && param.Handle != null?_.Engine.RP(param.Handle):elmnt;
    param.Direction = typeof param.Direction == _.UND?"Both":param.Direction;
    param.MaximumX = typeof param.MaximumX == _.UND?null:param.MaximumX;
    param.MaximumY = typeof param.MaximumY == _.UND?null:param.MaximumY;
    param.MinimumX = typeof param.MinimumX == _.UND?null:param.MinimumX;
    param.MinimumY = typeof param.MinimumY == _.UND?null:param.MinimumY;
    
    //loop through all object to register for drag operation
    for (var index = 0; index < elmnt.length; index++) {
        var element = elmnt[index];
        //make the element absolute
        element.style.position="absolute";
      //get the handle
        var chandle = _.IsArray(handle)?handle[index]:handle;
        //set the handle onmousedown method
        chandle.onmousedown = _.Engine.Drag.DragMouseDown;
        //include the current element to the registered element array, using the handle element id as key
        _.Engine.Drag.Elements[_.ID(chandle)] = element;
        //alert(param.Restricted);
        //check if Restricted is set and is true(parent Element) or an element
        //overide maximum/minimum X and Y to restrict draging to the the confined element
        //if restriction set
        if(typeof param.Restricted != _.UND && param.Restricted != null && param.Restricted !== false){
            //check if restriction is set to true, meaning the drag parent element is to be used
            if(param.Restricted === true){
                param.Restricted = element.parentElement;
            }else{
                //else try get the Restricted element
                param.Restricted =  _.Engine.RP(param.Restricted);
                //if restricted element found
                if(_.IsFound(param.Restricted)){
                    //if restricted element found is an array i.e more than one
                    //use the first element as the restricted element
                    if(_.IsArray(param.Restricted)){
                        param.Restricted = param.Restricted[0];
                    }
                    
                }else{ //if restricted element not found
                    //use the elements parent element
                    //param.Restricted = element.parentElement;
                }
                
            }
           //get the user defined position of the Restrict element
           var restpos = _.Trim(param.Restricted.style.position);
           //if cannot identify position (i.e not set or not set as inline), set it as relative
            if(restpos == "")param.Restricted.style.position = restpos = "relative";
            var pdim = _.Dimension(param.Restricted);
            var elemdim = _.Dimension(element);
            param.MaximumY = pdim.height - elemdim.height;
            // param.MaximumY = param.Restricted.offsetTop + pdim.height - elemdim.height;
            //param.MinimumY=param.Restricted.offsetTop;
            param.MinimumY=0;
           // param.MaximumX=param.Restricted.offsetLeft + pdim.width - elemdim.width;
            param.MaximumX= pdim.width - elemdim.width;
            //param.MinimumX=param.Restricted.offsetLeft;
            param.MinimumX=0;

            //make sure element is in its restricted region
           // if(element.offsetTop < param.Restricted.offsetTop)element.style.top = param.Restricted.offsetTop + "px";
            if(element.offsetTop < 0)element.style.top =  "0px";
            //if(element.offsetLeft < param.Restricted.offsetLeft)element.style.left = param.Restricted.offsetLeft + "px";
            if(element.offsetLeft < 0)element.style.left ="0px";

        }

        //include the current element parameters to the registered element parameter array, using the handle element id as key
        _.Engine.Drag.Param[_.ID(chandle)] = param;
        //set as current elements
        
    
    }
    
},
  
//The onmousedown event handler fro the handle
    DragMouseDown:function(e) {
      e = e || window.event;
      var cobj = e.currentTarget; //get the handle element calling this method
      //set the current drag element to the handle move elemnt from the registered elements array using the handle id as key
      _.Engine.Drag.CurrentElement = _.Engine.Drag.Elements[cobj.id];

      //set the current drag element parameter from the registered elements parameter array using the handle id as key
      _.Engine.Drag.CurrentParam = _.Engine.Drag.Param[cobj.id];
      
      // get the mouse cursor position at startup:
      //and keep in the third & forth position of ElemntsPos array for X and Y respectively
      _.Engine.Drag.ElementPos[2] = e.clientX
      _.Engine.Drag.ElementPos[3] = e.clientY
      if(typeof _.Engine.Drag.CurrentParam.OnStart != _.UND)_.Engine.Drag.CurrentParam.OnStart({Element:_.Engine.Drag.CurrentElement,ClientX:e.clientX,ClientY:e.clientY});
      
      //set the document onmouseup event handler (Stop dragging)
      document.onmouseup = _.Engine.Drag.CloseDragElement;

      
      // call a function whenever the cursor moves:
      document.onmousemove = _.Engine.Drag.ElementDrag;
      
    },
  
    //the cursor/mouse move event handler
    ElementDrag:function(e) {
      e = e || window.event;

      //if no drag element and drag param set;
      if(_.Engine.Drag.CurrentParam == null || _.Engine.Drag.CurrentElement == null ){
        _.Engine.Drag.CloseDragElement();
        return;
      }
    
      // calculate the new cursor position:
      //(Current Position - New Position)
      _.Engine.Drag.ElementPos[0] = _.Engine.Drag.ElementPos[2] - e.clientX;
      _.Engine.Drag.ElementPos[1] = _.Engine.Drag.ElementPos[3] - e.clientY;

      //reset the mouse cursur position to new position
      _.Engine.Drag.ElementPos[2] = e.clientX;
      _.Engine.Drag.ElementPos[3] = e.clientY;
      
      var ntop=0,nleft=0;
      // set the element's new position:
      if(_.Engine.Drag.CurrentParam.Direction == 'Both' || _.Engine.Drag.CurrentParam.Direction == 'Y'){
          //calculate the new value and set elements position
          var maxY = _.Engine.Drag.CurrentParam.MaximumY,
          minY = _.Engine.Drag.CurrentParam.MinimumY,
          ntop = _.Engine.Drag.CurrentElement.offsetTop - _.Engine.Drag.ElementPos[1];
          //disable dragging if max or min move level passed
          if((maxY != null && ntop > maxY && e.pageY > maxY + _.Dimension(_.Engine.Drag.CurrentElement).height) || (minY != null && ntop < minY && e.pageY < minY)){
              _.Engine.Drag.CloseDragElement();
          }
         // _.Engine.Drag.CurrentElement.innerHTML = "clientY: "+ e.pageY + " <br /> new Y: "+nval; 
         ntop = (maxY != null && ntop > maxY)?maxY:ntop;
         ntop = (minY != null && ntop < minY)?minY:ntop;
         if(_.Engine.Drag.CurrentElement != null)_.Engine.Drag.CurrentElement.style.top = ntop + "px";
         
      }

      if(_.Engine.Drag.CurrentParam != null && (_.Engine.Drag.CurrentParam.Direction == 'Both' || _.Engine.Drag.CurrentParam.Direction == 'X')){
         //calculate the new value and set elements position 
        var maxX = _.Engine.Drag.CurrentParam.MaximumX,
        minX = _.Engine.Drag.CurrentParam.MinimumX,
        nleft = _.Engine.Drag.CurrentElement.offsetLeft - _.Engine.Drag.ElementPos[0];
        //disable dragging if max or min move level passed
        if((maxX != null && nleft > maxX && e.pageX > maxX + _.Dimension(_.Engine.Drag.CurrentElement).width) || (minX != null && nleft < minX && e.pageX < minX)){
            _.Engine.Drag.CloseDragElement();
        }
        nleft = (maxX != null && nleft > maxX)?maxX:nleft;
        nleft = (minX != null && nleft < minX)?minX:nleft;
      if(_.Engine.Drag.CurrentElement != null)_.Engine.Drag.CurrentElement.style.left = nleft + "px";
      }
     if(_.Engine.Drag.CurrentElement != null) _.Engine.Drag.CurrentParam.OnDrag({Element:_.Engine.Drag.CurrentElement,Top:ntop,Left:nleft});
      //_.Engine.Drag.CurrentElement.innerHTML = "mcX: "+e.clientX+"<br />"+"mcY: "+e.clientY+"<br />"+"elemOffPosLeft: "+_.Engine.Drag.CurrentElement.offsetLeft+"<br />"+"elemOffPosTop: "+_.Engine.Drag.CurrentElement.offsetTop+"<br />"+"elemTop: "+_.Engine.Drag.CurrentElement.style.top+"<br />"+"elemLeft: "+_.Engine.Drag.CurrentElement.style.left+"<br />"
    },
  
    CloseDragElement: function() {
      /* stop moving when mouse button is released:*/
      document.onmouseup = null;
      document.onmousemove = null;
      if(typeof _.Engine.Drag.CurrentParam.OnFinish != _.UND)_.Engine.Drag.CurrentParam.OnFinish({Element:_.Engine.Drag.CurrentElement});
      _.Engine.Drag.CurrentParam = null; _.Engine.Drag.CurrentElement = null;
    }
  
},

//Need Review (not to be included in main aim)
//******************************************* */
//function to escape using php urlrawencode formats
//#EscapeRaw
EscapeRaw:function(str){
    return _.Replace("*","%2A",_.Replace("+","%2B",_.Replace("/","%2F",_.Replace("@","%40",escape(str)))));
},
//function to unescape using php urlrawdecode formats
//#UnEscapeRaw
UnEscapeRaw:function(str){
    return unescape(_.Replace("%2A","*",_.Replace("%2B","+",_.Replace("%2F","/",_.Replace("%40","@",_.Replace("%C2%A0"," ",str))))));
},
//***************************************** */

/**The Keybord Object */
//#Keyboard
Keyboard:{
    //get the key user press from an event object
    //returns an object containing the Code - KeyCode, Char - Key Character, Unicode - key unicode
    KeyPress:function(e){
        //e the user event
         if(window.event){ // IE                 
           keynum = e.keyCode;
       }else if(e.which){ 
               // Netscape/Firefox/Opera                   
               keynum = e.which;
       }
               keynum = (typeof keynum != "undefined")?keynum:0;
               //get the character
               var char = String.fromCharCode(keynum);
               //get the unicode 
               var unicode=e.keyCode? e.keyCode : e.charCode;
               return {Code:keynum,Char:char,Unicode:unicode}
    }
    
},

//object to deals with asigning and unasigning event handler to objects events
//#Handlers #Assign #UnAssign
Handlers:{
    Mutations:{},
    Assigns:{},
    //assign an event handler to element(s)
    Assign:function(eventName,element,handler,once,keepevent){
        //eventname => the name of the user event (on prefix not required) - Required
        //element => The DOM element to attach event handler to -Required
        //handler => the function to run when user triggers the event
        //once => determine if the event handler is to be run once i.e after running remove attahced event handler
        
        //set once default if not set
        once = typeof once == _.UND?false:once;
        keepevent = typeof keepevent == _.UND?true:keepevent;
        if(_.IsArray(element)){ //if array, get individual item and perform asign
            
            for(var aad=0; aad < element.length; aad++){
                elementc = element[aad];
                _.Engine.Handlers.Assign(eventName,elementc,handler,once);
            }
            return;

        }else if(_.IsString(element)){ //if element is a string use the aim finder to get the element using the the string as selector before running the event asigning
            
            _.Engine.Handlers.Assign(eventName,_(element),handler,once);
           return;
        }

        //if DONChange event
        if(eventName == "DOMChange"){
            
            if(typeof _.Engine.Handlers.Mutations[element.ID] == _.UND){
                // _.Engine.Handlers.Mutations[element.ID].disconnect();
             _.Engine.Handlers.Mutations[element.ID] = new MutationObserver(function(){
             handler({"target":element,"currentTarget":element})
            });
            //alert('aa');
            _.Engine.Handlers.Mutations[element.ID].observe(element,{
             attributes: false,
             characterData: true,
             childList: true,
             subtree: true,
             attributeOldValue: false,
             characterDataOldValue: true
            });
         }
            
            return;
          }

        //create handler function for once operation (if once package the handler with the UnAssign function in a function representing the event handler). the means that after the  running of the handler it will be removed
        var rhandler = once?function(e){handler(e);_.Engine.Handlers.UnAssign(eventName,e.currentTarget,arguments.callee)}:handler;

        
        //if addEventListiner is supported by the browser
        if (element.addEventListener) {
            
               element.addEventListener(eventName, rhandler,false);
              // alert(rhandler)
           }
           //if attachEvent is supported
           else if (element.attachEvent) {
               element.attachEvent('on' + eventName, rhandler);
           }
           else {
               //add to the element DOM property
               element['on' + eventName] = rhandler;
           }
           //_.Log(eventName + " assign to " + element.ID);
           //add to global asign list
           
           if(keepevent){
            if(typeof _.Engine.Handlers.Assigns[element.ID]  == _.UND) _.Engine.Handlers.Assigns[element.ID] = {};
            if(typeof _.Engine.Handlers.Assigns[element.ID][eventName]  == _.UND) _.Engine.Handlers.Assigns[element.ID][eventName] = [];
               //if(_.Engine.Handlers.Assigns[element.ID][eventName].length < 5){
                //_.Log(element.ID + " : "+eventName + " : "+rhandler);
                   _.Engine.Handlers.Assigns[element.ID][eventName].push(rhandler);
               //}
               
           }
        return false;
         //obj.addEventListener(ev,func);
    },
    UnAssign:function(eventName,element,handler){
       
        //eventname => the name of the user event (on prefix not required) - Required
        //element => The DOM element to remove/detach event handler -Required
        //handler => the handler to remove
        //NB: if no handler sent, remove all element handlers
        if(_.IsArray(element)){ //if array, get individual item and perform asign
            for(var aad=0; aad < element.length; aad++){
                elementc = element[aad];
                _.Engine.Handlers.UnAssign(eventName,elementc,handler);
            }
            return;
        }else if(_.IsString(element)){ //if string use aim finder and perform unasign on seen element
            _.Engine.Handlers.UnAssign(eventName,_(element),handler);
           return;
        }
        if(!_.IsFound(element))return;
        //if a valid handler function is sent
        
        if(_.IsFunction(handler)){
            //if removeEventListener is supported
        if (element.removeEventListener) {
               element.removeEventListener(eventName, handler);
           }
           //if detachEvent is supported
           else if (element.detachEvent) {
               element.detachEvent('on' + eventName, handler);
           }
           
           else {
               element['on' + eventName] = function(){};
           }
        }else{ //if no valid handler sent remove all
            //remove all assigned eventlistiners
            element.ReplaceWith(element.Cloner());
           /* var cloneelement = element.cloneNode(true)
            element.parentElement.replaceChild(cloneelement,element);*/
        }
    }
},

//Convert HTML table to downloadable excel file
//#ToExcel
ToExcel:function(table,sheetname){
    //table => the html table element to export
    //NB: any supported aim finder selector can be use
    //NB: Array Allowed
    //sheetname => the name of the worksheet

    //if array of tables sent loop through all table and perform the TOExcel Method on individual table
    if(_.IsArray(table)){
        for(var aad=0; aad < table.length; aad++){
            tbcc = table[aad];
            _.Engine.ToExcel(tbcc,sheetname);
        }
        return;
    }

    //if string supplied as table
    if(_.IsString(table)){
    //try to use aim finder to get the table elment(s)
    var tableEl = _.Engine.RP(table);
    if(_.IsFound(tableEl)){//if found run the ToExcel mathod on the found element(s)
        _.Engine.ToExcel(tableEl,sheetname);
        return;
    }else{ //if not found, system assumes an html string representing the table is sent
        //form the table as an object (trying to simulate dom element, setting the string as innerHTML attribute so that it can be referensed like normal element)
        table = {innerHTML:table}
    }
        
    }

    //get the innerHTML
    table = table.innerHTML;
    //if(!_.IsFound(table))return;
//the data url template
var uri = 'data:application/vnd.ms-excel;base64,'
, template = '<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40"><head><!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>{worksheet}</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--></head><body><table>{table}</table></body></html>',

//converts the formated uri(after replacing the table innerHTML and the wooksheet name) to base64
base64 = function(formateduri){
    return window.btoa(unescape(encodeURIComponent(formateduri)))
},

//replace the table innerHTML and wooksheet name in the uri template
format = function(templ, tbiHTMLWorksNme){
    return templ.replace(/{(\w+)}/g, function(m, p) { return tbiHTMLWorksNme[p]; });
},

//form the replace(format) object
ctx = {worksheet: sheetname || 'Worksheet', table: table}

//set the browser uri
window.location.href = uri + base64(format(template,ctx))

},

/* Run function when user scroll document the document*/
//#Scroll
Scroll:{
 //global array to hold all scroll run details
  WinScrollFunc:[], //array to hold window scroll functions
  ObjScrollFunc:[], //hold all object and thier equivalent function

  //function to run all function assign to window scroll operation
  WinScroll:function(){
      //get the curent window srolltop & scrollLeft and send to all the registered functions
    var scrolt = window.pageYOffset || document.documentElement.scrollTop || document.body.scrollTop || 0; 
    var scrolL = window.pageXOffset || document.documentElement.scrollLeft || document.body.scrollLeft || 0; 

    //loop through all window asign function, run them and send the curent scrool lengths
    if(_.Engine.Scroll.WinScrollFunc.length > 0){
        for(var s=0; s<_.Engine.Scroll.WinScrollFunc.length; s++){
            if(IsFunction(_.Engine.Scroll.WinScrollFunc[s])){
                _.Engine.Scroll.WinScrollFunc[s](scrolt,scrolL); //run the function
            }
        }
    }
    
  },

  //assign function to window or element onscroll event andler
  Attach:function(func,obj){
    //obj => the object to assign a function to its onscroll event handler (Default - window)
    //NB: aim finder used 
    //func => the function to assign -Required
    if(typeof obj == _.UND || obj == window){ //if the object is window
        //if func is  valid function add it to WinScrollFunc array
        if(_.IsFunction(func)){
            _.Engine.Scroll.WinScrollFunc.push(func);
        }
        //alert(_.Engine.Scroll.WinScrollFunc.length);
        //if the function is the first set windows onscroll event handler
		if(_.Engine.Scroll.WinScrollFunc.length == 1){
            
            _.Assign('scroll',window,_.Engine.Scroll.WinScroll);
        }
        
		return;
    }

    obj = _.Engine.RP(obj);
    if(_.IsArray(obj)){
        for(var aad=0; aad < obj.length; aad++){
            objc = obj[aad];
            _.Engine.Scroll.Attach(objc,func);
        }
        return;
    }
    
    
    //if the user scroll object is an html element
    objid = _.ID(obj); //force - get the id
    //check if the objects scroll function exist
	if(typeof _.Engine.Scroll.ObjScrollFunc[objid] == _UND){
        //not exist
        _.Engine.Scroll.ObjScrollFunc[objid] = []; //create the array
        //set the objs onscroll event handler
        _.Assign('scroll',obj,_.Engine.Scroll.ObjScroll);
		
    }
    //add the function to the objects array of scrool functions
	_.Engine.Scroll.ObjScrollFunc[objid].push(func); //add the object and its function to the array
  },

  //the object onscroll event handler
  ObjScroll:function(e){
   var obj = e.currentTarget;
   if(typeof obj != _.UND && obj != null){
    var st = typeof obj.scrollTop != _.UND?obj.scrollTop:-1;
    var sl = typeof obj.scrollLeft != _.UND?obj.scrollLeft:-1;
    //if object scroll functions exist
    if(typeof _.Engine.Scroll.ObjScrollFunc[obj.id] != _.UND && _.Engine.Scroll.ObjScrollFunc[obj.id].length > 0){
       //run all the functions
       _.Engine.Scroll.ObjScrollFunc[obj.id].Each(function(func,scrollst){
         if(_.IsFunction(func))func(scrollst[0],scrollst[1]);
       },[st,sl])
    }
   }
  }

},
//the DOM Object that handles runing set-method to be executed, after all DOM element are completely loaded, 
//also contain the Loader Object that handle using aim to load user script
//#Dom
Dom:{
	ReadyList:new Array(), //list of all event to run whwn page loads
    //Ready add suplied function to ReadyList (i.e functions to run when DOM complete loading)
    //#Dom.Ready #Ready
    Ready:function(func,param){
        
		
        param = typeof param == "undefined"?null:param;
        //alert(func);
      _.Engine.Dom.ReadyList.push([func,param]);
      
    },
    ReadyDone:false,
    ReadyTimmer:null,
    //Run all function in the Ready list (will be done or called when DOM complete loading)
	Run:function(){
        //alert(_.Engine.Dom.ReadyList.length);
        if(!_.Engine.Dom.Loader.Finish){
            //alert('not finish');
            if(_.Engine.Dom.ReadyTimmer != null){
                clearTimeout(_.Engine.Dom.ReadyTimmer);
                _.Engine.Dom.ReadyTimmer = null;
            }
            //_.Log('Not Finish');
        _.Engine.Dom.ReadyTimmer = setTimeout("_.Engine.Dom.Run()",100);
         return;
        }
        if(_.Engine.Dom.ReadyDone == true)return true;
        //remove the Dom.Run function from document DOMContentLoaded event handler
        document.removeEventListener( "DOMContentLoaded", _.Engine.Dom.Run);
        window.removeEventListener( "load", _.Engine.Dom.Run );
        //alert(_.Engine.Dom.ReadyList.length);
		//if function registered
	  if(_.Engine.Dom.ReadyList.length > 0){
          //run each of the function registered
        _.Each(_.Engine.Dom.ReadyList,function(domfunc){
             //run the function
            domfunc[0](domfunc[1]);  
        });
    } 
    _.Engine.Dom.ReadyDone = true;
    _.Engine.Dom.ReadyList = [];
	  return true; 
    },
    //Loader Object => handles user file/script loading
    //NB: It also initialize/set the Dom Ready function, so Dom.Run can be executed when Dom elements loads successfully
    //NB: also setup the loader display (aim-loader-text, aim-loader-background, aim-loader-delay, aim-loader-file)
    Loader:{
        Dir:"", //the Aim directory based on the user src set for the script tag that loads aim.js
        Scripts:[], //hold all the script src/link href uri to load (relative to the html page referencing aim)
        Pointer:-1, //the pointer holds the index of the script/link src/href to load
        //Create the script / link element and set the src/heref so as to load the file(script/stylesheet),
        Finish:false,//hold if the loader is thrugh loading the url or not
        Strict:false,//make sure a script file loads completely before loading the next. Else load them concurently
        Text:"Preparing Page, Please Wait !!!",//the text to display while aim is loading data/working
        //NB: can by customized using the aim-loader-text attribute of the aim script element
        Backg:"#EEE",//the background color
        //NB: if multi -> transit between several colors
        Delay:0,//the loader delay time in second
        Image:"", //the aim loader display image
        Color:"#000000",//the aim loader display text color
        Domain:"",//the domain (site root)
        Root:"",//the site root from aim dir
        //create and set the src attribute of a script or link element as required so as to load the script
        //#Dom.Loader.Load #Loader.Load #Load #LoadUserScript #UserScript
        Load:function(src){
            var srcobj = _.Engine.Url.Resolve(src) //get breakdown
            
            var ext = _.Trim(srcobj.Ext.toLowerCase()) //get file extention
            //alert(JSON.stringify(srcobj));
            //alert(src + " => "+ext);
            if(ext == "")return; //invalid: //if no extension
            //get the appropraite tagname based on the extention
           var head,tagname = srcobj.Ext.toLowerCase()=="css"?"link":"script";
           //create a new element(tag) based on the tagname
                  var newscript = document.createElement(tagname);
                  //set the appropriate element(tag)'s attribute base on the ext
                  if(ext=="css"){ //if stylesheet
                    newscript.href = src; //ling href
                    newscript.type = "text/css";
                    newscript.media = "all";
                    newscript.rel = "stylesheet";
                  }else{ //if javascript
                    
                    newscript.src = src;
                  }
                  //get the head segment
                  head = document.getElementsByTagName("head")[0];
                      //  alert(newarr.length);
                      if(_.Engine.Dom.Loader.Strict == true){
                          //if strict mode
                        //load next after current loads completely
                        if (ext=="css" && !('onload' in document.createElement('link'))) { //if is a css(link) type and browser does not support onload for link element
                            
                            imgTag = document.createElement('img');
                            imgTag.onerror = _.Engine.Dom.Loader.LoadNext;
                            imgTag.src = src;
                          }else{
                            //alert('s');
                        newscript.onload = _.Engine.Dom.Loader.LoadNext;
                        newscript.onerror = _.Engine.Dom.Loader.LoadNext;
                          }
                      }else{
                          
                        _.Engine.Dom.Loader.LoadNext(); 
                      }
                      
                    //add new wlwmwnt to the head segment
                    head.appendChild(newscript); 
        },
        //Load the next url on the queue
        //#Loader.LoadNext #LoadNext
        LoadNext: function(){
            //increament pointer
            _.Engine.Dom.Loader.Pointer += 1;
            //alert(_.Engine.Dom.Loader.Pointer + " ; " + _.Engine.Dom.Loader.Scripts.length);
            //check if url to load is still available
            if(_.Engine.Dom.Loader.Pointer < _.Engine.Dom.Loader.Scripts.length && _.Engine.Dom.Loader.Scripts.length > 0){
                
                //load the url into the html by inserting the appropraite tag
                _.Engine.Dom.Loader.Load(_.Engine.Dom.Loader.Scripts[_.Engine.Dom.Loader.Pointer]);
            }else{
                //set the loaders Finish property to  true
                _.Engine.Dom.Loader.Finish = true
            }
        },

        //#process user suplied string for loading
        //#Dom.Loader.Process #Loader.Process #User Script #User Files
        Process:function(strmain){
            
            if(typeof strmain == _.UND || !_.IsString(strmain))return;
            var strarrm = strmain.split(";");
            
            //get all user set script/stlesheet to load
            if(strarrm.length > 0){
                //loop through and queue url to loaders scripts array for loading
                for(var sc=0; sc<strarrm.length; sc++){
                    str = strarrm[sc];
                    if(str.indexOf("::",0) >= 0){//if common directory
                        //e.g => UserScript::main.js,acc.js,main.css
                        //get the directory name and the script/styles in it 
                        var strarr = str.split("::");
                        if(strarr.length != 2)return;
                        var pths = strarr[1].split(",");
                        //loop through all script/style in directory
                        for(var w=0;w<pths.length;w++){
                            //add the individual full url to the loading scripts list
                            _.Engine.Dom.Loader.Scripts.push(strarr[0]+"/"+pths[w]);
                                
                            };
                        }else{//if full path supplied
                        
                         if(_.Trim(str) != "")_.Engine.Dom.Loader.Scripts.push(str);
                        }
                }
                
            //after queing all script/stylesheet's url to be loaded, run the method to start loading
            //NB: it loads script tag files consecutively (i.e one must complete loading before the next, and till the last)
           //alert(_.Engine.Dom.Loader.Scripts.length);
            _.Engine.Dom.Loader.LoadNext();
                
            }

            

        },

        JSOnly:false,

        //function to Start the Loader

        //1. asign the _.Engine.Dom.Run to DOMContentLoaded i.e run _.Engine.Dom.Run when the dom complete loading
        //2. get the aim setup details and perform/set aim engine as required 
        //#Loader.Start #Start #Dom.Start
        Start:function(){
            
            //1.
            //run all asign function if Dom is ready
            if ( document.readyState === "complete" ||
            ( document.readyState !== "loading" && !document.documentElement.doScroll ) ) {
           
            // Handle it asynchronously to allow scripts the opportunity to delay ready
            window.setTimeout( _.Engine.Dom.Run );
           } else {
           
            
            document.addEventListener( "DOMContentLoaded", _.Engine.Dom.Run );
            
                // A fallback to window.onload, that will always work
                if(_.IsIE()){
                   window.addEventListener( "load", _.Engine.Dom.Run );
                }
            
            
            
           }

           //2.
            //get the aim laoder script and requires
            var obj = document.getElementsByTagName("script"); //get the scripts
            if(obj.length > 0){
                for(var a=0; a<obj.length; a++){//loop through all script element found
                    
                 //get user set loader details
                 var jsonly = obj[a].getAttribute("aim-jsonly");
                 _.Engine.Dom.Loader.JSOnly = typeof jsonly == 'undefined'?false:Boolean(jsonly);
                 var loaderstr = obj[a].getAttribute("aim-file");
                 var loadertext = obj[a].getAttribute("aim-text");
                 var loaderbg = obj[a].getAttribute("aim-background");
                 var loaderdelay = obj[a].getAttribute("aim-delay");
                 var loaderimg = obj[a].getAttribute("aim-image");
                 var loadercolor = obj[a].getAttribute("aim-color");
                 var aimSrc = obj[a].getAttribute("src");
                 var srcbrd = aimSrc.split("/"); //breakdown the url
                 var loaderReq = obj[a].getAttribute("aim-require");//auto or manual
                 var isaim = false;
                 var rloaderstr = "";
                 //load requires
                 if(typeof loaderReq == 'undefined' || loaderReq == null || loaderReq.toLowerCase() != "manual"){
                     
                 for (var req in _.Requires) {
                     if (_.Requires.hasOwnProperty(req)) {
                         var src = _.Requires[req];
                         if(_.Trim(rloaderstr) != ""){
                            rloaderstr += ";"+src;
                         }else{
                             rloaderstr = src;
                         }
                     }
                 }
                 //alert(loaderstr)
                }else{//meaning is manual
                   isaim = true;
                }
                // alert(loaderstr);
                 //user aim parameter indicators
                 
                 //var strseen = false,txtseen=false,bgseen=false,delseen=false,imgseen=false,colseen=false;

                 //if aim is set to laod user script
                 if(typeof loaderstr != 'undefined' && loaderstr != null  && _.Trim(loaderstr) != ""){
                    isaim = true; //set its indicator to true
                    
                    rloaderstr += rloaderstr == ""?loaderstr:";"+loaderstr;
                    
                    
                    
                }
                //get the strict mode(make sure a script loads completely before moving to the next)
                var loaderstrict = obj[a].getAttribute("aim-strict");
                if(typeof loaderstrict != 'undefined' && loaderstrict != null){ //if strict mode set, set the Loader Strict attribute
                    _.Engine.Dom.Loader.Strict = _.Trim(loaderstrict.toLowerCase()) == "true"?true:false;
                    //NB: will be use while loading the user script in _.Engine.Dom.Loader.Process
                }
                //if a loader text is set (text to display while loader is working)
                if(typeof loadertext != 'undefined' && loadertext != null && _.Trim(loadertext) != ""){
                    isaim = true; //set its indicator
                    //asign it to the Engine's Dom Loader, which will be referenced bellow while setting the aim initial display
                    _.Engine.Dom.Loader.Text = loadertext;
                }

                //if loader display background is set
                if(typeof loaderbg != 'undefined' && loaderbg != null && _.Trim(loaderbg) != ""){
                    isaim = true;//set its indicator
                    //asign it to the engine's Dom Loader Object, which will be referenced below while setting the aim initial display
                    _.Engine.Dom.Loader.Backg = loaderbg;
                }
                //if a delay is set (i.e make aim wait for a specific period of time after completion of work before display page to end-user)
                if(typeof loaderdelay != 'undefined' && loaderdelay != null && _.Trim(loaderdelay) != ""){
                    isaim = true;//set its indicator
                    //asign it to the engine's Dom Loader Object, which will be referenced in the main aim startup script, which is the last script
                    _.Engine.Dom.Loader.Delay = _.ToInteger(loaderdelay) * 1000; //converted to milisecond
                }

                //if a display image is set (which will be displayed under the text)
                if(typeof loaderimg != 'undefined' && loaderimg != null && _.Trim(loaderimg) != ""){
                    isaim = true;//set its indicator
                    //asign it to the engine's Dom Loader Object, which will be referenced below while setting the aim initial display
                    _.Engine.Dom.Loader.Image = loaderimg; //url of the image
                }

                //if text color set
                if(typeof loadercolor != 'undefined' && loadercolor != null && _.Trim(loadercolor) != ""){
                    isaim = true;//set its indicator
                    //asign it to the engine's Dom Loader Object, which will be referenced below while setting the aim initial display
                    _.Engine.Dom.Loader.Color = loadercolor; //text color
                }



                //if user did not set any of the aim laoder attribute
                //check if the src atribute is referensing aim.js or aim.min.js
                if(!isaim){
                    //get the script src url and get the url component 
                    var fn = _.Trim(srcbrd[srcbrd.length - 1].toLowerCase());
                    isaim = fn == "aim.js" ||fn == "aim.min.js"?true:isaim;
                }
                //if any of the aim prop is set  stop loop (i.e the aim script element is found)
                if(isaim){
                    
                    //start
                    //load all required script/stylesheet
                    _.Engine.Dom.Loader.Process(rloaderstr);
                    //get the aim directory from aim.js src
                    
                    if(srcbrd.length > 1){ //if page loading page is not in aim directory
                       srcbrd.pop();
                       _.Engine.Dom.Loader.Dir = srcbrd.join("/")+"/";
                    }
                    _.Engine.Dom.Loader.Domain = _.UrlSplit(document.location.toString()).Dir;
                    //form the app root from aim root
     //breakdown Domain
     var rootarr = _.Engine.Dom.Loader.Domain.Trim("/").split("/");
     var g = rootarr.length - 1;
     var aimrootarr = _.Engine.Dom.Loader.Dir.Trim("/").split("/");
     var rstarr = [];
     for(var aimrt = aimrootarr.length - 1; aimrt >= 0; aimrt--){
         var fld = aimrootarr[aimrt];
         if(fld != ".."){
            rstarr.push("..");
         }else{
            rstarr.push(rootarr[g]);
            g--;
         }
     }
     _.Engine.Dom.Loader.Root = rstarr.join("/")+"/";
                   // alert("AimDir : "+_.Engine.Dom.Loader.Dir+ " ; SiteRoot: "+_.Engine.Dom.Loader.Domain+" ; SiteRootFromAimDir: "+_.Engine.Dom.Loader.Root);
                    break;
                }
                

                }
            }
            //**************************************************** */
            //alert(_.Engine.Dom.Loader.Text);
    //Adding CSS Rules to Aim Stylesheet
    //#Aim.CSS #Loader.CSS #Aim.StyleSheet #Loader.StyleSheet #StyleSheet
    //forming the aim initial display
    var ImgPos = "";
    //If Image is to be displayed
    _.Engine.Dom.Loader.Image = _.Engine.Dom.Loader.Image == ""?_.LoadingImg:_.Engine.AimUrl(_.Engine.Dom.Loader.Image);
    if(_.Engine.Dom.Loader.JSOnly == false){
        _.Engine.AddRule('body::after',"content:'';z-index:10001;width:96%;overflow:hidden;text-align:center;position:fixed;top:90px;background-image:url("+_.Engine.Dom.Loader.Image+");background-repeat:no-repeat;background-position: center top;display:block;width:100%;height:calc(100% - 90px)");
        _.Engine.AddRule('body.aim-error::after',"background-image:url("+_.ErrImg+")");
        _.Engine.AddRule('body::before',"content:'"+_.Engine.Dom.Loader.Text+"';position:fixed;width:100%;height:100%;z-index:10000;background-color:#EEE;font-size:2em;left: 0px; top: 0px; display: block;text-align:center;padding-top:40px; font-family:  'Segoe UI Light', 'Segoe UI', Tahoma, Geneva, sans-serif;opacity:1;visibility:visible; color:"+_.Engine.Dom.Loader.Color);
    }
        

        

        //Datafile Template object aim-template 
        _.Engine.AddRule('.aim-template',"display:none");
        _.Engine.AddRule('.aim-template-load',"animation:opaci 0.8s");
        //@keyframes opac{from{opacity:0} to{opacity:1}
        _.Engine.AddRule('@keyframes opaci',"from{opacity:0} to{opacity:1}");

        //Input element error-indicator
         _.Engine.AddRule('@keyframes error_anim',"0%{background-color:rgb(247, 22, 22)!important;background-color:rgba(247, 22, 22,0.4)!important;color:#FFF} 20%{background-color:rgb(255,255, 255);color:initial} 40%{background-color:rgb(247, 22, 22)!important;background-color:rgba(247, 22, 22,0.4)!important;color:#FFF} 60%{background-color:rgb(255,255, 255);color:initial} 80%{background-color:rgb(247, 22, 22)!important;background-color:rgba(247, 22, 22,0.4)!important;color:#FFF} 100%{background-color:rgb(255, 255, 255);color:initial }");
    _.Engine.AddRule('.error-input','animation: error_anim 4s ease-in-out;');



    // Aim Actions Loading div
    _.Engine.AddRule('#aim-general-loading','min-width:200px;max-width:400px; width:auto; position: fixed;box-shadow:0 2px 4px 0 rgba(0,0,0,0.16),0 2px 10px 0 rgba(0,0,0,0.12)!important;background-color:white;margin:auto;z-index:2000;color:#333;left:50%;top:0;transform:translate(-50%,0%);-ms-transform:translate(-50%,0%);border-radius:2px;font-size:0.85em');

    _.Engine.AddRule('#aim-general-loading > div','padding:3px;position: relative;animation: aim_loading_anim 3s ease-in-out;');

    _.Engine.AddRule('#aim-general-loading > div + div','border-top:#eee solid thin');

    _.Engine.AddRule('#aim-general-loading .aim-general-loading-content','width:calc(100% - 13px);text-shadow:none;overflow:hidden;font-weight:bold');
    _.Engine.AddRule('#aim-general-loading .aim-general-loading-content::before',"content:'Working on';font-weight:normal");
    _.Engine.AddRule('#aim-general-loading .aim-general-loading-content::after',"animation: aim_loading_anim2 3s ease-in-out infinite;content:' .';font-weight:normal");

    _.Engine.AddRule('.aim-general-loading-close','color:red!important;display:inline-block;font-size:1.7em!important;position:absolute;right:4px;top:0;line-height:1em;text-decoration:none;');
    _.Engine.AddRule('@keyframes aim_loading_anim',"0%{opacity:0.5} 20%{opacity:1} 40%{opacity:0.5} 60%{opacity:1} 80%{opacity:0.5} 100%{opacity:1}");

    _.Engine.AddRule('@keyframes aim_loading_anim2',"0%{content:' .'} 25%{content:' ..'} 50%{content:' ...'} 75%{content:' ..'} 100%{content:' .'}");

// Aim Calender default css
_.Engine.AddRule('.calender-displaycont','border:#222 solid thin; height: auto;width: auto;display: block;min-width: 305px;min-height: 400px;background-color: rgba(0, 0, 0, .95);color: #FFF;z-index:400;box-shadow:0 2px 4px 0 rgba(0,0,0,0.7),0 2px 10px 0 rgba(0,0,0,0.7);overflow:hidden');
_.Engine.AddRule('.tables','background-color: transparent;width: 300px;');
_.Engine.AddRule('.tables tr','background-color: transparent !important');
_.Engine.AddRule('.tables td','text-align: center;font-size: 14px;padding:0px');
_.Engine.AddRule('.tables caption','text-align: left;font-size: 14px;padding:5px 20px;font-weight:bold;opacity:0.6;border-bottom:#222 solid thin');
_.Engine.AddRule('.tables thead tr td:first-child button','text-align: left;');
_.Engine.AddRule('.tables td button,.tables td div','background: none;border: transparent solid 2px;font-size: inherit;cursor: pointer;color: #FFF;padding: 10px 5px;width: 100%;height: 100%;');
_.Engine.AddRule('.tables thead td button,.tables thead td div','padding: 5px 5px');
_.Engine.AddRule('.tables td div','cursor: default;padding: 10px 0px');
_.Engine.AddRule('.tables td button:hover','border: #999 solid 2px;font-size: 1.02em;');
_.Engine.AddRule('.tables thead tr td button','opacity: 0.8;');
_.Engine.AddRule('.tables tbody tr td .today','border: orangered solid 2px;');
_.Engine.AddRule('.tables tbody tr td .selected','font-weight: bold;background-color: orangered;');
_.Engine.AddRule('.tables thead tr td button:hover','border: transparent solid 2px;opacity: 1;');
_.Engine.AddRule('.weekcalendar,.monthcalendar,.yearcalendar','position: absolute;z-index: 4;');
_.Engine.AddRule('.monthcalendar .tables td button,.yearcalendar .tables td button','padding: 20px 10px;');
_.Engine.AddRule('.monthcalendar .tables thead td button,.yearcalendar .tables thead td button','padding: 20px 10px;');
_.Engine.AddRule('.inanim','animation: animatezoom1 0.4s cubic-bezier(0.215, 0.61, 0.355, 1)');
_.Engine.AddRule('.outanim','animation: animatezoom2 0.4s cubic-bezier(0.215, 0.61, 0.355, 1)');
_.Engine.AddRule('@keyframes animatezoom1','from {transform: scale(0);opacity: 0;}to {transform: scale(1);opacity: 1;}');
_.Engine.AddRule('@keyframes animatezoom2','from {transform: scale(2);opacity: 0;}to {transform: scale(1);opacity: 1;}');
_.Engine.AddRule('.startblink','animation: blink 0.4s cubic-bezier(0.215, 0.61, 0.355, 1) infinite');
_.Engine.AddRule('@keyframes blink','0% {opacity: 1;}50% {opacity: 0;}100% {opacity: 1;}');


    

    //reduce the display text if smaller screen
    _.Engine.AddRule('@media (max-width:600px){#aim-general-loading',"min-width:200px !important;max-width:95% !important}");

     //#PrintPDF CSS Rules
        _.Engine.AddRule('#aim-printpdf',"position: fixed;height: 100%; width: 100%; z-index: 10; display:none;top:0px;font-family: inherit");
        _.Engine.AddRule("#aim-printpdf-margin-box div strong","-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;font-size:0.9em");
        _.Engine.AddRule("#aim-printpdf-margin-box div strong::after","content: 'mm';color: rgb(141, 137, 137);padding-left:3px;font-size:0.7em");
        _.Engine.AddRule("#aim-printpdf-fontsize::after","content: 'pt';color: rgb(141, 137, 137)");
        _.Engine.AddRule("#aim-printpdf-margin-box hr","border-color:rgb(128, 128, 128)");
        _.Engine.AddRule("#aim-printpdf-footer div > span","margin:0px 8px;font-weight:400");
        //

     
     
     
     _.Engine.AddRule('body.aim-error::before',"content:'Aim Loading Failed !!!'");
     //reduce the display text if smaller screen
     _.Engine.AddRule('@media (max-width:992px){body::before',"font-size:1.3em !important}");
    

     //the closing fading animation
     _.Engine.AddRule('@keyframes aim-loader-close','0%{opacity:1}100%{opacity:0;display:none}');

     

     //if multicolor background is set, set the css animation
     if(_.Trim(_.Engine.Dom.Loader.Backg.toLowerCase()) == "multiple"){
         //color scope (colors to transit in random order)
         //format [backgroundColor, TextColor]
         var colors = [['#2196F3','#FFFFFF'],['#4CAF50','#FFFFFF'],['#3f51b5','#FFFFFF'],['#cddc39','#FFFFFF'],['#ff5722','#FFFFFF'],['#e91e63','#FFFFFF'],['#673ab7','#FFFFFF'],['#ffeb3b','#000000'],['#009688','#FFFFFF'],['#f0e68c','#000000']];
         //set the before animation 
     _.Engine.AddRule('body::before','animation:aim-loader-anim 80s infinite');
     //form random colors animation transition based on the color scope
    var colortrans = "";  //the css color animation transition string
    var randscope = "0123456789"; //the indexes to pic from randomly (random scope)
    var first = 0; //first is expected to be the last (100% - item 11, index 10)
    //loop in number of colors times
    for(var cl=0; cl<colors.length;cl++){
        //base on the random scope, get an index
       var rand = _.Engine.Rand.String(1,randscope);
       //remove gotten index from random scope
       randscope = randscope.replace(rand,"");
       //convert index to integer number
       rand = _.ToInteger(rand);
       first = cl==0?rand:first; //get/keep the first random color index
       //form the transition string and acumulate it
       colortrans += (cl * 10)+"%{color:"+colors[rand][1]+";background-color:"+colors[rand][0]+"}"
    }
    //insert the last, which is the first for a smooth infinity animation effect
    colortrans += "100%{color:"+colors[first][1]+";background-color:"+colors[first][0]+"}";
    //set the css animation keyframe
     _.Engine.AddRule('@keyframes aim-loader-anim',colortrans);
     }else{
         //set the background to the supplied color
        _.Engine.AddRule('body::before','background-color:'+_.Engine.Dom.Loader.Backg+"!important"); 
     }
     //alert(JSON.stringify(_.UrlSplit(document.location.toString())));
    // alert("Root :"+_.Engine.Dom.Loader.Domain + "   ;  AimDir: "+_.Engine.Dom.Loader.Dir);

     
    //***************************************************** */
    
          return true; 	 
        }, 

        //#Loader.Close #Close
        Close:function(){
           //if delay set, wait for delay seconds before displaying page to end-user
           //_.Engine.AddRule('body','overflow:auto !important',1);
            if(_.Engine.Dom.Loader.Delay > 0){
                setTimeout("_.Engine.AddRule('body::after','transition:opacity 1.1s,visibility 1s;visibility:hidden!important;opacity:0 !important')",_.Engine.Dom.Loader.Delay);
                setTimeout("_.Engine.AddRule('body::before','transition:opacity 1.1s,visibility 1s;visibility:hidden!important;opacity:0 !important')",_.Engine.Dom.Loader.Delay);
                
                
            }else{
                //close the loader display, so as to display page to end-user
                _.Engine.AddRule('body::after','transition:opacity 1.1s,visibility 1s;visibility:hidden!important;opacity:0 !important');
                _.Engine.AddRule('body::before','transition:opacity 1.1s,visibility 1s;visibility:hidden!important;opacity:0 !important');
            
            }
        }

    }

  },

  //The Aim Ajax Engine Logic
  //#Ajax
  Ajax:function(){
      //initialize the XMLHTTPRequest Object
	this.req = (function(){
           var mainreq = null;
			if (window.XMLHttpRequest){
                mainreq = new window.XMLHttpRequest	
			}else{
			   if(window.ActiveXObject){
				  try{
                    mainreq = new ActiveXObject("Msxml2.XMLHTTP"); 
				  }catch(err1){
					  try{
                        mainreq = new ActiveXObject("Microsoft.XMLHTTP");
					  }catch(err2){
						  return false;
					  }
				  }
               }
               
				
			}
           // mainreq.Owner = this;
	return mainreq;
    })();

    this.req.Owner = this;
    
    //initialize the user defined parameters
    this.UserHandleProgress = null; //when sending/receiving from server
    this.UserCompleteHandler = null;//when operation completed
    this.UserErrorHandler = null; //when error occur
    this.UserAbortHandler = null; //when operation aborted by user

    //initialize return parameter to user handler
    this.SendData = {};//will hold the data sent to Ajax Post object
    this.URL = "";

    //The main ajax post object (HTML 5)
    //#Post #Ajax.Post
    this.Post = function(param){
       //if no user parameter sent
        if(typeof param == _.UND){
            console.log("Aim Ajax Failed: No Parameter provided for Aim Ajax Object");
            return;
        }
        //if no server script sent
        if(typeof param.Action == _.UND){
            console.log("Aim Ajax Failed: No Action Script provided for Aim Ajax Object");
            return;
        }
		//if cannot create httpxmlrequest
		if(!this.req){
			console.log('Aim Ajax Failed: Unable to create required object');
			return;
		}

        //instantiate a new FormData Object to package all user sent post data.
		var formdataObj = new FormData();
		//if no post data sent 
		if(typeof param.Data == _.UND){
               param.Data = {};
		}
            var dataarr = param.Data;
            //if is data string, convert to array
			if(_.IsString(param.Data)){
                dataarr = _.ToDataArray(param.Data);
            }
            
          //loop through individual data supplied
            for (var key in dataarr) {
                if (dataarr.hasOwnProperty(key)) {
                    var value = dataarr[key];
                    //add to the SendData Ajax object, which will be send back to user handlers
                    this.SendData[key] = value;
                    //if value is "?" (meaning a file is sent)
                    //the key represent the file element id
                    if(value == "?"){ //if file
                        //loop through all files of the file element and append it to the filedata object                        
                         var file = _(key);
                         if(typeof file.files == "undefined")continue;
                         if(file.files.length > 0){
                             if(file.files.length == 1){//if one item
                                formdataObj.append(key, file.files[0]);
                             }else{
                             for (var fi = 0; fi < file.files.length; fi++) {
                                formdataObj.append(key+"[]", file.files[fi]);
                             }
                            }
                         }
                         
                     }else{
                         formdataObj.append(key, value);
                     }
                }
            }
         
            
	    
        
        //set user define handlers
        //OnProgress
        if(typeof param.OnProgress != _.UND){this.UserHandleProgress = param.OnProgress;}
        //OnComplete
        if(typeof param.OnComplete != _.UND){this.UserCompleteHandler = param.OnComplete;}
        //OnError
	   if(typeof param.OnError != _.UND){this.UserErrorHandler = param.OnError;}
	   //OnAbort
	   if(typeof param.OnAbort != _.UND){this.UserAbortHandler = param.OnAbort;}
	  
	  if(this.UserHandleProgress != null){
	  this.UserHandleProgress(0,param.Action,dataarr); //make sure it start loading
      }
      
      //set the xhtmlrequest event handlers (internal Handler - it checks if user handler exist else use default)
      //onprogress
		this.req.upload.addEventListener("progress", this.HandleProgress, false);
		this.req.upload.Owner = this.req; //keep the owner inside it
		//obload
    this.req.addEventListener("load", this.HandleComplete, false);
    //onerror
    this.req.addEventListener("error", this.HandleError, false);
    //onabort
	this.req.addEventListener("abort", this.HandleAbort, false);
	
    //the server script
	this.URL = param.Action;
	//the open conection with server
	this.req.open("POST", param.Action);
	//send post data
    this.req.send(formdataObj);
    //return the ajax object
    return this;
    }
   //function to handle progress
	this.HandleProgress = function(event){
        var own = event.target.Owner.Owner
       // alert(own);
		if(own.UserHandleProgress != null)own.UserHandleProgress(event.loaded/event.total,own.URL,own.SendData);
	}
	//handle complete operation
	this.HandleComplete = function(event){
        var own = event.target.Owner;
        //alert(own.SendData);
        if(own.UserCompleteHandler != null)own.UserCompleteHandler(event.target.responseText,own.URL,own.SendData);
	 	//event.target.Owner.UserCompleteHandler = null;
    }
    //handle error
	this.HandleError = function(event){
        var own = event.target.Owner;
        if(own.UserErrorHandler != null)own.UserErrorHandler(event.target.statusText,own.URL,own.SendData);
    }
  //handle abort
	this.HandleAbort = function(event){
        var own = event.target.Owner;
        if(own.UserAbortHandler != null)own.UserAbortHandler(event.target.statusText,own.URL,own.SendData);
    }
    //Abort the request
	this.Abort = function(){
		if(this.req){
		  this.req.onreadystatechange = function() {};
		  this.req.abort();
		  this.req = null;
		}
		
	}
	
  },

  //The Animation Engine Logic
  //************************************************************** */

  //Animation Globals
  //____________________________________________
  //Global array holding all animation
  Animations:[],
  //pre-defined handlers
  AnimationEffectJS:{
    Bounce:function(progress){
        for(var a = 0, b = 1, result; 1; a += b, b /= 2) {	    
            if (progress >= (7 - 4 * a) / 11) {	     
             return -Math.pow((11 - 6 * a - 11 * progress) / 4, 2) + Math.pow(b, 2);	
             
            }
    }
  }
},
  //Builtin animation effect for css
  AnimationEffects:{
     FadeIn:{0:"opacity:0",1:"opacity:1"},
     FadeOut:{0:"opacity:1",1:"opacity:0"},
     ZoomIn:{0:"transform:scale(0);opacity:0",1:"transform:scale(1);opacity:1"},
     ZoomOut:{0:"transform:scale(1);opacity:1",1:"transform:scale(0);opacity:0"},
     LeftIn:{0:"left:-300px;opacity:0",1:"left:0px;opacity:1"},
     TopIn:{0:"top:-300px;opacity:0",1:"top:0px;opacity:1"},
     RightIn:{0:"right:-300px;opacity:0",1:"right:0px;opacity:1"},
     BottomIn:{0:"bottom:-300px;opacity:0",1:"bottom:0px;opacity:1"},
     LeftOut:{0:"left:0px;opacity:1",1:"left:-300px;opacity:0"},
     TopOut:{0:"top:0px;opacity:1",1:"top:-300px;opacity:0"},
     RightOut:{0:"right:0px;opacity:1",1:"right:-300px;opacity:0"},
     BottomOut:{0:"bottom:0px;opacity:1",1:"bottom:-300px;opacity:0"},
     BounceIn:{0:"transform:translateY(-100%);opacity:0",
             0.05:"transform:translateY(-100%);",
             0.15:"transform:translateY(0);",
             0.30:"transform:translateY(-50%);",
             0.40:"transform:translateY(0%);",
             0.50:"transform:translateY(-30%);",
             0.70:"transform:translateY(0%);",
             0.80:"transform:translateY(-15%)",
             0.90:"transform:translateY(0%);",
             0.95:"transform:translateY(-7%);",
             0.97:"transform:translateY(0%);",
             0.99:"transform:translateY(-3%);",
             1:"transform:translateY(0);opacity:1"
            },
    BounceOut:{1:"transform:translateY(-100%);opacity:0",
            0.99:"transform:translateY(-100%);",
            0.97:"transform:translateY(0);",
            0.95:"transform:translateY(-50%);",
            0.90:"transform:translateY(0%);",
            0.80:"transform:translateY(-30%);",
            0.70:"transform:translateY(0%);",
            0.50:"transform:translateY(-15%)",
            0.40:"transform:translateY(0%);",
            0.30:"transform:translateY(-7%);",
            0.15:"transform:translateY(0%);",
            0.05:"transform:translateY(-3%);",
            0:"transform:translateY(0);opacity:1"
           }
  },
  //Easing
  Easing:{
    // no easing, no acceleration
    'linear': function (t) { return t },
    // accelerating from zero velocity
    'ease-in': function (t) { return t*t },
    // decelerating to zero velocity
    'ease-out': function (t) { return t*(2-t) },
    // acceleration until halfway, then deceleration
   
    'ease': function (t) { return t<.5 ? 2*t*t : -1+(4-2*t)*t },
    // accelerating from zero velocity 
    easeInCubic: function (t) { return t*t*t },
    // decelerating to zero velocity 
    easeOutCubic: function (t) { return (--t)*t*t+1 },
    // acceleration until halfway, then deceleration 
    "ease-in-out": function (t) { return t<.5 ? 4*t*t*t : (t-1)*(2*t-2)*(2*t-2)+1 },
    // accelerating from zero velocity 
    easeInQuart: function (t) { return t*t*t*t },
    // decelerating to zero velocity 
    easeOutQuart: function (t) { return 1-(--t)*t*t*t },
    // acceleration until halfway, then deceleration
    easeInOutQuart: function (t) { return t<.5 ? 8*t*t*t*t : 1-8*(--t)*t*t*t },
    // accelerating from zero velocity
    easeInQuint: function (t) { return t*t*t*t*t },
    // decelerating to zero velocity
    easeOutQuint: function (t) { return 1+(--t)*t*t*t*t },
    // acceleration until halfway, then deceleration 
    easeInOutQuint: function (t) { return t<.5 ? 16*t*t*t*t*t : 1+16*(--t)*t*t*t*t }
  },
  //function to calculate delta base on the effect
  CalculateDelta:function(progress,effect,ease,inverse){
    delta = 0;
    //effect = _.Trim(effect);
    progress = (inverse)?1 - progress:progress;
   /* if(effect.toLowerCase().substr(0,11) == "exponential" ){ //if style is exponential i.e slow from start and increase

       var poww = (effect.length == 11)?2:_.ToInteger(effect.substr(11));
       poww = poww <= 2?2:poww;
        delta = Math.pow(progress,poww);
    }else if(effect.toLowerCase() == "elastic"){ 
       var x = 80; //the elastic index modify as required
        delta = Math.pow(2, 10 * (progress-1)) * Math.cos(20*Math.PI*x/3*progress);
    }else if(effect.toLowerCase() == "bounce"){ //if style is bounce //code is complicated DUY(Dont Understand Yet)
        //progress = 1 - progress;
        for(var a = 0, b = 1, result; 1; a += b, b /= 2) {	    
          if (progress >= (7 - 4 * a) / 11) {	     
           delta = -Math.pow((11 - 6 * a - 11 * progress) / 4, 2) + Math.pow(b, 2);	
           break;
          }
        }
        
    }else{//no effect
        delta = progress;
    }*/
    return typeof _.Engine.Easing[ease] == _.UND?_.Engine.Easing['easeOutQuad'](delta):_.Engine.Easing[ease](delta);
},
//hold the Animation Directions an their css animation equivalent
CSSDirections:{"to":"normal","fro":"reverse","to-fro":"alternate","fro-to":"alternate-reverse"},

//Animation Globals Ends
//_____________________________________________________________________


  //#Animation Object
  //___________________________________________________________
  Animation: function(Param){
     Param = Param || {};

    //the element(s) to animate (aim finder selector allowed, array allowed)
    this.Target = _.Engine.RP(Param.Target || document.documentElement);

    //make target an array, to avoid checking if array or not every time is to be work on
    this.Target = !IsArray(this.Target)?[this.Target]:this.Target;

    //the delay time before animation start
    this.Delay = Param.Delay || 0;
    //functions / operation to trigger/run during animation
    //Structure : {Delta:<the animation time/level to run trigger>,Action:<the operation to perform>}
    //NB: Action can be an animation name , a function or a Goto keyframe number
    this.Trigger = Param.Trigger || {};
    //the trigger object that will be use technically, it will be edited at the cause of the animation, but when animation is restarted, it will be reset
    this.ProcessTrigger = {};

    //Set the animation name and add the animation to the aim animations global array
    if(typeof Param.Name != _.UND && _.IsString(Param.Name) && Param.Name != ""){
        //set the animation name
        this.Name = Param.Name;
        
    }else{
        var randname = _.Random(10);
        while(typeof _.Engine.Animations[randname] != _.UND){
            randname = _.Random(10);
        }
        this.Name = randname;
    }

    
    //Type of Animation
    this.Type = Param.Type || "JS"; //JS | CSS
    //NB: CSS Animation Type do not support Pause operation

    /*//set the animation handler
    this.OnPlay = Param.OnPlay || _.Engine.AnimationHandlers.FadeIn;
    //NB: OnPlay for CSS type should be the css rule to animate*/

    //animation duration
    this.Duration = Param.Duration || 1;

    //Start Time
    this.StartTime = null;

    //Effect
    this.Effect = Param.Effect || 'FadeIn'; //if String (pre defined effect), Function (user defined javascript effect - javascript animation), Object (user defined keyframes - css animation e.g {0:"cssRule1",1:"cssRule2"})

    this.Ease = Param.Ease || 'ease';

    

    //Infinite animation
    this.Infinite = Param.Infinite || false;

    //Retain animation last frame
    this.Retain = Param.Retain || true //default - true


  //animation State
    this.State = "Stop"; //Play | Pause | End | Stop (default)

    //animation Progress
    this.Progress = 0;

    //pause progress level
    this.ProgressStart = 0;

    //function to run when animation starts
    this.OnStart= Param.OnStart || function(){}

    //function to run when animation ends
    this.OnEnd= Param.OnEnd || function(){}

    //function to run when animation is paused
    this.OnPause= Param.OnPause || function(){}

    this.FromFrame = 0; //the frame index where css animation will start from, usually set by Goto method

    //internal method holding the direction
    this.Flow = "to";

    //the delay time (seconds)
    this.Delay = Param.Delay || 0;

    this.DirectionArray = ['to'];

    var AnimationObj = this; //make the animation object available to sub functions

    Object.defineProperties(AnimationObj, {
        'Type': { get: function() { return _.IsFunction(this.Effect)?"JS":"CSS" } }
    });
    Object.defineProperties(AnimationObj, {
        'Direction': { get: function() {return this.Flow },
                       set:function(dir){this.Flow = dir;this.DirectionArray = dir.split("-")}}
    });

    //Animation Direction 
    AnimationObj.Direction = Param.Direction || "to"; //to | fro | to-fro | fro-to

    //The animation frame object
    this.AnimationFrame = null;


//#CSS Animation Methods and Properties
//**************************************************************    
//#CSS Animation #Play Methods
   this.PlayCSSAnimation = function(fromFrame){
   //#log
  // _.Log("CSS Animation Module Entered");
    var dur_sec = (1-this.FromFrame)*this.Duration ;
    //#log
   // _.Log("Calculated Duration: "+dur_sec*1000);
    //#log
    //_.Log("Animation Delay: "+this.StartTime);
    //the number of times animation will move
    var animMovenum = this.DirectionArray.length;
    var animcnt = this.Infinite?"infinite":animMovenum;
    var mainduration = (dur_sec*1000*animMovenum)+(this.Delay*1000);

       //if currently paused
       if(this.State == "Pause"){
           this.State = "Play";
          // _.Log('Played after Pause');
        _.Each(this.Target,function(tar){
          tar.style.animationPlayState = "running";
        });
        //this.Target.style.animationPlayState = "running";
        if(!this.Infinite){ //if not infinite animation, set the end detreminant timmer
            this.AnimationFrame = setTimeout(this.CSSAnimationEnd,mainduration - this.ProgressStart);
        }

        //recalculate all avialable triggers time and #start timeout #Trigger
        this.StartCSSTrigger();
        
        this.StartTime = new Date().getTime();
        return;
       }
       this.State = "Play";
       
       //loop trough Effect keframes and form the css keyframe rule string
       if(_.IsObject(this.Effect)){
           var keyframes = "";
           var frame = "";
           //reset the FromFrame rule set during play goto operation
           var cnt = 0;
           for(frame in this.Effect){
            if (this.Effect.hasOwnProperty(frame) && frame >= this.FromFrame) {
                style = this.Effect[frame];
               if(cnt == 0){ //initialize the last and first
                this.LastFrameIndex = this.FirstFrameIndex = _.ToFloat(frame);
               }
               //convert the frame progress to percentage
               var progr = Math.floor(_.ToFloat(frame) * 100);
               //add to keyframes
               keyframes += progr + "%{"+style+"}";
               this.FirstFrameIndex = _.ToFloat(frame) < this.FirstFrameIndex ?_.ToFloat(frame):this.FirstFrameIndex;
               this.LastFrameIndex = _.ToFloat(frame) > this.LastFrameIndex ?_.ToFloat(frame):this.LastFrameIndex;
               cnt++;
            }
           }
           
           if(this.FromFrame == 0){ //if not to start from Goto keyframes (start from bigining)
               //clear any goto rule set
               AnimationObj.ClearGotoRule(this.FromFrame); 
           }
           //remove the prevously generated animation keyframes
           if(this.KeyFramesIndex != null){
             _.Engine.RemoveRule(this.KeyFramesIndex);
           }
           var nn = _.Random(8); 
           //set the css rule
           this.KeyFramesIndex = _.Engine.AddRule('@keyframes '+nn,keyframes,this.KeyFramesIndex);
           var dir = _.Engine.CSSDirections[this.Direction];
           //get the retain attribute
           var retain = this.Retain?"forwards":"none"
           //set the animation
           //var elem = _.IsArray(this.Target)?this.Target:[this.Target];
           this.StartTime = new Date().getTime(); //the start time
           for(var d=0;d<this.Target.length;d++){
               //if to start from a particular keyframe, set the element to the style rule of the start keyframe
               if(typeof this.Effect[this.FromFrame] != _.UND)_.Style(this.Target[d],this.Effect[this.FromFrame]);
               
               _.Style(this.Target[d],"animation:"+nn+" "+retain+" "+dur_sec+ "s "+ animcnt + " " + this.Delay + "s " + dir+ " " + this.Ease);
           }
           //_.Log("First:"+this.FirstFrameIndex+" ; Last:"+this.LastFrameIndex)
           
           //Start all #CSS #Trigger Timmer
           this.StartCSSTrigger();

           

           //if not infinite animation set the timmer to determine ending
           if(!this.Infinite){
           //set a timeout to determin when animation finishes
           clearTimeout(this.AnimationFrame);
           
           this.AnimationFrame = setTimeout(this.CSSAnimationEnd,mainduration);
           }
       }


   }

   //start all css triggers #Triggers CSS
   this.StartCSSTrigger = function(){
       //form triggers timeouts
       
       for(k in this.ProcessTrigger){
        if(this.ProcessTrigger.hasOwnProperty(k)){
            if(this.ProcessTrigger[k] != null){
         this.CSSTriggerTimmers[k] = setTimeout("_.Engine.Animations['"+this.Name+"'].PerformTrigger("+k+")",(k*this.Duration* 1000) + (this.Delay*1000) - this.ProgressStart);
        // _.Log("_.Engine.Animations['"+this.Name+"'].PerformTrigger("+k+")"+" => "+((k*this.Duration* 1000) + (this.Delay*1000) - this.ProgressStart));
            }
        }
    }
   }


   //clear or terminate all css trigger timmer
   //#ClearCssTriggerTimmer
   this.ClearCSSTriggerTimmer = function(){
       for (var tt in this.CSSTriggerTimmers) {
           if (this.CSSTriggerTimmers.hasOwnProperty(tt)) {
               clearTimeout(this.CSSTriggerTimmers[tt]);
           }
       }
   }

   this.CSSTriggerTimmers = [];

   //delay
   // the index of the css rule of the animation keyframes in the aim style sheet (for css type only)
   this.KeyFramesIndex = null;

   //the css last frame rule index, for End method operation. will be set during CSS play Method
   this.LastFrameIndex = 1;

   this.FirstFrameIndex = 0;

   //#End #CSSAnimation - runs whwn css animation completes
   this.CSSAnimationEnd = function(){
      AnimationObj.State = "End";
      //reset the total time spent by the animation to 0
      AnimationObj.ProgressStart = 0;
      //if the just concluded animation starts from a Goto animation frame index
      if(AnimationObj.FromFrame > 0 && typeof AnimationObj.Effect[AnimationObj.FromFrame] != _.UND){
          //clear any goto rule set
          AnimationObj.ClearGotoRule(AnimationObj.FromFrame);
      }
      AnimationObj.FromFrame = 0; //reset the from farme (frame index where animation will start for css animation)
      if(AnimationObj.Retain){
          
          var retainFrameIndex = AnimationObj.DirectionArray[AnimationObj.DirectionArray.length - 1] == "fro"?AnimationObj.FirstFrameIndex:AnimationObj.LastFrameIndex;
          //set the target style to the last keyframe (workaround, incase the css animation forwards attribute is not considered by browser)
          AnimationObj.Target.Style = AnimationObj.Effect[retainFrameIndex];
      }
//_.Log('End');
      AnimationObj.OnEnd({Target:AnimationObj.Target}); //run the OnEnd Handler
   }

   //Clear all the rule supplied from the target inline style
   this.ClearGotoRule = function(frameindex){
    var fromRulearray = this.Effect[frameindex].ToStyleArray();
   // _.Log(this.Effect[frameindex]);
    if(fromRulearray.length > 0){
        for(sel in fromRulearray){
           if (fromRulearray.hasOwnProperty(sel)) {
               _.Each(this.Target,function(tar){
                tar.style[sel] = "";
               })
               
           }
        }
       // _.Log(fromRulearray.ToStyleString());
       // _.Style(AnimationObj.Target,fromRulearray.ToStyleString());
    }
    return true;
   }


   //End of CSS Animation Method and Properties
   //***************************************************** */



   //Javascript Animation Method and Properties
   //************************************************** */
   //propertiy to hold the current animation direction index
   this.DirectionIndex = 0;
  //the Animation direction(s) in array format
   
    //perform the animation by running it reculsively using requestAnimation Frame obj
    //#PlayJSAnimation JS Animation
    this.PlayJSAnimation = function(frameTime){
        //console.log("StartTime:"+AnimationObj.StartTime);
        frameTime = frameTime || new Date().getTime();// the curent frameTime
        //console.log("AnimTime:"+frameTime);
        var timepass = frameTime - AnimationObj.StartTime; //the Time Passed
        //console.log("TimePass:"+timepass);
        var progress = timepass / (AnimationObj.Duration * 1000); //the progress based on the duration

        //add pause progress incase the animation has been paused once
        progress = AnimationObj.ProgressStart + progress;
        //console.log("Progress:"+progress)
        //alert(AnimationObj.StartTime);
        progress = progress > 1?1:progress;
      // var delta = _.Engine.CalculateDelta(progress,AnimationObj.Effect,AnimationObj.Ease,AnimationObj.Inverse)
        var delta = AnimationObj.Delta(progress);
       //console.log("delta:"+delta)
       for(var del =0; del<AnimationObj.Target.length; del++){
        AnimationObj.Effect(delta,AnimationObj.Target[del]);
       }

       //perform #Trigger
       for (var key in AnimationObj.ProcessTrigger) {
           if (AnimationObj.ProcessTrigger.hasOwnProperty(key)) {
               if(key <= progress && AnimationObj.ProcessTrigger[key] != null){
                //AnimationObj.ProcessTrigger[key] = 
                   //perform the trigger
                   AnimationObj.PerformTrigger(key);
               }
               
           }
       }
       
       if(progress < 1){
        
            AnimationObj.AnimationFrame = RequestFrame(AnimationObj.PlayJSAnimation);
        //update the current Progress value
        AnimationObj.Progress = progress; 
       }else{
        AnimationObj.State = "End";
           //if finish set progress and ProgressStart to 0
        AnimationObj.Progress = AnimationObj.ProgressStart = 0;
        //increament Direction Index
        AnimationObj.DirectionIndex += 1;
        //check if double direction animation
        var dbldir = false;
        if(typeof AnimationObj.DirectionArray[AnimationObj.DirectionIndex] != _.UND){
            dbldir = true;
        }else{
            AnimationObj.DirectionIndex = 0;  
        }
        //if infinte, start animation again
        if(AnimationObj.Infinite || dbldir){
            AnimationObj.StartJSAnimation();
        }else{
            AnimationObj.OnEnd({Target:AnimationObj.Target});
        }
       }
    },

    //function to recalculate delta based on inverse and ease
    this.Delta = function(progress){
        //if progress is sent to Delta function when not during play, dont perform a fro delat calculations
        var delta = this.DirectionArray[this.DirectionIndex].toLowerCase() == "fro" && this.State == "Play"?1-progress:progress;
        delta = _.Engine.Easing[this.Ease] == _.UND?_.Engine.Easing['ease'](delta):_.Engine.Easing[this.Ease](delta);
        return delta;
    }


    //function to #Start JS Animation
    this.StartJSAnimation = function(){
        AnimationObj.DelayStartTime = null; //reset, meaning delay has finished
        AnimationObj.DelayRem = this.Delay*1000;
        AnimationObj.AnimationFrame = RequestFrame(function(frameTime){
            AnimationObj.StartTime = frameTime;
            AnimationObj.State = "Play";
            AnimationObj.PlayJSAnimation(frameTime);
          });
    },

    //JS animation property to time delay start
    this.DelayStartTime = null;

    this.DelayRem = this.Delay *1000;

    this.DelayTimmer = null;

    //End of JavaScript Animation Methods and Properties
    //*************************************************** */




    //General Animation Methods
    //************************************************** */
 //play the animation
    //#Play
    this.Play = function(param){
        if(this.State == "Play"){
        console.log("Operation Denied: Animation("+this.Name+") is playing");
        return;
        }
        //if animation properties,methods or event handler are send during Play call
        //loop trough, and set appropriately
        if(typeof param != _.UND){
            for (var key in param) {
                if (param.hasOwnProperty(key)) {
                    if(typeof this[key] != _.UND){
                        this[key] = param[key];
                    }
                }
            }
        }
        //reset the animation process trigger #Reset Process #Trigger
        if(this.State != "Pause" && this.State != "GotoPause"){
           this.ResetProgressTrigger();
        }
       
     // run the onstart handler
     //#OnStart Animation
     this.OnStart({Target:this.Target});
     
     if(_.IsFunction(this.Effect)){//if JS Animation
       if(this.Delay > 0 && this.State != "Pause" && this.State != "GotoPause"){
           if(this.State == "End"){ //if the last operation before play is clicked if End operation
            //make the target move to the initial state, indicating animation as started but in a delay (simulating thesame effect of CSS animation)
            var delta = this.Delta(0);
            for(var del =0; del<this.Target.length; del++){
                this.Effect(delta,this.Target[del]);
               }
            
           }
        this.State = "Play";
        this.DelayStartTime = new Date().getTime();
           this.DelayTimmer = setTimeout(this.StartJSAnimation,this.Delay*1000)
       }else{
           if(this.DelayStartTime != null){//if paused when in delay
            //continue delay
            this.State = "Play";
            this.DelayStartTime = new Date().getTime();
            this.DelayTimmer = setTimeout(this.StartJSAnimation,this.DelayRem)
           }else{
        this.StartJSAnimation();
           }
       }
    }else if(_.IsObject(this.Effect)){ //if CSS Animation with keyframes set
        this.StartTime = new Date().getTime();
        this.PlayCSSAnimation();
        //#log
       // _.Log("CSS Animation Started in Gen Play at: StartTime="+this.StartTime);
    }else{//expected to be string. if inbuild effect
      this.Effect = this.Effect.toString();
      //check if not exist and use default
      this.Effect = typeof _.Engine.AnimationEffects[this.Effect] == _.UND?_.Engine.AnimationEffects['FadeIn']: _.Engine.AnimationEffects[this.Effect];
      this.StartTime = new Date().getTime();
      this.PlayCSSAnimation();
    }
    }

    //#Pause - perform pause
    this.Pause = function(){
        // this.Target.style.animationPlayState = "paused"
         if(this.State == "Play"){
          //check if animation type is js
          if(this.Type == "JS"){
              //if in delay state, 
              if(this.DelayStartTime != null){
                  //stop the delay timmer
                  clearTimeout(this.DelayTimmer);
                this.DelayRem = (this.DelayRem) - (new Date().getTime() - this.DelayStartTime); // keep the total delay time remaining

              }else{
           //cancel the animation frame
           CancelFrame(this.AnimationFrame);
           //keep the current animation progress in ProgressStart. so that it can be use to start animation where it paused
           this.ProgressStart = this.Progress;
              }
             }else{ //if css
                _.Each(this.Target,function(tar){
                   tar.style.animationPlayState = "paused"; 
                });
                  
                //stop the end of animation timmer
                clearTimeout(this.AnimationFrame);
                //stop all trigger timmer
                this.ClearCSSTriggerTimmer();

                //get the time spent so far
                //acummulate the total time spent by the animation in playing state
                this.ProgressStart += new Date().getTime() - this.StartTime;
             }

             this.OnPause();
             //set animation object state to pause
             this.State = "Pause";
             return true;
         }
     }
 
     //#Goto - goto a particular frame / level
     this.Goto = function(frameIndex){
        //Not allowed for infinity or bi-directional animation
        if(this.Infinite && frameIndex > 0){
            _.Log("Jump/End not allowed during Infinite Animation");
            return;
        }
        if(this.DirectionArray.length > 1 && frameIndex > 0 && frameIndex < 1){
            _.Log("Jump not allowed during Bi-Directional Animation");
            return;
        }

         frameIndex = _.ToFloat(frameIndex);
         //terminate the current animation
         //cancel the animation frame
         
        
         //if current state is Play, replay the animation
         if(this.State == 'Play'){
             if(this.Type == "JS"){ //js animation type
             CancelFrame(this.AnimationFrame);
             this.State = "Pause";//this will enable the replay
              //reset the Starting value of progress
             this.ProgressStart = frameIndex;

             this.Play();
             }else{
                 this.State = "GotoPause";
                 for(var n=0;n<this.Target.length;n++){
                     this.Target[n].style.animationPlayState = "paused";
                 _.Style(this.Target[n],this.Effect[frameIndex]);
                 }
                 
                 this.FromFrame = frameIndex; //specify which frame to start animation from
                this.Play(); //play the animation
             }
         }else{
           
             if(this.Type == "JS"){ //js animation type
                 //stop the delay timmer
                 clearTimeout(this.DelayTimmer);
                 CancelFrame(this.AnimationFrame);
                 this.ProgressStart = frameIndex == 1?0:frameIndex; //if finish animation reset the PrograaStart to 0, so that when replay it starts from the biginning
                 if(this.ProgressStart == 0){ //if stoped or end
                    this.DirectionIndex = 0; //reset the animation direction
                 }
                 var delta = this.Delta(frameIndex);
                 for(var g=0;g<this.Target.length;g++){
                     this.Effect(delta,this.Target[g]);
                 }
                 
             
             }else{ //css animation type
                 clearTimeout(this.AnimationFrame);
                 _.Each(this.Target,function(tar){tar.style.animation = "";})
                 
                 //remove the prevously generated animation keyframes
                 if(this.KeyFramesIndex != null){
                     _.Engine.RemoveRule(this.KeyFramesIndex);
                     this.KeyFramesIndex = null;
                 }
                 
                 //if to goto a particular key frame.
                 //NB: the distination keyframe is not part of the user define keyfarme in Effect, the last keyframe will be used
                   //if the keyframe sent does not exist use the last keyframe, i.e go to the last frame
                       frameIndex =typeof this.Effect[frameIndex] == _.UND? this.LastFrameIndex:frameIndex;
                     //set the inline style attribute of the target to the Goto frame index style rule
                     for(var s=0;s<this.Target.length;s++){
                        _.Style(this.Target[s],this.Effect[frameIndex]); 
                     }
                      
                   //}
                   //reset the from frame to the frameindex
                   if(frameIndex == 0 || frameIndex == 1){
                     this.FromFrame = 0;
                     
                   }else{
                     this.FromFrame = frameIndex
                 }
                 //reset the progressStart time
                 this.ProgressStart = 0
                 //}
             }
             this.OnEnd({Target:this.Target});
         }
     }
     
 
     //#Stop Perform Stop - will stop the animation and return back to the starting point
     this.Stop = function(){
        // this.Target.style.animationPlayState = "";return;
        /* if(this.State != "Play" && this.State != "Pause"){
             console.log("Aim Animation: Stop can only be performed during Play");
             return;
         }*/
         this.State = 'Stop';
 
         this.Goto(0);
     }
 
     //#End Perform End - will end the animation, by going to the last frame
     this.End = function(){
         this.State = 'End';
         this.Goto(1);
     }
    //#PerformTrigger #Trigger => function to start trigger animation or run function or goto keyframe as required
     this.PerformTrigger = function(keyframe){
        var trigger = this.ProcessTrigger[keyframe] || null;
        if(trigger == null)return;
       //if trigger is array, perform the function on each item of the array
       if(_.IsArray(trigger)){
           for(var t=0;t<trigger;t++){
               this.PerformTrigger(trigger[t]);
           }
           return;
       }

       //if trigger type if function, run the function
       if(_.IsFunction(trigger)){trigger();}

       //if trigger is number, perform a Goto
       if(_.IsNumber(trigger)){this.Goto(trigger)}

       //if is string get the animation object
       var triggeranimobj;
       if(_.IsString(trigger)){
        triggeranimobj = _.Engine.Animations[trigger] || null;
       }else{ //if it is object
        triggeranimobj = trigger 
       }

       if(triggeranimobj != null && triggeranimobj instanceof _.Engine.Animation){
         //set the trigger animation's Timeline to the current animation timeline. cos, any animation that is triggered by another animation is automatically in the same timeline
         triggeranimobj.Timeline = this.Timeline;  
        triggeranimobj.Play();
       }

       //remove the trigger
       this.ProcessTrigger[keyframe] = null;
       delete this.ProcessTrigger[keyframe];


     }

     //#Reset Process #Trigger Object
     this.ResetProgressTrigger = function(){
        this.ProcessTrigger = {};
        for (var rt in this.Trigger) {
            if (this.Trigger.hasOwnProperty(rt)) {
                this.ProcessTrigger[rt] = this.Trigger[rt];
                
            }
        }
     }

     //#Timeline Name if attached to a timeline
     this.Timeline = "";

//End of General Animation Methods
    //************************************************** */




    //add this animation object to aim global animations array
   //NB: if user defined name exist, it will replace it
    _.Engine.Animations[this.Name] = this;
    
  },
  //End of Aim animation Object

  //Aim #Timelines arrays
  Timelines:[],

  //Aim Timeline Object
  //#Timeline
  Timeline:function(){
   //expected argurments are valid Aim Animation Objects

   //Timeline Name
   var randname = _.Random(10);
   while(typeof _.Engine.Timelines[randname] != _.UND){
       randname = _.Random(10);
   }
   this.Name = randname;

   //Internal array holding all addeded animation objects
   this.Animations = {length:0};

   //Method to #AddAnimation Objects
   this.AddAnimation = function(){
       //expected argurments are valid Aim Animation Objects
       if(arguments.length < 1)return;
       
       for(var d=0; d<arguments.length; d++){
           var animobj = arguments[d];
           if(_.IsString(animobj) && typeof _.Engine.Animations[animobj] != _.UND){
               animobj = _.Engine.Animations[animobj];
           }
           
           if(animobj instanceof _.Engine.Animation){
               animobj.Timeline = this.Name;
               this.Animations[animobj.Name] = animobj;
               this.Animations.length++;
           }
       }
       //_.Log(this.Animations.length)
   }

   //Determine if Timeline is setup
   this.IsSetup = false

   //the Timeline State
   this.State = "Stop"; //Play | Pause

   //#Play the Timeline
   this.Play = function(setupstr){
       //check if the current state is Pause
       if(this.State == "Pause"){
           //loop trough all Timeline animations and play all paused onces
           for (var akey in _.Engine.Animations) {
            if (_.Engine.Animations.hasOwnProperty(akey) && _.Engine.Animations[akey].Timeline == this.Name && _.Engine.Animations[akey].State == "Pause") {
             _.Engine.Animations[akey].Play();
             
            }
        }
        this.State = "Play";
        return;
       } 
       //check if no setup found
      if((typeof setupstr == _.UND || _.Trim(setupstr) == "") && !this.IsSetup)this.PlayAll();
      //if setup string exist run setup
       var setup = (typeof setupstr != _.UND && _.Trim(setupstr) != "")?this.Setup(setupstr):true;
       if(setup){
          _.Engine.Animations[this.Starter].Play();
       }else{
           _.Log("Invalid Aim Timeline Setup");
       }
   }

   //#PlayAll Animation
   this.PlayAll = function(){
       for (var key in this.Animations) {
           if (this.Animations.hasOwnProperty(key) && this.Animations[key] instanceof _.Engine.Animation) {
            this.Animations[key].Play();
           }
       }
   }

   //#Starter, the first animation to play
   this.Starter = "";

   //#Setup the Timeline
   this.Setup = function(setupstr){
     //perform setup
     //format AnimationName1:TriggerTime=>AnimationName2:TriggerTime=>......=>AnimationNameN
     this.IsSetup = false;
     if(typeof setupstr == _.UND || _.Trim(setupstr) == "" || !_.IsString(setupstr)) return false;

     //get individual animations
     var Anims = setupstr.split("=>");
     if(Anims.length > 0){
         for(var s=0;s<Anims.length;s++){//loop through all the animation
          var animtrig = Anims[s]; //get the animation details (Name:Trigger)
          var animtrigArr = animtrig.split(":");//Split to get the name and triggerTime
          var animName = animtrigArr[0]; //get Name
          if(s==0)this.Starter=animName; //if the first animation details, set the animation name as the first animation to run by the Timeline
          //get the next AnimationName if exist
          var nxtAnimName = (typeof Anims[s + 1] != _.UND)?Anims[s + 1].split(":")[0]:"";
          //get the trigger time if set, else use 1
          var triggerTime = (typeof animtrigArr[1] != _.UND)?_.ToFloat(animtrigArr[1]):1;
          //set the trigger
          if(nxtAnimName != ""){ //if next animation name exist
            //set the animation trigger to the next animation name
        _.Engine.Animations[animName].Trigger[triggerTime>1?1:triggerTime] = nxtAnimName;
          }
                
         }
         //set the IsSetup to true (meaning the setup done)
         this.IsSetup = true;
         return true;
     }
    return false;
   }

   //#Pause Timeline
   this.Pause = function(){
       //loop through all the timeline animation and pause them
       var cnt = 0;
       for (var akey in _.Engine.Animations) {
           if (_.Engine.Animations.hasOwnProperty(akey) && _.Engine.Animations[akey].Timeline == this.Name) {
            _.Engine.Animations[akey].Pause();
            cnt++;
           }
       }
       if(cnt > 0)this.State = "Pause";
   }

   //#Stop Timeline
   this.Stop = function(){
    //loop through all the Timeline animation and stop them
    var cnt = 0;
    
    for (var akey in _.Engine.Animations) {
        //if(_.Engine.Animations[akey])_.Log(akey + ":"+_.Engine.Animations[akey].Timeline)
        if (_.Engine.Animations.hasOwnProperty(akey) && _.Engine.Animations[akey].Timeline == this.Name) {
         _.Engine.Animations[akey].Stop();
         cnt++;
        }
    }
    if(cnt > 0)this.State = "Stop";
}

   //#Add animations if provided during initialization
   if(arguments.length > 0){
       for(var ar=0;ar<arguments.length;ar++){
           this.AddAnimation(arguments[ar]);
       }
   }
  },

  //#AIM PRINTER #PRINTER #PrintPDF - the aim pdf printer object
  Printer:{
      //Hold all the Printer Object Animations
      Animations:[],
      //Hold all the Printer Timeline
      Timelines:[],
      //Printer #Status #State
      State:"Finish",
      //the current loading parameters
      Settings:{
          Default:{ //fixed settings, will be use to reset
            PaperType:"A4",
            Orientation:"P",//P-Portrait, L-Landscape
            FontSize:10,
            MarginLeft:4,
            MarginRight:4,
            MarginTop:4,
            MarginBottom:4,
            Src:"", //must be relative to the calling page (script loading aim)
            Title:"Untitled Document",
            WaterMark:"",
            Data:""
          },
          Process:{} //will contain the current settings
      },
      //Refresh Timmer
      RefreshTimmer:null,
    //#Refresh Printer
    Refresh:function(delay){
        //if no delay sent set delay to false
        delay = delay || false;
        //clear the timmer
        if(_.Engine.Printer.RefreshTimmer != null)clearTimeout(_.Engine.Printer.RefreshTimmer);
        if(delay){ //if delay required
            //run refresh after 300 miliseconds
            _.Engine.Printer.RefreshTimmer = setTimeout("_.Engine.Printer.Refresh()",300); 
            return;
        }
        _.Engine.Printer.Timelines['aim-printpdf-loading-timeline'].Stop();
      _.Engine.Printer.Timelines['aim-printpdf-loading-timeline'].Play('aim-printpdf-loading:0.2=>aim-printpdf-loading1:0.3=>aim-printpdf-loading2:0.3=>aim-printpdf-loading3');
      _("aim-printpdf-footer-status").Text = "Generating View ...";
       //convert settings to json
       var nset = JSON.stringify(_.Engine.Printer.Settings.Process);
       //aim-printer-generate
       _('aim-printpdf-iframe').src = _.Engine.Dom.Loader.Dir+"aim.php?aim-printer-generate=1&aim-version="+_.Version+"&aim-printer-settings="+escape(nset)+"&aim-dir="+_.Engine.Dom.Loader.Dir+"&aim-root="+_.Engine.Dom.Loader.Root;
      _.Engine.Printer.State = "Refresh";
    },
    //#load the printer
    Load:function(settings){
          settings = settings || {};
          //set the process settings (parameters), use the default attribute if not set
           for (var key in _.Engine.Printer.Settings.Default) {
               if (_.Engine.Printer.Settings.Default.hasOwnProperty(key)) {
                  var setval = typeof settings[key] != _.UND?settings[key]:_.Engine.Printer.Settings.Default[key];
                _.Engine.Printer.Settings.Process[key] = setval;

                //recalculate display objects state in sidebar
                //*********************************** */
                var uval = _.Engine.Printer.Settings.Process[key];
                
                if(key == "PaperType"){//Paper Type
                    _('aim-printpdf-papertype').Value = uval;
                }else if(key == "Orientation"){//Paper Orientation
                  //get the other button by ID
                  var pobj = _('aim-printpdf-portrait'),
                      lobj = _('aim-printpdf-landscape');
                    var objs = uval.toLowerCase() == 'p'?[pobj,lobj]:[lobj,pobj];
                    
                    if(objs[0].className.Contains(" w3-opacity")){
                        objs[0].className = objs[0].className.replace(" w3-opacity w3-card-4 w3-hover-greyscale","");
                        objs[1].className = objs[1].className + " w3-opacity w3-card-4 w3-hover-greyscale";
                    }
                }else if(key == "FontSize"){//font size
                    uval = _.ToInteger(uval);
                    uval = uval < 5 ? 5: uval > 42 ? 42: uval;
                    var lf = Math.floor(((uval-5) * 210)/37);
                    _('aim-printpdf-fontslider').style.left = lf+"px";
                    _('aim-printpdf-fontsize').Text = uval;
                }else if(key == "MarginLeft"){ //Margin Left
                    uval = _.ToInteger(uval);
                    uval = uval < 4 ? 4: uval > 40 ? 40: uval;
                    var lf = Math.floor((50*(uval - 4))/36) + 30;
                    _('aim-printpdf-marginline-left').style.left = lf + "px";
                    _('aim-printpdf-marginvalue-left').Text = uval;
                }else if(key == "MarginTop"){ //Margin Top
                    uval = _.ToInteger(uval);
                    uval = uval < 4 ? 4: uval > 40 ? 40: uval;
                    var tp = Math.floor((50*(uval - 4))/36) + 30;
                    _('aim-printpdf-marginline-top').style.top = tp + "px";
                    _('aim-printpdf-marginvalue-top').Text = uval;
                }else if(key == "MarginRight"){ //Margin Right
                    uval = _.ToInteger(uval);
                    uval = uval < 4 ? 4: uval > 40 ? 40: uval;
                    var lf = 220 - Math.floor((50*(uval - 4))/36);
                    _('aim-printpdf-marginline-right').style.left = lf + "px";
                    _('aim-printpdf-marginvalue-right').Text = uval;
                }else if(key == "MarginBottom"){ //Margin Bottom
                    uval = _.ToInteger(uval);
                    uval = uval < 4 ? 4: uval > 40 ? 40: uval;
                    var tp = 220 - Math.floor((50*(uval - 4))/36);
                    _('aim-printpdf-marginline-bottom').style.top = tp + "px";
                    _('aim-printpdf-marginvalue-bottom').Text = uval;
                }
                //recalculate display objects state in sidebar Ends
                //*********************************** */
               }
           }
         //convert settings to json
         var nset = JSON.stringify(_.Engine.Printer.Settings.Process);
        _('aim-printpdf').ZoomIn();
        _.Engine.Printer.Timelines['aim-printpdf-loading-timeline'].Play('aim-printpdf-loading:0.2=>aim-printpdf-loading1:0.3=>aim-printpdf-loading2:0.3=>aim-printpdf-loading3');
        _("aim-printpdf-footer-status").Text = "Generating View ...";
        //aim-printer-generate
        _('aim-printpdf-iframe').src = _.Engine.Dom.Loader.Dir+"aim.php?aim-printer-generate=1&aim-version="+_.Version+"&aim-printer-settings="+escape(nset)+"&aim-dir="+_.Engine.Dom.Loader.Dir+"&aim-root="+_.Engine.Dom.Loader.Root;
       // _('aim-printpdf-iframe').src = "http://live/epdevelop/portal/Admin/Slip.php?dl=0&paper=A4&orientation=P&fontsize=10&ML=4&MT=4&MR=4&MB=14&fn=Entrance_EP/TEST/078.pdf&folder=PUTME&RegNo=EP/TEST/078&RegID=1&paper=A4&orientation=P&MT=4&MB=14";
        _.Engine.Printer.State = "Load";
        
    },

    //#download the generated pdf file
    Download:function(){
        //convert settings to json
        var nset = JSON.stringify(_.Engine.Printer.Settings.Process);
       // alert(nset);
       // _.Engine.Printer.Timelines['aim-printpdf-loading-timeline'].Play('aim-printpdf-loading:0.2=>aim-printpdf-loading1:0.3=>aim-printpdf-loading2:0.3=>aim-printpdf-loading3');
       // _("aim-printpdf-footer-status").Text = "Preparing Download ...";
      //aim-printer-generate
      _('aim-printpdf-iframedl').src = _.Engine.Dom.Loader.Dir+"aim.php?aim-printer-generate=1&aim-version="+_.Version+"&aim-printer-download=1&aim-printer-settings="+escape(nset)+"&aim-dir="+_.Engine.Dom.Loader.Dir+"&aim-root="+_.Engine.Dom.Loader.Root;
      //_.Engine.Printer.State = "Download";
    },

    //When view loaded completed
    //Called by the iframe onload event handler
    Finish:function(download){
        download = download || false;
        //Stop the loading animation
        _.Engine.Printer.Timelines['aim-printpdf-loading-timeline'].Stop();
        _("aim-printpdf-footer-status").Text = _.Engine.Printer.Settings.Process["Title"];
        //set printer status
        _.Engine.Printer.State = "Finish";

        if(!download){
        //set status infos
        _('aim-footer-papertype').Text = _.Engine.Printer.Settings.Process["PaperType"];
        _('aim-footer-orientation').Text = _.Engine.Printer.Settings.Process["Orientation"] == "L"?"Landscape":"Portrait";
        _('aim-footer-fontsize').Text = _.Engine.Printer.Settings.Process["FontSize"];
        _('aim-footer-margintop').Text = _.Engine.Printer.Settings.Process["MarginTop"];
        _('aim-footer-marginright').Text = _.Engine.Printer.Settings.Process["MarginRight"];
        _('aim-footer-marginleft').Text = _.Engine.Printer.Settings.Process["MarginLeft"];
        _('aim-footer-marginbottom').Text = _.Engine.Printer.Settings.Process["MarginBottom"];
        _('aim-printer-version').Text = "Aim V"+_.Version+" PrintPDF "
        }
    },
    
    //close the printer
    Close:function(){
        _.Engine.Printer.Timelines['aim-printpdf-loading-timeline'].Stop();
        _('aim-printpdf').ZoomOut();
    },
    //Array holding the loading animations
    LoadingTM:null,
   //Initialize the printer object
   //NB:must be registered in the Aim InitManager
   Init:function(){
   
       //get the markup, append to the body the perform initization
       //opertation should be done only once
       //aim-printerpdf object is use to determine if all markup has been loaded
       if(!_.IsFound(_('aim-printpdf'))){ //if not already added
          //get from aim server
          _.Post({
              Action:_.Engine.Dom.Loader.Dir+"aim.php",
              Data:{"aim-markup":1,"aim-root":_.Engine.Dom.Loader.Root},
              OnComplete:function(res,url,param){
                // alert(res)
                 // return;
                 var printmarkup = "";
                  res = _.Engine.Server(res); //proccess server responce
                  if(res.HasError){ //if error found
                    _.Log(res.Error.Code + " - " + res.Error.Line + " " + res.Error.Message);
                   // alert(JSON.stringify(res.Error))
                   if(res.Error.Abort){
                      document.body.className += " aim-error"; 
                       return;
                   }
                  }else{
                      printmarkup = res.Markup;
                  }
                  
                  
                if(_.Trim(printmarkup) != ""){ //if markup gotten
                  //append it to the documment element
                  
                  document.body.insertAdjacentHTML('afterbegin',printmarkup);
                  //pefrom initialize the printer elements

        //Aim Printer (#PrintPDF) Element Initialization
        //************************************** */
       //Loadining Animation 
       
        for(var aa=1 ; aa < 4; aa++){
         _.Engine.Printer.Animations['aim-printpdf-loading'+aa] = new _.Animation({
             Name:'aim-printpdf-loading'+aa,
             Target:'aim-printpdf-loading'+aa,
             Effect:{0:"top:0;opacity:0.5",1:"top:40px;opacity:1"},
             Duration:0.5,
             Direction:"to-fro",
             Infinite:true
         });
        }
         _.Engine.Printer.Animations['aim-printpdf-loading'] = new _.Animation({
            Name:'aim-printpdf-loading',
            Target:'aim-printpdf-loading',
            Effect:'FadeIn',
            Duration:0.5
        });
       _.Engine.Printer.Timelines['aim-printpdf-loading-timeline'] = new _.Timeline('aim-printpdf-loading','aim-printpdf-loading1','aim-printpdf-loading2','aim-printpdf-loading3');

        _('aim-printpdf-portrait + aim-printpdf-landscape').Assign('click',function(e){
            e.stopPropagation();
            //get the object(button) clicked
            var obj = e.currentTarget;
            //get the other button by ID
            var obj2 = obj.ID == 'aim-printpdf-portrait'?'aim-printpdf-landscape':'aim-printpdf-portrait';
            obj2 = _(obj2);
            if(obj.className.Contains(" w3-opacity")){
                obj.className = obj.className.replace(" w3-opacity w3-card-4 w3-hover-greyscale","");
                obj2.className = obj2.className + " w3-opacity w3-card-4 w3-hover-greyscale";
                //Reset the Orientation and refresh printer
                _.Engine.Printer.Settings.Process['Orientation'] = obj.ID == 'aim-printpdf-portrait'?'P':'L';
                
                //#Refresh Printer
                _.Engine.Printer.Refresh(true);
            }
        });

        //The Display and Download #iframe #onload eventhandler
        _('aim-printpdf-iframe').Assign("load",function(e){
            e.stopPropagation();
            _.Engine.Printer.Finish();
        });

        //the #PrintPDF #fontsize slider drag operation (setting font size)
        _('aim-printpdf-fontslider').Draggable({
            Direction:"X", //move in X axis only
            Restricted:true, //confined drag movement withen its container only
            OnDrag:function(e){//calculate the font size as user drags the slider (minimum value = 5, maximum value = 40)
            //NB: the max drag left value of slider is 210
            _('aim-printpdf-fontsize').Text = Math.floor((e.Left / 210) * 37) + 5;},
            OnFinish:function(){ //perform the printer refresh after fontsize set (drag ends)
                //reset the Font size and refresh printer
                _.Engine.Printer.Settings.Process['FontSize'] = _.ToInteger(_('aim-printpdf-fontsize').Text)
                //#Refresh Printer
                _.Engine.Printer.Refresh(true);
            }
        });

        //the #PrintPDF #margintop line drag operation (setting margin top)
        _('aim-printpdf-marginline-top').Draggable({
          Direction:"Y", //Move in Y axis only
          MaximumY:80, //the maximum Y axis (top value) to reach
          MinimumY:30, //the minimum Y axis (top value) to reach
          OnDrag:function(e){ //calculate the margin top and display it as user drags the line
             //the move area (length) 80 - 30 = 50
             //Minimum margin top = 4
             //Maximum margin top = 40
              _('aim-printpdf-marginvalue-top').Text = Math.floor(((e.Top - 30)/50) * 36) + 4
          },
          OnFinish:function(){ //perform the printer refresh after margin top set (drag ends)
            //reset the Margin Top and refresh printer
            _.Engine.Printer.Settings.Process['MarginTop'] = _.ToInteger(_('aim-printpdf-marginvalue-top').Text)
              //#Refresh Printer
              _.Engine.Printer.Refresh(true);
          }
        });

        //the #PrintPDF #marginleft line drag operation (setting margin left)
        _('aim-printpdf-marginline-left').Draggable({
            Direction:"X", //Move in X axis only
            MaximumX:80, //the maximum X axis (left value) to reach
            MinimumX:30, //the minimum X axis (left value) to reach
            OnDrag:function(e){//calculate the margin left and display it as user drags the line
             //the move area (length) 80 - 30 = 50
             //Minimum margin left = 4
             //Maximum margin left = 40
                _('aim-printpdf-marginvalue-left').Text = Math.floor(((e.Left - 30)/50) * 36) + 4
            },
            OnFinish:function(){//perform the printer refresh after margin left set (drag ends)
                //reset the Margin Left and refresh printer
            _.Engine.Printer.Settings.Process['MarginLeft'] = _.ToInteger(_('aim-printpdf-marginvalue-left').Text)
                //#Refresh Printer
                _.Engine.Printer.Refresh(true);
            }
          });

          //the #PrintPDF #marginright line drag operation (setting margin right)
          _('aim-printpdf-marginline-right').Draggable({
            Direction:"X",//Move in X axis only
            MaximumX:250 - 30,//the maximum X axis (left value) to reach (the total container width - the initial gap to the right)
            MinimumX:250 - 30 - 50, //the minimum X axis (left value) to reach (the total container width - the initial gap to the right - the total move value(50))
            OnDrag:function(e){//calculate the margin right and display it as user drags the line
                //the move area (length) = 50
             //Minimum margin right = 4
             //Maximum margin right = 40
             //the maximum X cordinate = 250 - 30 = 220
               _('aim-printpdf-marginvalue-right').Text = Math.floor(((220-e.Left)/50) * 36) + 4
            },
            OnFinish:function(){//perform the printer refresh after margin right set (drag ends)
                //reset the Margin Right and refresh printer
            _.Engine.Printer.Settings.Process['MarginRight'] = _.ToInteger(_('aim-printpdf-marginvalue-right').Text)
                //#Refresh Printer
                _.Engine.Printer.Refresh(true);
            }
          });

          //the #PrintPDF #marginbottom line drag operation (setting margin bottom)
          _('aim-printpdf-marginline-bottom').Draggable({
            Direction:"Y",//Move in Y axis only
            MaximumY:250 - 30,//the maximum Y axis (top value) to reach (the total container height - the initial gap to the top)
            MinimumY:250 - 30 - 50,//the minimum Y axis (top value) to reach (the total container height - the initial gap to the top - the total move value(50))
            OnDrag:function(e){//calculate the margin bottom and display it as user drags the line
                //the move area (length) = 50
             //Minimum margin bottom = 4
             //Maximum margin bottom = 40
             //the maximum Y cordinate = 250 - 30 = 220
               _('aim-printpdf-marginvalue-bottom').Text = Math.floor(((220-e.Top)/50) * 36) + 4
            },
            OnFinish:function(){//perform the printer refresh after margin bottom set (drag ends)
                //reset the Margin Bottom and refresh printer
            _.Engine.Printer.Settings.Process['MarginBottom'] = _.ToInteger(_('aim-printpdf-marginvalue-bottom').Text)
                //#Refresh Printer
                _.Engine.Printer.Refresh(true);
            }
          });

          //The onchange event handler of the paper type dropdown (select)
          _('aim-printpdf-papertype').Assign("change",
        function(e){
            e.stopPropagation();
            //reset the papertype and refresh
            _.Engine.Printer.Settings.Process['PaperType'] = e.currentTarget.Text;
            //#Refresh Printer
            _.Engine.Printer.Refresh(true);
        });

          //create the slide-in/out animation of the #PrintPdf sidebar #aimPrintPdfSidebarAnim
          _.Engine.Printer.Animations['aim-printpdf-sidebar'] = new _.Animation({Target:'aim-printpdf-sidebar', //the id of the sidebar
          Effect:'LeftIn', //move from left effect
           Name:"aim-printpdf-sidebar-anim", //the animation name (to be use in timeline to identify animation)
           Duration:0.5 //the animation duration
        });

        //create the slide-in/out animation of the #PrintPdf small sidebar (for small screen) #aimPrintPdfSmallMenuAnim
        _.Engine.Printer.Animations['aim-printpdf-small-menu']  = new _.Animation({Target:'aim-printpdf-small-menu',
          Effect:'LeftIn',
          Name:"aim-printpdf-small-menu-anim",
          Duration:0.5});

          //create the #PrintPdf Timeline that controls the two animation #printPdfTM
          _.Engine.Printer.Timelines['aim-printpdf-sidebar-timeline'] = new _.Timeline('aim-printpdf-sidebar','aim-printpdf-small-menu');
          
          //Assign function to the onclick event of the button(in the small sidebar) to show the main sidebar
          //the function animates out the small sidebar and animate in the main sidebar using the Timeline #printPdfTM
          _('aim-printpdf-show-sidebar').Assign('click',function(){
            //e.stopPropagation();
              var sidebarAnim = _.Engine.Printer.Animations['aim-printpdf-sidebar'], smallSidebarAnim = _.Engine.Printer.Animations['aim-printpdf-small-menu'];
            sidebarAnim.Direction="to"; //set the main sidebar animation direction to forward (move in)
            smallSidebarAnim.Direction = "fro";//set the small sidebar animation direction to reverse (move out)
            sidebarAnim.OnEnd = function(){
                _('aim-printpdf-sidebar').Style = "left:0px;opacity:1"  
            }; //reset the left and opacity of the main sidebar
            //set the OnStart to remove the w3 hide class on it so that it will be visible when animated In
            sidebarAnim.OnStart = function(){
                var cn =  _('aim-printpdf-sidebar'); //get the sidebar using aim finder
                //clear the w3 hide clases
                cn.className = cn.className.replace(" w3-hide-medium w3-hide-small", "");}
            //play the Timeline, configured to play the small sidebar animation (Out) first and then at 0.3(30%), play the main sidebar animation (In)
            _.Engine.Printer.Timelines['aim-printpdf-sidebar-timeline'].Play("aim-printpdf-small-menu-anim:0.3=>aim-printpdf-sidebar-anim");
          });

          //Assign function to the onclick event of the button(in the main sidebar) to show the small sidebar - display only in small and medium screen (using w3css)
          //the function animates out the main sidebar and animate in the small sidebar using the Timeline #printPdfTM
          _('aim-printpdf-show-small-menu').Assign('click',function(){
           // e.stopPropagation();
            var sidebarAnim = _.Engine.Printer.Animations['aim-printpdf-sidebar'], smallSidebarAnim = _.Engine.Printer.Animations['aim-printpdf-small-menu'];

            sidebarAnim.Direction="fro";//set the main sidebar animation direction to reverse (move out)
            smallSidebarAnim.Direction = "to";//set the small sidebar animation direction to forward (move in)
            sidebarAnim.OnStart = function(){};//clear the OnStart Operation of the main sidebar (incase it is set from its previous animation)

             //set the OnEnd to add the w3 hide class on it and reset the effect of the animation (left and opacity) so that it will be hidden on small and medium screen but visible on large screen
            sidebarAnim.OnEnd = function(){
                var cn =  _('aim-printpdf-sidebar'); //get the sidebar using Aim finder
                //add the w3css hide classes so as to return back the w3css hide effect on small and medium screen
                cn.className = cn.className + " w3-hide-medium w3-hide-small";
                //reset the effect of the animation, so as to make it visible on large screen
                cn.Style = "left:0px;opacity:1";
            }
            //play the Timeline, configured to play the main sidebar animation (Out) first and then at 0.3(30%), play the small sidebar animation (In)
            _.Engine.Printer.Timelines['aim-printpdf-sidebar-timeline'].Play("aim-printpdf-sidebar-anim:0.3=>aim-printpdf-small-menu-anim");
          });
      _('aim-printer-open').Assign('click',function(e){
       // e.stopPropagation();
            _.Engine.Printer.Load({PaperType:"Letter",Orientation:"L",FontSize:35,MarginTop:21,MarginBottom:12,MarginLeft:32,MarginRight:10,Src:"",Title:"Testing Aim Printer"});
        })
          _('aim-printer-close').Assign('click',function(e){
           // e.stopPropagation();
              _.Engine.Printer.Close();
             // _('aim-printpdf').ZoomOut();
          });

          //the download buttons
          _('aim-printer-download-btn').Assign('click',function(e){
           // e.stopPropagation();
              _.Engine.Printer.Download();
          });

          //Initialize the popup-close-button (aim-alert-close)
          //get the popup object
          var pobj = _('aim-alert-ind');
          if(_.IsFound(pobj)){
            pobj = _.IsArray(pobj)?pobj:[pobj];
            pobj.Each(function(ipobj){
                ipobj = ipobj.nextElementSibling;
                _.Engine.Proccessor.Init(ipobj);
            });
            
             // pobj = _.IsArray(pobj)?pobj[0]:pobj;
              //get the close button
             /* var clbtn = pobj._('aim-alert-close');
              if(_.IsFound(clbtn)){
                
                clbtn = _.IsArray(clbtn)?clbtn:[clbtn];
                clbtn.Each(function(cbtn){
                    
                    cbtn.Assign(function(e){
                        _.Log("Alert Button Clicked "+ e.currentTarget.className);
                        _('aim-popup-ind').nextElementSibling.Hide();
                    });
                })
              }*/
          }

          
        //***************************************** */
                }
                //printer initialization complete
                _.Engine.InitManager.Complete("Printer");
              },
              OnError:function(){
                  _.Log("Printer Markup loading Failed");
                  //printer initialization complete
                _.Engine.InitManager.Complete("Printer");
              }
          });//Ajax post ends
         //if not alraedy added if block end 
       }else{
        _.Engine.InitManager.Complete("Printer");
       }
       
   }//Initialize the printer object Ends
   
  },

  //Aim #InitManager - #Initialization Manager - manage and take track of all individual initialization aim must do.
  InitManager:{
    //the initialization module names
    Modules:{'length':0},
    //count total number of completed initialization modules
    CompleteCount:0,
    //Manage individual module complete operattion
    //NB:Must be called at the end of every module(script) complete
    Complete:function(moduleName){
        //_.Log(moduleName + " Complete");
      if(typeof _.Engine.InitManager.Modules[moduleName] != _.UND){
        _.Engine.InitManager.CompleteCount++;
        
        //check if all initialization module completed
        if(_.Engine.InitManager.CompleteCount >= _.Engine.InitManager.Modules['length']){
            
            //remove the aim loading cover page
             //if all data loaded succesfully
           //Close the loader
           _.Engine.Dom.Loader.Close();
        }
      }
    },
    //#Add/#Register a module to the init manager
    //NB:module must be a function
    Register:function(name,modules){
      _.Engine.InitManager.Modules[name] = modules;
      _.Engine.InitManager.Modules['length']++;
     // _.Log(_.Engine.InitManager.Modules['length']);
    },
    //#Start all initialization
    Start:function(){
        for (var key in _.Engine.InitManager.Modules) {
            if (_.Engine.InitManager.Modules.hasOwnProperty(key) && key != 'length') {
                var initfunc = _.Engine.InitManager.Modules[key];
                if(_.IsFunction(initfunc)){
                    //in the function script _.Engine.InitManager.Complete(nameoffunc) must be called at the end of script
                    
                    initfunc();
                }
            }
        }
    }

  },

  //********************************************** */
  //The Aim #Processor Engine
  Proccessor:{
      //proccessor internal memory
      Memory:{},
      //Get the placeholders in a markup
      Placeholder:function(markup,open,close,sep){
          open = open || "{{";
          close = close || "}}";
          sep = sep || "|";
        var tempdatas = [];
        //loop through all the innerhtml to get the placeholders
        var innerM = _.IsString(markup)?markup:markup.outerHTML;
        
        var openlen = open.length;
        var closelen = close.length; 
        var cpos = -openlen;
        while (cpos < innerM.length){
            cpos = innerM.indexOf(open,cpos+openlen);
            if(cpos > -1){ //if found
              //get the position of the clossing tag
              var lpos = innerM.indexOf(close,cpos+openlen);
              if(lpos > -1){
                   var dd = innerM.substr(cpos+openlen,lpos - cpos - openlen);
                   var ddarr = dd.split(sep);
                   var placeh = ddarr[0];
                   var placehTitle = typeof ddarr[1] != _.UND?ddarr[1]:null;
                   var datatype = typeof ddarr[2] != _.UND?ddarr[2]:null;
                   tempdatas.push({Placeholder:placeh,Title:placehTitle,Datatype:datatype});
                   cpos = lpos + closelen;
              }
            }else{
                cpos = innerM.length
            }
        }
        return tempdatas;
      },
      //Fill markup
      Fill:function(markup,datarw){
        //get all the placeholder
        var oph = _.Engine.Proccessor.Placeholder(markup);
        //loop thru all opentaghtml placeholder and replace with value
        for(var op=0; op<oph.length; op++){
            markup = markup.Replace("{{"+oph[op].Placeholder+"}}",datarw[oph[op].Placeholder]);
        }
        return markup;
      },
      //Aim method to initialize aim object in realtime
      InitLive:function(limit,look){
          var proc = _.Engine.Proccessor
         limit = limit || "";
         var objreg = [];
         period = " .";
         //loop through all aim object
         for (var modulename in proc.Modules) {
            if (proc.Modules.hasOwnProperty(modulename)) {
                var selector = limit+" ."+modulename;
               //get the elemnts
               //Proccess intialization inside tab objects
               if(look == "tab"){ //if the container to initialize content is a tab
                  if(modulename == "aim-tab"){ //if the current module name is tab
                    //initialize the tab container itself and every other tab-container inside of it
                    selector = limit+"."+modulename+ " + "+limit+" .aim-tab";
                  }else{ //perform init on aim object in the tab head and body
                     //get the tab object
                     var tabObj = _(limit);
                     var getheadbody = function(inelem,cls){ //get the aim-tab-head object
                        var headId = _.Attribute(inelem,cls);
                        var tabhead = (headId == null || headId.Trim() == "")?"#"+inelem.ID + " ."+cls:"#"+headId;
                        return tabhead;
                       // return _.IsFound(tabhead)?_.IsArray(tabhead)?tabhead[0]:tabhead:inelem;
                       }
                       var ahead = getheadbody(tabObj,'aim-tab-head');
                       var abody = getheadbody(tabObj,'aim-tab-body');
                       selector = ahead + " ."+modulename+" + "+abody+ " ."+modulename;
                     //get the head element


                  }
               }else if(look == "wizardPage"){
                   if(modulename == "aim-wizard"){
                       selector = selector+ " + "+limit+" .aim-wizard-goto";
                   }
               }
                //period = modulename == "aim-tab" && look == "tab"?".":" .";
               
               var elems = _(selector);
              
               
               if(_.IsFound(elems)){
               // _.Log(selector);
               // 
               // _.Log(limit + "."+modulename);
                   elems = _.IsArray(elems)?elems:[elems];

                   for(var ss=0;ss<elems.length;ss++){
                      
                    objreg.push({ModuleName:modulename,Elemt:elems[ss]})
                    proc.Register(elems[ss],modulename);
                    //proc.Modules[modulename].Init(elems[ss]); //initialize
                    
                   }
               }
            }
        }
        if(objreg.length == 0)return;
        for(var k=0 ; k < objreg.length; k++){
            var oid=objreg[k];
            //get all object that requires initialization
            if (typeof proc.Modules[oid.ModuleName] != _.UND)proc.Modules[oid.ModuleName].Init(oid.Elemt); //perform initialization of all registered object
           }

      }, 
      //Aim method to initialize aim object in realtime
      InitNow:function(container,baseModule){
          var proc = _.Engine.Proccessor
          if(typeof container == _.UND)return; //if no container send for object initialization
          baseModule = baseModule || ""; //represent the base modulename of the object (for object that are sub of the base object)
          //NB: for object that container does not need to be initialized (dont set the baseModule parameter or set it to empty string)
        var objreg = [];
         // _.Log("Start Live Init: "+container.ID+" | "+baseModule);
          //_.Log("*************************************");
          //loop through all aim object(Module) names
         for (var modulename in proc.Modules) {
            if (proc.Modules.hasOwnProperty(modulename)) {
                var selector = ""; //the objects finder selector
                
                //special consideration for aim-tab object
                if(container.InClass("aim-tab")){
                    if(modulename == "aim-tab"){
                        selector += "#"+container.ID+"." + modulename + " + ";
                    }
                    var getheadbody = function(inelem,cls){ //get the aim-tab-head object
                        var headId = _.Engine.Proccessor.GetAttr(_.Attribute(inelem,cls));
                        var tabhead = (headId == null || headId.Trim() == "")?"#"+inelem.ID + " ."+cls:"#"+headId;
                        return tabhead;
                       // return _.IsFound(tabhead)?_.IsArray(tabhead)?tabhead[0]:tabhead:inelem;
                       }
                    var ahead = getheadbody(container,'aim-tab-head');
                    var abody = getheadbody(container,'aim-tab-body');
                    selector += ahead + " ."+modulename+" + "+abody+ " ."+modulename + " + ";
                }
                //if base modulename set i.e the object is a sub of the basename
                //register it with the basename
                if(baseModule == modulename && !container.InClass(modulename)){
                   selector += "#"+container.ID + " + "
                }
                //get the objects that exist inside the container fro initialization
                selector +=  "#"+container.ID + " ."+modulename;
                //_.Log("Selector Formed: "+selector);
               //get the init elements
               var elems = _(selector);

               if(_.IsFound(elems)){
               
                   elems = _.IsArray(elems)?elems:[elems];

                   for(var ss=0;ss<elems.length;ss++){
                      
                    objreg.push({ModuleName:modulename,Elemt:elems[ss]})
                    proc.Register(elems[ss],modulename);
                    //proc.Modules[modulename].Init(elems[ss]); //initialize
                    
                   }
               }
            }
        }
        if(objreg.length == 0)return;
        for(var k=0 ; k < objreg.length; k++){
            var oid=objreg[k];
            //get all object that requires initialization
            if (typeof proc.Modules[oid.ModuleName] != _.UND)proc.Modules[oid.ModuleName].Init(oid.Elemt); //perform initialization of all registered object
           }

      },
      //Proccess aim attributes
      GetAttr:function(attname){
          
       if(attname == null || attname == "")return "";
       if(!_.IsString(attname))return attname;
       attname = attname.Trim();
       
       //if the first character is {{ and last is }} i.e if data attribute
       if(attname.substr(0,2) == "{{" && attname.substr(attname.length-2) == "}}"){
           
          //get the placeholder name 
          var pn = attname.substr(2,attname.length-4);
          //get element
          var elem = _(pn); //get the element
          if(_.IsFound(elem)){
              var nval = elem.Value; //get the value
              //if radio button or checkbox will return null if not selected
              nval = _.IsArray(nval)?nval.Exact(true).join(","):nval;
              //if multiple element found remove those with null value and convert to comma seperated string
              return nval; 
          }else{
              return attname;
          }
       }else{
           return attname;
       }
      },
      //Aim approved #proccessor #modules
      Modules:{
         //The aim #printer #load object
         "aim-printer":{
             Param:{

             },
             Init:function(elem){
                /*var cbtnInit = _.Attribute(elem,'aim-object-init') || false;
                if(cbtnInit !== false){ //if already initialized
                  
                }else{//not initialized
                    if(_.IsElement(elem)){ //if a valid element
                    elem.Assign('click',function(e){
                        e.stopPropagation();
                        _.Engine.Proccessor.Modules['aim-printer'].Run(e.currentTarget) 
                    });
                    _.Attribute(elem,'aim-object-init','true'); //set initialization flag
                    }
                }*/
                _.Engine.Proccessor.Finish();
            },
            Run:function(ielem){
                var iproc = _.Engine.Proccessor;
                var dset = _.Engine.Printer.Settings.Default;
                var paramobj = {};
                //get all aim attributes
                paramobj.Src = iproc.GetAttr(_.Attribute(ielem,"aim-printer-src") || dset.Src);
                paramobj.PaperType = iproc.GetAttr(_.Attribute(ielem,"aim-printer-paper") || dset.PaperType);
                paramobj.FontSize = _.ToInteger(iproc.GetAttr(_.Attribute(ielem,"aim-printer-fontsize") || dset.FontSize));
                paramobj.Orientation = iproc.GetAttr(_.Attribute(ielem,"aim-printer-orientation") || dset.Orientation);
                paramobj.MarginLeft = _.ToInteger(iproc.GetAttr(_.Attribute(ielem,"aim-printer-left") || dset.MarginLeft));
                paramobj.MarginRight = _.ToInteger(iproc.GetAttr(_.Attribute(ielem,"aim-printer-right") || dset.MarginRight));
                paramobj.MarginTop = _.ToInteger(iproc.GetAttr(_.Attribute(ielem,"aim-printer-top") || dset.MarginTop));
                paramobj.MarginBottom = _.ToInteger(iproc.GetAttr(_.Attribute(ielem,"aim-printer-bottom") || dset.MarginBottom));
                paramobj.Title = iproc.GetAttr(_.Attribute(ielem,"aim-printer-title") || dset.Title);
                paramobj.WaterMark = iproc.GetAttr(_.Attribute(ielem,"aim-printer-watermark") || "");
                paramobj.Data = iproc.Modules['aim-datafill'].Param.GetData(_.Attribute(ielem,"aim-printer-data") || "",ielem.ID);
                _.Engine.Printer.Load(paramobj);
            }
         },
         //Aim #datafill module #aim-datafill
         'aim-datafill':{
             //use to keep data relating to aim-datafill objects
             Param:{
                 GetData:function(postData,elemID){
                    var proData = {};
                    var proDataLastElem = {};
                    var Param = _.Engine.Proccessor.Modules['aim-datafill'].Param;
                    var silent = typeof Param[elemID] != _.UND && typeof Param[elemID].Silent != _.UND?Param[elemID].Silent:false;
                     //all file reference for ajax will be kept seperately in "aim-data-file" object and the Datafield name will be set normaly as the created file element id by aim Browse method
                     //Process the user data ********
               if(postData.Trim() != ""){
                //encrypt escape backslashes
               //postData = postData.Replace('\\','~!~@#%^&*');
               
               //encript escape commas
               postData = postData.Replace("\\,",'*&^%#@~!~');
               //_.Log(postData);
               //get individual userdata
               var inpostDatas = postData.split(",");
               //_.Log(inpostDatas.length)
               if(inpostDatas.length > 0){ //if userdatas found
                 var elcnt = 0;
                //loop through all set user data
                for(var sa=0;sa<inpostDatas.length; sa++){
                    var inpostData = inpostDatas[sa].Trim();
                    if(inpostData != ""){ //if post data exist
                       //decrypt the backslah
                       //inpostData = inpostData.Replace('~!~@#%^&*','\\\\')
                       //decrypt the comma
                       inpostData = inpostData.Replace('*&^%#@~!~',',');
                       //check if it is a selector
                       if(inpostData.substr(0,2) == "{{" && inpostData.substr(inpostData.length-2,2) == "}}"){
                           var userDataSelector = inpostData.substr(2,inpostData.length-4);
                           //Get the elements
                           var elemnts = _(userDataSelector);
                           if(_.IsFound(elemnts)){ //elements found
                             elemnts = _.IsArray(elemnts)?elemnts:[elemnts];
                             //loop through all the elements and get the Text or value
                             for(var ie=0;ie<elemnts.length;ie++){
                                 var curElem = elemnts[ie];
                                 if(!_.IsElement(curElem))continue;
                                 //_.Log(curElem.ID)
                                 var vali = !silent?curElem.Validate():true;
                                  //alert(silent.toString());
                                 if(vali !== true){ //if invalid data supplied
                                     _.Alert(vali);
                                     //alert('error');
                                     curElem.classList.add('error-input');
                                     curElem.focus();
                                     /*var newone = curElem.Cloner();
                                     curElem.parentNode.replaceChild(newone, curElem);*/
                                     curElem.ReplaceWith(curElem.Cloner(true));
                                     //enable other input already disabled
                                     if(typeof elemID != _UND){
                                        if(typeof _.Engine.Proccessor.Memory['aim-datafield-element-'+elemID]  != _.UND){
                                            _.Engine.Proccessor.Memory['aim-datafield-element-'+elemID].Each(function(elemen){
                                                elemen.disabled = false;
                                            })
                                        }
                                     }
                                     
                                     curElem.focus();
                                     return false;
                                 }

                                  //get the key (aim-datafield || ID || counter);
                                  var edatafield = _.Attribute(curElem,"aim-datafield") || "";
                                  edatafield = edatafield.Trim() == ""?curElem.id:edatafield.Trim(); //if the datafield not set use the id
                                  
                                  //_.Log(edatafield)
                                  if(typeof edatafield == _.UND || edatafield.Trim() == ""){ //if id not set, use the counter
                                      edatafield = elcnt;
                                      elcnt++;
                                  }
                                  


                                 //check if a file picker, meaning value is a file
                                 if(curElem.InClass('aim-filepicker')){
                                     if(typeof proData["aim-data-file"] == _.UND)proData["aim-data-file"] = {};
                                     //proData = {"aim-data-file":{}};
                                     if(_.Attribute(curElem,"aim-filepicker-loaded") == "true"){
                                         //get the file element, which is the elementID_file
                                        var FileElem = _(curElem.ID + "_file");
                                        if(_.IsFound(FileElem)){//if the file element found
                                        //var edatafield = curElem.ID + "_file";
                                        var elemval = curElem.ID + "_file";
                                        proData["aim-data-file"][curElem.ID + "_file"] = "?"; //set the file for upload in the aim-data-file object
                                        proData[edatafield] = elemval; //set the datafield to the file upload id
                                        
                                        }
                                    continue;
                                    //continue with other field
                                    
                                 }
                                }
                                
                                //check if current element is aim-datagroup
                                if(curElem.InClass('aim-datagroup')){
                                   //get the target elements
                                   var gproData = Param.GetData(_.Attribute(curElem,"aim-datagroup-data") || "");
                                  // alert(JSON.stringify(proData));
                                   proData[edatafield] = gproData;
                                   //alert(JSON.stringify(proData));
                                   continue;
                                }
                               
                                    var valueType = _.Attribute(curElem,"aim-get-value") || "false";
                                    var elemval = valueType == "true"?curElem.Value:curElem.Text;
                                 //if the elemID is set, meaning the fields element are to be disabled and kept in the memory
                                 if(typeof elemID != _.UND && silent == false){
                                 //disable the curElem
                                 curElem.disabled = true;
                                 //add it to input field array in the engine memory, will be use in datafill Aim FinishWork user function to enable element when operation finishes
                                  if(typeof _.Engine.Proccessor.Memory['aim-datafield-element-'+elemID] == _.UND)_.Engine.Proccessor.Memory['aim-datafield-element-'+elemID] = [];
                                  _.Engine.Proccessor.Memory['aim-datafield-element-'+elemID].push(curElem);
                                 }
                                 
                                 //check if the data already exist
                                 if(typeof proData[edatafield] != _.UND){
                                    if(!_.IsArray(proData[edatafield]))proData[edatafield] = [proData[edatafield]];
                                    proData[edatafield].push(elemval);
                                 }else{
                                    //add the data to the Main data object
                                   proData[edatafield] = elemval; 
                                 }
                                 
                                 /*if(typeof proData[edatafield] == _.UND){
                                    proData[edatafield] = elemval; 
                                 }else{
                                     if(_.IsObject(proData[edatafield]) || _.IsArray(proData[edatafield])){
                                         if(typeof curElem.id != _.UND && curElem.id.Trim() != ""){
                                             if(proData[edatafield] == _.UND)proData[edatafield] = [];
                                             proData[edatafield][curElem.id] = elemval
                                         }else{
                                            proData[edatafield][proData[edatafield].length] = elemval;
                                         }
                                        
                                     }else{ //if only the first inserted
                                        //get the last element
                                        var cval = proData[edatafield];
                                        proData[edatafield] = {};
                                        var odkey = typeof proDataLastElem[edatafield].id != _.UND && proDataLastElem[edatafield].id.Trim() != "" ?proDataLastElem[edatafield].id : 0;
                                        proData[edatafield][odkey] =cval;
                                        var nkey = typeof curElem.id != _.UND && curElem.id.Trim() != ""?curElem.id:1;
                                        proData[edatafield][nkey] =elemval;
                                     }
                                 }*/
                                // proData[edatafield] = elemval; 
                                 //keep last element to make it available in next element proceesing
                                 //proDataLastElem[edatafield] =  curElem;
                                 //alert(silent.toString() + " - "+ curElem.tagName);
                             }
                             
                           }
                           
                        //check if json string sent
                        }else if(inpostData.substr(0,1) == "{" && inpostData.substr(inpostData.length-1,1) == "}"){
                            var tempdata =JSON.parse(inpostData);
                            if(tempdata){
                                proData = tempdata;
                            }
                       }else{ //assume it is a datastring
                         //break to DataArray
                         pstDataArray = inpostData.ToDataArray();
                         if(pstDataArray.length > 0){
                              //merge it with the main object
                             for (var key in pstDataArray) {
                                 if (pstDataArray.hasOwnProperty(key)) {
                                    proData[key] = pstDataArray[key];
                                     
                                 }
                             }
                         }
                        
                       }//data string processing ends
                       
                    }//post data exist end
                    //
                }//loop throuh all user data seperated with comma ends
               }//user data found end
            }//user data set end
            //alert(JSON.stringify(proData));
              return proData;
             }
            },
            //#aim-datafill init
             Init:function(ielem){
                 
                 var proc = _.Engine.Proccessor;
                 //Setup parameters
                 proc.Modules['aim-datafill'].Param[ielem.ID] = {
                    Template:[],
                    DataSet:proc.GetAttr(_.Attribute(ielem,"aim-dataset") || ""),
                    DataCond:proc.GetAttr(_.Attribute(ielem,"aim-condition") || ""),
                    RawSrc:_.Attribute(ielem,"aim-src") || "",
                    Src:proc.GetAttr(_.Attribute(ielem,"aim-src") || ""),
                    Refresh:_.ToInteger(proc.GetAttr(_.Attribute(ielem,"aim-refresh-rate") || 0)),
                    ElementID:ielem.ID,
                    RawContainer:_.Attribute(ielem,"aim-container") || ielem.ID,
                    Container:proc.GetAttr(_.Attribute(ielem,"aim-container") || ielem.ID),
                    Append:Boolean(proc.GetAttr(_.Attribute(ielem,"aim-datafill-append") || false)),
                    Silent:Boolean(proc.GetAttr(_.Attribute(ielem,"aim-datafill-silent") || false)),
                    WorkingClass:proc.GetAttr(_.Attribute(ielem,"aim-datafill-working-class") || ""),
                    DataName:[],
                    Complete:false,
                    Data:{}
                }
               // _.Log(JSON.stringify(proc.Modules['aim-datafill'].Param));
                //0.5 get the container
                var dataContainer = _(proc.Modules['aim-datafill'].Param[ielem.ID].Container);
                dataContainer = _.IsFound(dataContainer)?dataContainer:ielem;
                //We assume that all container should use same template, so we pick the first container only for proccessing
                //(NT: all containers must have the same template specify in them)
                //Will be done better in the next version
                dataContainer = _.IsArray(dataContainer)?dataContainer[0]:dataContainer;
            

                //1.lookup for aim-template inside the ielem
                var templs = dataContainer._('aim-template');
                if(_.IsFound(templs)){
                    //2. for each template that exist, replace data placeholder with the dataspace as required
                    templs = !_.IsArray(templs)?[templs]:templs;
                    for(var e=0;e<templs.length;e++){
                        var ctempl = templs[e];
                        //get the placeholders in markup
                      // var placeholders = proc.Placeholder(ctempl);
                        //get the outer html
                        var ohtml = ctempl.outerHTML;
                        var ihtml = ctempl.innerHTML;
                        var attrhtml = ohtml.substring(0,ohtml.indexOf(ihtml));
                        attrhtml = attrhtml.replace("aim-template","aim-template-load");
                        
                        //{Open:attrhtml,Body:ihtml,Close:"</"+ctempl.tagName+">"}

                        //insert the default in template
                        //get placeholders and the default values
                        var PlacHs = proc.Placeholder(ohtml);
                        //_.Log(JSON.stringify(PlacHs));
                        //{Placeholder:placeh,Title:placehTitle}
                        if(PlacHs.length > 0){
                            for(var d=0;d<PlacHs.length;d++){
                                var plobj = PlacHs[d];
                                var lookval = plobj.Title == null?plobj.Placeholder:plobj.Placeholder+"|"+plobj.Title;
                                lookval += plobj.Datatype == null?"":"|"+plobj.Datatype;
                               //check if editable
                               var fchar = lookval.substr(0,1);
                                attrhtml = attrhtml.replace("{{"+lookval+"}}","{{"+plobj.Placeholder+"}}");
                                ihtml = ihtml.replace("{{"+lookval+"}}","{{"+plobj.Placeholder+"}}");
                                //ihtml = ihtml.replace("{{"+lookval+"}}",'<span class="aim-dataspace" aim-dataname="'+plobj.Placeholder+'">'+"{{"+plobj.Placeholder+"}}"+'</span>');
                                //add the placeholder name
                                proc.Modules['aim-datafill'].Param[ielem.ID].DataName.push(lookval);
                            }
                        }
                        //keep the html globally
                        proc.Modules['aim-datafill'].Param[ielem.ID].Template.push({Open:attrhtml,Body:ihtml,Close:"</"+ctempl.tagName+">",ID:ctempl.ID});
                       
                        //reset the entire placeholder html
                        //ctempl.Hide();
                        //ctempl.outerHTML = attrhtml + ihtml + "</"+ctempl.tagName+">";

                    }

                }
                
                _.Engine.Proccessor.Finish();
             },
             //#aim-datafill run
             Run:function(ielem){
               // _.Log('Aim datafill run '+ielem.ID);
            if(_.IsElement(ielem)){

                var proc = _.Engine.Proccessor;
                var param = proc.Modules['aim-datafill'].Param[ielem.ID];
               //process src and container if to be dynamically gotten
               //**************************** */
               var rawsrc = param.RawSrc.Trim();
                 if(rawsrc.substr(0,2) == "{{" && rawsrc.substr(rawsrc.length - 2,2) == "}}"){
                     param.Src = proc.GetAttr(rawsrc);
                 }
                
                 var rawcon = param.RawContainer.Trim();
                 if(rawcon.substr(0,2) == "{{" && rawcon.substr(rawcon.length - 2,2) == "}}"){
                     param.Container = proc.GetAttr(rawcon);
                 }

               //**************************** */
               //pre-process the container
               if(param.Container != "aim-alert"){
                var containers = _(param.Container);
                if(_.IsFound(containers)){
                    
                    containers = _.IsArray(containers)?containers:[containers];
                    for(cnt=0;cnt<containers.length;containers++){
                        var cont = containers[cnt];
                        //Handle tab Conatiner
                    //********************** */
                    //check if container if a tab object
                    if(cont.InClass("aim-tab")){
                       // _.Log('Is tab:'+cont.ID);
                       // _.Log('Load Src:'+param.Src.Trim());
                      // _.Log(JSON.stringify(proc.Modules['aim-tab']));
                      var tabbtn = proc.Modules['aim-tab'].Param.IsOpen(cont,param.Src);// the IsOpen return the tab button if it is already opened and false if not
                      if(tabbtn !== false && (_.Attribute(ielem,"aim-datafill-update") !== "true" && _.Attribute(ielem,"aim-datafill-silent") !== "true")){
                        tabbtn.click();return;
                      }
                        //get the params
                       /* var contParam = proc.Modules['aim-tab'].Param[cont.ID];
                        //_.Log("Now: "+JSON.stringify(_.Engine.Proccessor.Modules['aim-tab'].Param));
                        //check if the current tab to load is already loaded
                        if(typeof contParam.Loads[param.Src.Trim()] != _.UND){
                           // _.Log('Load Src already exist');
                            //get the bution id
                            var tabBtnID = contParam.Loads[param.Src.Trim()];
                            //_.Log('Load Src Btn ID:'+tabBtnID);
                            var tabBtn = _(tabBtnID);
                            if(_.IsFound(tabBtn) && _.Attribute(cont,"aim-tab-refresh") !== "true"){
                               // _.Log('Load Src Button exist');
                                tabBtn.click();
                                return;
                            }
                        }*/
                    }
                    
                    //********************** */
                   /* if(triggerobj == null){ //if not initiated from trigger
                        cont.insertAdjacentHTML('afterbegin','<div style="width:100%;text-align:center;padding:5px" id="aim-loading-'+ielem.ID+'">Loading ... <a href="javascript:void(0)" onclick="_.Engine.Proccessor.Memory[\'aim-ajax-\''+ielem.ID+'].Abort()" </div>');
                    }*/
                        //cont.classList.add("w3-animate-fading");
                    }
                }
            }

            //get the post Data //process data
            var proData = proc.Modules['aim-datafill'].Param.GetData(_.Attribute(ielem,"aim-data") || "",ielem.ID);
            //_.Log(JSON.stringify(proData));
            //_.Log(JSON.stringify(proData));
            //alert(_.IsObject(proData));
            
            //data validation faild
            if(proData === false)return;
            var triggerID = _.Attribute(ielem,"aim-trigger-id") || ""; //get the trigger object that initiate the datafill object
            param['TriggerID'] = triggerID;
            var triggerobj = triggerID.Trim() != ""?_(triggerID):null;
            triggerobj = _.IsFound(triggerobj) && triggerobj != null?triggerobj:null;
            //disable trigger object
         var title = "";
         if(triggerobj != null && param.Silent == false){ //disable the trigger object if not in silent mode
             //if trigger object is button
             
             triggerobj.disabled = true;
             title = typeof triggerobj.title != _.UND && triggerobj.title.Trim() != ""?" "+triggerobj.title+"":" Request";
         }
         
         //Start the operation (Display the aim loading dialog) if curently working on the object return false
         var operationstarted = _.StartWork(title,ielem.ID,function(eid){
            var param = _.Engine.Proccessor.Modules['aim-datafill'].Param[eid];
             //get the ajax object if exist
             if(typeof _.Engine.Proccessor.Memory['aim-ajax-'+eid] != _.UND){
                 var wajaxobj = _.Engine.Proccessor.Memory['aim-ajax-'+eid];
                 wajaxobj.Abort();
             }
             //enable all data input element, which are disabled and kept in the GetData function of datafill Module
             if(typeof _.Engine.Proccessor.Memory['aim-datafield-element-'+eid] != _.UND && !param.Silent){
                 var objectdataelems = _.Engine.Proccessor.Memory['aim-datafield-element-'+eid];
                 if(_.IsArray(objectdataelems) && objectdataelems.length > 0){
                     objectdataelems.Each(function(objfield){
                         objfield.disabled = false;
                     })
                 }
             }
             
         });
         
            param['Data'] = proData;
            
            
                param.Complete = false;
                //Remove all loaded template
                var loaded = _('aim-template-load');
                if(_.IsFound(loaded)){
                    loaded = _.IsArray(loaded)?loaded:[loaded];
                    loaded.Each(function(elem){
                        elem.parentNode.removeChild(elem);
                    })
                }
                //process the condition
                //************************************* */
                var cond = param.DataCond;
                if(cond != "" && param.Src == ""){ //if Condition set and is not AIM CBS
                    var condids = proc.Placeholder(cond,"#","#");
                    //_.Log(JSON.stringify(condids));
                    if(condids.length > 0){
                        //get the elements and replace with the value in condition
                        for(var d=0;d<condids.length;d++){
                            var iddet = condids[d];
                            var key = iddet.Placeholder;
                            if(key.Trim() == "")continue;
                            var defaul = iddet.Title;

                         //check if it is set in param(i.e exist in SentData)
                         
                            if(typeof proc.Memory[ielem.ID] != _.UND && typeof proc.Memory[ielem.ID][key] != _.UND && proc.Memory[ielem.ID][key] != null){
                                param.DataCond = param.DataCond.Replace("#"+key+"#",proc.Memory[ielem.ID][key]);
                                //clear the memory space
                                proc.Memory[ielem.ID][key] = null;
                                continue;
                            }
                            var dataelem = _(key);
                            if(_.IsFound(dataelem)){
                                dataelem = _.IsArray(dataelem)?dataelem[0]:dataelem;
                                if(_.IsElement(dataelem)){
                                    var txt = dataelem.Value.Trim() == ""?dataelem.Text:dataelem.Value;
                                    //_.Log(dataelem.textContent);
                                    param.DataCond = param.DataCond.Replace("#"+key+"#",txt);
                                    continue;
                                }
                            }
                            if(defaul != ""){
                                param.DataCond = param.DataCond.Replace("#"+key+"#","'"+defaul+"'");
                                continue;
                            }
                        }
                        
                }
            }
               //Process Condition Ends
               //************************************** */
               //hold data error found

               //for local page(src) datafill
               //Currently under experiment - idea not clearly gotten
               //********************************* */
               var psrc = param.Src.Trim();
               if(psrc.substr(0,1) == "#"){ //if local page
                //get the page selector
                var pselector = psrc.substr(1);
                //get the element
                var srcelement = _(pselector);
                if(_.IsFound(srcelement)){
                    //use the first element seen if multiple element
                    srcelement = _.IsArray(srcelement)?srcelement[0]:srcelement;
                    //get a copy of the element
                    copyelem = srcelement.Cloner(true);
                    var contai = null;
                    if(param.Container != "aim-alert"){
                        contai = _(param.Container);
                        if(_.IsFound(contai)){
                            contai = _.IsArray(contai)?contai[0]:contai;
                        }
                    }
                   if(!param.Append && contai != null){
                    contai.innerHTML = "";
                   }
                   if(contai == null){
                    _.Alert(copyelem.outerHTML);
                 }else{
                   contai.insertAdjacentElement('beforeend',copyelem);
                 }

                    if(triggerobj != null){ //if trigger object exist enable it
                        triggerobj.disabled = false;
                       /* if(typeof _.Engine.Proccessor.Memory['aim-trigger-content-'+rparam.ElementID] != _.UND){
                            triggerobjr.innerHTML = _.Engine.Proccessor.Memory['aim-trigger-content-'+rparam.ElementID]
                        }*/
                        
                    }
                   // _.Log(res);
                          //alert(res);
                    //close the loading obj
                    _.FinishWork(ielem.ID);
                    param.Complete = true
                    return;

                }
               }
              //**************************** */
               
              // alert('ssss');

               //_.Log(postData);
              // param['Data'] = {"1":postData};
              //before packaging all param to pe sent to server
              //Get all files in server and send directly to aim ajax so that aim ajax can process it, in order to make it available in $_FILE global variable in the server
              //set add the working class to the  element if set
              if(triggerobj != null && param.WorkingClass != "")triggerobj.classList.add(param.WorkingClass);
              var datas = typeof param['Data']["aim-data-file"] == _.UND?{}:param['Data']["aim-data-file"];
              //include the server call signatures (object caller type, aim version)
              datas['aim-datafill']=1; datas['aim-version']=_.Version;datas['aim-root']=_.Engine.Dom.Loader.Root;
              
                //package all datafill parameters as json
                param = JSON.stringify(param);
                //_.Log(param);
                //Add to ajax data
                datas['aim-param']=param
                //_.Log(param);
                //send to server
                proc.Memory['aim-ajax-'+ielem.ID] =  _.Post({
                 Action:_.Engine.Dom.Loader.Dir+"aim.php",
                // Data:{'aim-datafill':1,'aim-version':_.Version,'aim-param':param},
                Data:datas,
                 OnComplete:function(res,url,param){ //get response from server
                    //_.Log(res);
                    //alert(res);
                   var rparam = JSON.parse(param['aim-param']); //get parameters sent to aim
                   var triggerIDr = rparam['TriggerID'].Trim();
                   var triggerobjr = triggerIDr.Trim() != ""?_(triggerIDr):null;
                   triggerobjr = _.IsFound(triggerobjr) && triggerobjr != null?triggerobjr:null
                    var modul = _.Engine.Proccessor.Modules['aim-datafill'];
                    
                    if(rparam.Container != "aim-alert"){
                       // _.Log(rparam.Container);
                    var containers = _(rparam.Container); //get the container to be filled by aim
                    if(_.IsFound(containers)){ //if the container exist
                        
                        containers = _.IsArray(containers)?containers:[containers];
                        //remeove the aim loading popup (indicating end of operation)
                        containers.Each(function(cont){
                            if(triggerobjr == null){
                                loadingmk = cont._('aim-loading-'+rparam.ElementID);
                                if(_.IsFound(loadingmk))loadingmk.parentElement.removeChild(loadingmk);
                            }
                            //stop the fading animation indicating loading operation of the container is ongoing
                            //cont.classList.remove("w3-animate-fading");
                        })
                    }
                }
                
                if(triggerobjr != null){ //if trigger object exist enable it
                    triggerobjr.disabled = false;
                   /* if(typeof _.Engine.Proccessor.Memory['aim-trigger-content-'+rparam.ElementID] != _.UND){
                        triggerobjr.innerHTML = _.Engine.Proccessor.Memory['aim-trigger-content-'+rparam.ElementID]
                    }*/
                    
                }
               // _.Log(res);
                      //alert(res);
                //close the loading obj
                _.FinishWork(rparam.ElementID);
                  res = _.Engine.Server(res); //proccess the server response
                  if(res.HasError){ //if error exist
                      _.Log(res.Error.Code+" "+res.Error.Message+" ("+res.Error.Line+")");
                      
                      modul.Param[rparam.ElementID].Complete = true
                      return;
                  }
                  //_.Log(res['TabButton']);
                  //Check if it is CBS - CBS must return the funished Markup and Alert markup
                  if(typeof res['Markup'] != _.UND && typeof res['Alert'] != _.UND){
                      //var containers = _(rparam.Container); //Containers to fill
                      if(rparam.Container != "aim-alert"){
                      if(_.IsFound(containers)){
                        
                          containers = _.IsArray(containers)?containers:[containers];
                         
                          //loop throu all containers and fill it with the markup
                          if(res['Markup'].Trim() != "" || res['Data'] != {}){
                           
                          containers.Each(function(container){
                              //_.Log(container.outerHTML);
                              //check if container is a tab object
                              if(container.InClass("aim-tab") && res['TabButton'].Trim() != ""){
                                
                                // alert(JSON.stringify(res)); 
                                 var tabinfo = _.Engine.Proccessor.Modules['aim-tab'].Param[container.ID];
                                 //get the tab initialization parameter
                                 var tHead = tabinfo.Head; //get the tab head
                                 var tbody = tabinfo.Body; //get the tab body
                                 //insert button into head
                                 //check if button already loaded
                                 var tabbtn = _.Engine.Proccessor.Modules['aim-tab'].Param.IsOpen(container,rparam.Src);
                                   var silentmode = false; //indicate if tab content is loaded in silent mode     
                                 if(typeof res['TabButton'] != _.UND){ //if tab button section (markup) send from server
                                    if(tabbtn !== false){ //if already opened
                                        
                                        var tabcontid = _.Attribute(tabbtn,"aim-target") || "";
                                        var tabcontidobj = tabcontid != ""?_(tabcontid):[];
                                        if(rparam.Silent && _.IsFound(tabcontidobj)){//if silent mode and tab content exist
                                            //create a tempoary div
                                            var tempdiv = document.createElement("div");
                                            tempdiv.innerHTML = res['Markup'];
                                            //get the tab content inner html
                                            var tabcont = tempdiv._('aim-tab-content');
                                            if(_.IsFound(tabcont)){
                                                tabcontidobj.innerHTML = tabcont.innerHTML;
                                                silentmode = true;
                                                _.Engine.Proccessor.Init(tabcontidobj);
                                                //init tab close buttons in tab
                                                _.Engine.Proccessor.Modules['aim-tab'].Param.InitTabClose(tabcontid,tabbtn);
                                            }
                                           // _.Log(_(tabcontid).outerHTML);
                                                //_.Log(res['Markup']);
                                        }//else{ 

                                         //if not silent mode continue with normal operation
                                         if(!silentmode){//if not silent mode, close the tab first and add a new one
                                             //get the content id from the button
                                            var closetabids = tabcontid.Trim() == ""?tabbtn.ID:tabbtn.ID + " + " + tabcontid;
                                            var closetb = _.Engine.Proccessor.Modules['aim-tab'].Param.CloseTab(closetabids);
                                            
                                         }
                                            
                                        //}
                                        
                                        
                                      //var newbtn = tabbtn;
                                      //close the tab first

                                    }//else{//if not already open laod into the tab head
                                    if(!silentmode){
                                    tHead.insertAdjacentHTML('afterbegin',res['TabButton']); //add it to the tab head container
                                   // _.Log("tab head ID: "+tHead.ID);
                                    //get the inserted element by its indicator
                                    var ind = tHead._("aim-tab-button-ind"); //get the inserted tab button indicator

                                    if(_.IsFound(ind)){ //if indicator exist
                                        ind = _.IsArray(ind)?ind[0]:ind;
                                        //use the indicator to get the newly inserted button
                                        var newbtn = ind.nextElementSibling;
                                        //make it a valid tab button by adding the required class name to it
                                        newbtn.classList.add("aim-tab-button");
                                        
                                        //remove the indicator
                                        tHead.removeChild(ind);
                                    }
                                // }
                                 //include the page title to the button as well, so that when the tab button is click the page title can be displayed
                                 _.Attribute(newbtn,"aim-tab-page-title",res['PageTitle']);
                                }
                                }

                                if(!silentmode){
                                 //insert content in body
                                 tbody.insertAdjacentHTML('afterbegin',res['Markup']);
                                 //get the inserted element by its indicator
                                 var indb = tbody._("aim-tab-content-ind");
                                 if(_.IsFound(indb)){
                                    indb = _.IsArray(indb)?indb[0]:indb;
                                    var newbtnb = indb.nextElementSibling;
                                     //make it a valid tab content by adding the required class name to it
                                    newbtnb.classList.add("aim-tab-content");
                                    //remove the indicator
                                    tbody.removeChild(indb);
                                }

                                //add the loaded to tab to tabs global list of laoded tabs
                                tabinfo.Loads[rparam.Src.Trim()] = newbtn.ID
                                //_.Engine.Proccessor.Modules['aim-tab'].Param[container.ID]
                                //_.Log("Set: "+JSON.stringify(_.Engine.Proccessor.Modules['aim-tab'].Param));
                                //Perform live initialization just added markups
                           // _.Engine.Proccessor.InitLive("#"+container.ID,"tab"); ***
                          // _.Engine.Proccessor.InitNow(container,"aim-tab");
                               _.Engine.Proccessor.Init(container);
                            }

                              }else{ //filling into normal container
                                
                                //check if element is input or select or image
                                if(container.tagName.toLowerCase() == 'input' || container.tagName.toLowerCase() == 'select' || container.tagName.toLowerCase() == 'img' || container.InClass("aim-filepicker")){

                                   //Get the datafield/key
                                   var dkey =_.Engine.Proccessor.GetAttr( _.Attribute(container,"aim-datafield") || "");
                                   dkey = dkey.Trim() != ""?dkey:typeof container.id != _.UND && container.id.Trim() != ""?container.id:"";
                                   
                                   var dval = (dkey.Trim() != "" && typeof res['Data'][dkey] != _.UND)?res['Data'][dkey] :"";
                                
                                   //alert(JSON.stringify(res['Data']));
                                   //alert(dval)

                                   //set for input element
                                   if(container.InClass("aim-filepicker")){//if container is a file picker
                                   // _.Log("Filepicker seen - " + container.ID)
                                   var param = _.Engine.Proccessor.Modules['aim-filepicker'].Param;
                                      //1.Set the default value
                                      if(dval.Trim() != ""){
                                            param.SetTarget(container,dval);  
                                          
                                      }
                                      //2. Run Reset to set target
                                      //.Reset(container);
                                     

                                     }else if(container.tagName.toLowerCase() == 'input'){
                                       //check if radio or checkbox
                                       if(container.type.toLowerCase() == "radio" || container.type.toLowerCase() == "checkbox"){
                                        container.checked = Boolean(dval);
                                       }else{ //other input element
                                        container.Value = dkey.Trim() != ""?dval:res['Markup'];
                                       }
                                   }else if(container.tagName.toLowerCase() == 'select'){
                                     //check if value contain option markup
                                     //alert({"sss":"jjjs","jsksk":"ksks","jsjsk":"mjsksk"}.length);
                                     if(_.IsString(dval) || _.IsNumber(dval)){ //if no option
                                        container.Value = dval;
                                     }else{
                                         
                                        container.innerHTML = "";
                                         if(dval.length > 0){
                                             //_.Log(dval.length);
                                            for (var selkey in dval) {
                                                if (dval.hasOwnProperty(selkey)) {
                                                    var selval = dval[selkey];
                            
                                                    container.insertAdjacentHTML('beforeend','<option value="'+selkey+'" >'+selval+'</option>');
                                                }
                                            }
                                         }
                                         
                                     }
                                   }else{ //if image
                                    container.src = dval
                                   }
                                }else{
                                    //if markup sent
                                if(res['Markup'].Trim() != ""){
                                    
                                    container.innerHTML = res['Markup']; //clear the esisting one

                             // container.insertAdjacentHTML('afterbegin',res['Markup']);
                              //alert(container.id)
                              //var inittype = "normal"; ***
                              var inittype = "";
                             // _.Log(container.className);
                              if(container.InClass('aim-wizard-page')){ //if loaded inside a wizard page
                                //initialize every Goto button loadaed
                                _.Engine.Proccessor.Modules['aim-wizard'].Param['AssignGoto'](container);
                                      //inittype="aim-wizard";
                              }
                              //Perform live initialization just added markups
                            //_.Engine.Proccessor.InitLive("#"+container.ID, inittype); ***
                           // _.Engine.Proccessor.InitNow(container, inittype); 
                           _.Engine.Proccessor.Init(container); 
                            }else{//if no markup set, check if container is a datafield and insert data if set
                                var dkey =_.Engine.Proccessor.GetAttr( _.Attribute(container,"aim-datafield") || "");
                                dkey = dkey.Trim() != ""?dkey:typeof container.id != _.UND && container.id.Trim() != ""?container.id:"";
                                   
                                   var dval = (dkey.Trim() != "" && typeof res['Data'][dkey] != _.UND)?res['Data'][dkey] :"";
                                   if(dval != ""){//if value found
                                    container.innerHTML = dval.toString();
                                   }
                            }
                                }
                                
                              }
                              
                              
                            if(res['PageTitle'].Trim() != "")_('title').textContent = res['PageTitle']; //set the page title
                          });
                        }
                      }
                    }else{
                        //to be display in aim alert
                        _.Alert(res['Markup'],res['AlertTitle'],res['AlertName']);
                    }

                      
                     // _.Log(JSON.stringify(res));
                      //alert(JSON.stringify(res));
                      //check if popup markup sent
                      if(res['Alert'].Trim() != ""){
                        /*  //get the user desinged popup
                        var popind = _('aim-popup-ind');
                        if(_.IsFound(popind)){
                           var userpopup = popind.nextElementSibling;
                           //get the popup title and fill it
                           var poptit = _("#"+userpopup.ID+" #aim-popup-title");
                           if(_.IsFound(poptit)){
                            poptit.parentElement.innerHTML = '<input type="hidden" id="aim-popup-title" />'+res['PopupTitle'];
                           }
                           
                           //get the popup body and fill it
                           var popbody = _("#"+userpopup.ID+" #aim-popup-body");
                           if(_.IsFound(popbody)){
                            popbody.parentElement.innerHTML = '<input type="hidden" id="aim-popup-body" />'+res['Popup'];
                           }
                           userpopup.Show();
                        }*/
                       // alert(res['AlertTitle']);
                        _.Alert(res['Alert'],res['AlertTitle'],res['AlertName']);
                      }
                     // console.log(param['aim-param']);
                      paramobj = JSON.parse(param['aim-param']);
                      modul.Param[paramobj.ElementID].Complete = true;
                      var rf = modul.Param[paramobj.ElementID].Refresh;
                      if(rf > 0){ //if refresh rate set
                        setTimeout("_.Engine.Proccessor.Run(_('"+paramobj.ElementID+"','aim-datafill'))",rf*1000);
                      }
                      if(triggerobjr != null && paramobj.WorkingClass != "")triggerobjr.classList.remove(paramobj.WorkingClass);
                      return;

                  }
                  
                  //loop throuhg the res (contains the formed markup for each template from server)
                  for (var tid in res) {
                      if (res.hasOwnProperty(tid)) {
                          //get the template
                          var templatemk = _(tid);
                          //alert(templatemk);
                          if(_.IsFound(templatemk)){ //if the template exist
                            //insert the markup imdeately under it
                            templatemk.insertAdjacentHTML("afterend",res[tid]);
                          }
                          //_.Log(tid + "=>" + res[tid]);
                      }
                  }
                  
                  paramobj = JSON.parse(param['aim-param']);
                  modul.Param[paramobj.ElementID].Complete = true
                  var rf = modul.Param[paramobj.ElementID].Refresh;
                  if(rf > 0){ //if refresh rate set
                    setTimeout("_.Engine.Proccessor.Run(_('"+paramobj.ElementID+"','aim-datafill'))",rf*1000);
                  }
                  if(triggerobjr != null && paramobj.WorkingClass != "")triggerobjr.classList.remove(paramobj.WorkingClass);
                  // _.Log(rparam.ElementID);
                  //_.Engine.Proccessor.Finish();
                 },
                 OnError:function(res,url,param){
                    //_.Log(res);
                    var modul = _.Engine.Proccessor.Modules['aim-datafill'];
                    paramobj = JSON.parse(param['aim-param']);
                    
                   var triggerIDr = paramobj['TriggerID'].Trim();
                   var triggerobjr = triggerIDr.Trim() != ""?_(triggerIDr):null;
                   triggerobjr = _.IsFound(triggerobjr) && triggerobjr != null?triggerobjr:null;
                   if(triggerobjr != null){triggerobjr.disabled = false}
                   if(triggerobjr != null && paramobj.WorkingClass != "")triggerobjr.classList.remove(paramobj.WorkingClass);
                   _.FinishWork(paramobj.ElementID)
                    modul.Param[paramobj.ElementID].Complete = true
                 // _.Engine.Proccessor.Finish();
                 },
                 OnAbort:function(res,url,param){
                    var modul = _.Engine.Proccessor.Modules['aim-datafill'];
                    paramobj = JSON.parse(param['aim-param']);
                    var triggerIDr = paramobj['TriggerID'].Trim();
                   var triggerobjr = triggerIDr.Trim() != ""?_(triggerIDr):null;
                   triggerobjr = _.IsFound(triggerobjr) && triggerobjr != null?triggerobjr:null;
                   if(triggerobjr != null){triggerobjr.disabled = false}
                   if(triggerobjr != null && paramobj.WorkingClass != "")triggerobjr.classList.remove(paramobj.WorkingClass);
                   //_.FinishWork(paramobj.ElementID)
                    modul.Param[paramobj.ElementID].Complete = true
                 }
             })
            }
             
         }
        },
        //Aim tab Object
        'aim-tab':{
          Param:{IsOpen:function(tabobj,loadsrc){
              //get the params
              var contParam = _.Engine.Proccessor.Modules['aim-tab'].Param[tabobj.ID];
              //_.Log("Now: "+JSON.stringify(_.Engine.Proccessor.Modules['aim-tab'].Param));
              //check if the current tab to load is already loaded
              if(typeof contParam.Loads[loadsrc.Trim()] != _.UND){
                 // _.Log('Load Src already exist');
                  //get the bution id
                  var tabBtnID = contParam.Loads[loadsrc.Trim()];
                  //_.Log('Load Src Btn ID:'+tabBtnID);
                  var tabBtn = _(tabBtnID);
                  if(_.IsFound(tabBtn)){
                     // _.Log('Load Src Button exist');
                      //tabBtn.click();
                      return tabBtn;
                  }
              }
              return false;
          },
        CloseTab:function(tabID){
            //tabID, the tab button and tab content id (join selector => butnID + contentID)
            if(typeof tabID != _.UND && tabID !== false){//if tabid exixt
                //get the tabhead and content to delete
                var tabbtnContDel = _(tabID);
                
                 if(_.IsFound(tabbtnContDel)){
                     tabbtnContDel = _.IsArray(tabbtnContDel)?tabbtnContDel:[tabbtnContDel];
                     tabbtnContDel.Each(function(delobj){
                         if(delobj.InClass('aim-tab-button')){ //if tab button
                         var params = _.Engine.Proccessor.Modules['aim-tab'].Param[_.Attribute(delobj,'aim-tab-id')];
                         var HeadActiveClass = params.HeadActiveClass;
                         if(delobj.InClass(HeadActiveClass)){ //if aim tab button to delete is curently the active button
                             //get the next sibling to display
                             nxtsibling = delobj.previousElementSibling; //get the previous sibling
                             //if previous sibling not exist, get the next sibling
                             nxtsibling = nxtsibling == null?delobj.nextElementSibling:nxtsibling;
                             if(nxtsibling != null)nxtsibling.click(); //if sibling found click it to display it
                         }
                     }
                         delobj.parentElement.removeChild(delobj); //remove the element (button or content to delete) from the parent childrens
                     });
                 }
               }
               return true;
        }, 
        InitTabClose:function(tabContentID,cbtn){
            var getstr = typeof cbtn != _.UND?"#"+cbtn.ID+ " .aim-tab-close + #"+tabContentID + " .aim-tab-close":"#"+tabContentID + " .aim-tab-close";
            var tabCloseButtons = _(getstr);
            if(_.IsFound(tabCloseButtons)){ //if close button found
             //makesure is an array
             tabCloseButtons = _.IsArray(tabCloseButtons)?tabCloseButtons:[tabCloseButtons];
              //loop thruogh them and set handles for them
              for(var clbtn=0;clbtn<tabCloseButtons.length;clbtn++){
                var ctabCloseBtn = tabCloseButtons[clbtn];
                if(_.IsElement(ctabCloseBtn)){
                    //set the tab id to close
                    _.Attribute(ctabCloseBtn,'aim-tab-close-ids',cbtn.ID + " + "+tabContentID);
                    //set the event handler
                    ctabCloseBtn.Assign('click',function(e){
                     e.stopPropagation();
                       var rclbtn = e.currentTarget;
                       //get the tab
                       var tabID = _.Attribute(rclbtn,'aim-tab-close-ids') || false;
                       
                       //perform close
                       _.Engine.Proccessor.Modules['aim-tab'].Param.CloseTab(tabID)
                    });
                }
              }
            }
            _.Attribute(cbtn,'aim-tab-button-init','true'); //set the button initialization flag
        }
    },
          Init:function(ielem){
              var proc = _.Engine.Proccessor;
            
               //Setup parameters
               if(typeof proc.Modules['aim-tab'].Param[ielem.ID] == _.UND){
                proc.Modules['aim-tab'].Param[ielem.ID] = {
                    Body:"",
                    Head:"",
                    Loads:{}
                }
            }
              
              //keep the parameters in a variable
              var Gparam = proc.Modules['aim-tab'].Param[ielem.ID];
              Gparam.Head = (function(inelem){ //get the aim-tab-head object
                //get the head section of the tab
                var headId = _.Engine.Proccessor.GetAttr(_.Attribute(inelem,'aim-tab-head'));
                //if tab head is outside or inside the tab object get it 
                var tabhead = (headId == null || headId.Trim() == "")?inelem._('aim-tab-head'):_(headId);
                //return the tab head section if exist else return the tab object itself
                return _.IsFound(tabhead)?_.IsArray(tabhead)?tabhead[0]:tabhead:inelem;
               })(ielem);

               

               Gparam.Body =(function(inelem){//get the aim-tab-body
                //get the body section of the tab
                var bodyId = _.Engine.Proccessor.GetAttr(_.Attribute(inelem,'aim-tab-body'));
                //if tab body is outside or inside the tab object get it 
                var tabBody = (bodyId == null || bodyId.Trim() == "")?inelem._('aim-tab-body'):_(bodyId);
                //return the tab body section if exist else return the tab object itself
                return _.IsFound(tabBody)?_.IsArray(tabBody)?tabBody[0]:tabBody:inelem;
               })(ielem);

              
              //Gparam.Loads = {}
             //set the head active classname
             //aim-tab-active => the tab-head attribute name that holds the active tab button class name
             //aim-active-tab => the default active tab button class name
             Gparam.HeadActiveClass = proc.GetAttr(_.Attribute(Gparam.Head,"aim-tab-active") || "aim-active-tab");
            //get the buttons in the head section
            var tabButtons = Gparam.Head._('aim-tab-button');
            
            //get the contents in the body section
            var tabContents = Gparam.Body._('aim-tab-content');
           
            //if tab contains contents
            if(_.IsFound(tabContents)){
                tabContents = _.IsArray(tabContents)?tabContents:[tabContents];
                //make sure the tab buttons found in the head section is in array format
                tabButtons = _.IsFound(tabButtons)?_.IsArray(tabButtons)?tabButtons:[tabButtons]:[];

                //loop through all the tab contentns
                for(var d=0;d<tabContents.length;d++){
                    var tabContentID = tabContents[d].ID;
                    
                     //Initialize every aim object in the tab body Content
               var tabBodyContInit = _.Attribute(tabContents[d],"aim-object-init") || false;
               if(tabBodyContInit === false){//if not initialized
                proc.Init(tabContents[d]); //initialize its content
                _.Attribute(tabContents[d],"aim-object-init","true");
               }
                    //get the button in same index
                    var cbtn = null;
                    if(typeof tabButtons[d] != _.UND){ //if button exist
                        cbtn = tabButtons[d];
                        
                        
                        var cbtnInit = _.Attribute(cbtn,'aim-tab-button-init') || false;
                        if(cbtnInit !== false){
                            //remove the active class name from the button
                            cbtn.classList.remove(Gparam.HeadActiveClass)
                            continue; //if already initialize continue with other button
                        }
                        //make sure it is hidden except the first
                        if(d>0){
                            tabContents[d].Hide()
                        }else{
                            
                        }
                       
                        //set the active button class name to the firat button
                        if(d==0 && Gparam.HeadActiveClass.Trim() != ""){
                            cbtn.classList.add(Gparam.HeadActiveClass)
                        }else{
                            //remove the active button class name from the rest if set
                           // cbtn.classList.remove(Gparam.HeadActiveClass)
                        }
                        
                       //set the button target attribute to the content id (use when button click to display the require content)
                       _.Attribute(cbtn,"aim-target",tabContentID);

                       //keep the main tab id in the button for easy access in the button onclick event
                       _.Attribute(cbtn,"aim-tab-id",ielem.ID);
                       //alert(cbtn.ID + " => "+_.Attribute(cbtn,"aim-target"));
                    }else{ //if the button does not exist
                        //manually form a button for it
                        var newtabBtn = '<button id="tab-btn-'+tabContentID+d+'" class="aim-tab-button" aim-target="'+tabContentID+'">Tab '+(d+1)+'</button>';
                        //insert the newly created button
                        tabhead.insertAdjacentHTML('beforeend',newtabBtn);
                        cbtn = _('tab-btn-'+tabContentID+d);
                    }

                    //assign handler to the on click event of the button
                    cbtn.Assign('click',function(e){
                        e.stopPropagation();
                        iproc = _.Engine.Proccessor;
                        var btn = e.currentTarget;
                        var ptitle = _.Attribute(btn,"aim-tab-page-title") || btn.textContent;
                        //set the page title
                        _('title').innerHTML = ptitle;
                        //get the content elemet
                        var ContID = iproc.GetAttr(_.Attribute(btn,"aim-target"));
                        var tabObjID = iproc.GetAttr(_.Attribute(btn,"aim-tab-id"));
                        //get the parameter set
                        var params = _.Engine.Proccessor.Modules['aim-tab'].Param[tabObjID];
                        var HeadActiveClass = params.HeadActiveClass;
                        //var BodyActiveClass = params.BodyActiveClass;

                        //get the button content
                        var ContObj = _(ContID);
                        if(_.IsFound(ContObj)){ //if the content exist
                            //get all buttons
                            var buttonsSiblings = btn.parentElement._('aim-tab-button');
                          //get his siblings
                          var siblings = ContObj.parentElement._('aim-tab-content');
                         //_.Log(siblings.length); 
                          if(_.IsFound(siblings)){
                             //set the active class on the active button and remove in others
                             if(HeadActiveClass.Trim() != ""){ //if head buttons active classname is set
                               if(_.IsFound(buttonsSiblings)){ //if button exist (which should exist)
                                 buttonsSiblings = _.IsArray(buttonsSiblings)?buttonsSiblings:[buttonsSiblings];
                                 for(var fs=0;fs<buttonsSiblings.length;fs++){
                                    buttonsSiblings[fs].classList.remove(HeadActiveClass);
                                 }
                               }
                               btn.classList.add(HeadActiveClass);
                             }
                            siblings = _.IsArray(siblings)?siblings:[siblings];
                            for(var ss=0;ss<siblings.length;ss++){
                               // if(BodyActiveClass.Trim() != "")siblings[ss].classList.remove(BodyActiveClass)
                                siblings[ss].Hide();
                                
                            }
                          }
                          //if(BodyActiveClass.Trim() != "")ContObj.classList.add(BodyActiveClass)
                          ContObj.Show();
                        }
                    });

                    //get all the close button in the content and button then set the event handler as required
                    //Initialize the aim-tab-close
                    //get the close buttons in tabHaed and body
                    _.Engine.Proccessor.Modules['aim-tab'].Param.InitTabClose(tabContentID,cbtn);
                   
                    
                }
            }
            _.Engine.Proccessor.Finish();
          }
          
        },

        //AIM Filter
        'aim-filter':{
           Param:{
               PerfromFilter:function(elem){
                var filetrbx = elem.Attribute('aim-filter-box');
                if(filetrbx == null && filetrbx.Trim() == "")return;
                var param = _.Engine.Proccessor.Modules['aim-filter'].Param[filetrbx];
                //var timmer = param['Timmer'];
                var innerelem = param['InnerElems'];
                var d = param['Index'];
                var input = param['Input'];
                if(typeof innerelem[d] == _.UND)return param['Total'];
                var citem = innerelem[d];
                var citemfields = citem._('aim-filter-field');
                var seen = false,empty=true;
                if(!_.IsFound(citemfields))return param['Total'];
                citemfields = _.IsArray(citemfields)?citemfields:[citemfields];
                for(var s=0; s<citemfields.length;s++){
                   var field = citemfields[s];
                   var val = input.Value;
                   var txt = (field.tagName.toLowerCase() == "input" || field.tagName.toLowerCase() == "textarea" || field.tagName.toLowerCase() == "select")?field.Value:field.innerHTML;
                   //remove all decoration on string
                   var decorind = txt.split('<span class="aim-filtered" style="font-weight:bold;color:red">');
                   if(decorind.length > 1){
                       //get the closing tag index
                        decorind[1] = decorind[1].replace('</span>','');
                        txt = decorind.join('');

                   }
                   if(val.Trim() != ""){
                   
                   if(txt.toUpperCase().indexOf(val.toUpperCase()) > -1){
                       /* if(txt.indexOf('class="aim-filtered"') > -1){
                        field.innerHTML = txt.replace('class="aim-filtered"','class="aim-filtered" style="font-weight:bold;color:red">');
                       }else{ */
                          if(!(field.tagName.toLowerCase() == "input" || field.tagName.toLowerCase() == "textarea" || field.tagName.toLowerCase() == "select"))field.innerHTML =  txt.replace(val,'<span class="aim-filtered" style="font-weight:bold;color:red">'+val+'</span>'); 
                      // }
                    
                    //citem.style.display = "";
                    seen = true;
                    //break; 
                   }else{
                    if(!(field.tagName.toLowerCase() == "input" || field.tagName.toLowerCase() == "textarea" || field.tagName.toLowerCase() == "select"))field.innerHTML = txt;
                   }
                }else{
                    seen = true;
                   
                    if(!(field.tagName.toLowerCase() == "input" || field.tagName.toLowerCase() == "textarea" || field.tagName.toLowerCase() == "select"))field.innerHTML = txt; 
                }
        
                }
                //empty = false;
                //var totseen = 0;
                if(!seen){
                    citem.style.display = "none";
                }else{
                    param['Total']++;
                    citem.style.display = "";  
                }
                var paramElem = _.Engine.Proccessor.Modules['aim-filter'].Param[input.ID]; 
               if(paramElem.TotalTarget.Trim() != ""){
                   var targetelem = _(paramElem.TotalTarget);
                   if(_.IsFound(targetelem)){ //element found
                     //make sure is array
                     //alert(totseen);
                     targetelem = _.IsArray(targetelem)?targetelem:[targetelem];
                     for(var d=0;d<targetelem.length;d++){
                        targetelem[d].Text = param['Total'];
                        if(param['Index'] + 1 < innerelem.length)targetelem[d].Text += "..";
                     }
                   }
               }
               if(param['Index'] < innerelem.length){
                param['Index']++;
                param['Timmer'] = setTimeout("_.Engine.Proccessor.Modules['aim-filter'].Param.PerfromFilter(_('"+input.ID+"'))",30)
               }else{
                param['Index'] = 0;
                clearTimeout(param['Timmer']);
               }
                return param['Total'];
               },
               Filter:function(elem){
                var input = elem;
                var filetrbx = input.Attribute('aim-filter-box');
                if(filetrbx == null && filetrbx.Trim() == "")return;
                var mainCont = _(filetrbx);
                
                var innerelem = mainCont._('aim-filter-item');
                var totseen=0;
                if(!_.IsFound(innerelem)){
                    
                }else{
                    
                innerelem = _.IsArray(innerelem)?innerelem:[innerelem];
                //add Filter object details
                var param = _.Engine.Proccessor.Modules['aim-filter'].Param[filetrbx];
                if(typeof param == _.UND)_.Engine.Proccessor.Modules['aim-filter'].Param[filetrbx] = [];
                param = _.Engine.Proccessor.Modules['aim-filter'].Param[filetrbx];
                if(typeof param['Timmer'] != _.UND && param['Timmer'] != null){ //if timmer is null
                    clearTimeout(param['Timmer']);
                }
                param['Timmer'] = null;
                param['InnerElems'] = innerelem;
                param['Index'] = 0;
                param['Input'] = input;
                param['Total'] = 0;
               
                //for(var d=0; d<innerelem.length;d++){
                    //param['Index'] = d;
                     _.Engine.Proccessor.Modules['aim-filter'].Param.PerfromFilter(elem);
                //}
            }
                
               }
        },
           Init:function(elem){
               var proc = _.Engine.Proccessor;
               var param = proc.Modules['aim-filter'].Param
               param[elem.ID] = {
                   TotalTarget : proc.GetAttr(_.Attribute(elem,"aim-filter-target") || "")
               }
               var ev = "click";
               if(elem.tagName.toLowerCase() == "select"){
                   ev = "change";
               }else if(elem.tagName.toLowerCase() == "input"){
                if(elem.type=="radio" || elem.type=="checkbox"){
                   ev = "change"; 
                }else if(elem.type=="text" || elem.type.Trim()==""){
                   ev = "input";
                }
                
               }

              elem.Assign(ev,function(e){
                  //Function to fileter the content of a table or ul
                _.Engine.Proccessor.Modules['aim-filter'].Param.Filter(e.currentTarget);
                });
                
    _.Engine.Proccessor.Finish();
           },
           Run:function(elem){
               
            _.Engine.Proccessor.Modules['aim-filter'].Param.Filter(elem);
           }
        },

        //AIM #Wizard
        'aim-wizard':{
            Param:{AssignGoto:function(aimpage){
                var mwizard = _.Attribute(aimpage,'aim-wizard-object') || document.body.ID; //the main wizard id
               var gotobtns = aimpage._('aim-wizard-goto'); //get all goto buttons in page
               if(_.IsFound(gotobtns)){ //if goto button found in page
                   //_.Log("Goto Buttons Found");
                   gotobtns = _.IsArray(gotobtns)?gotobtns:[gotobtns];
                   for(var gt=0;gt<gotobtns.length;gt++){
                       _.Attribute(gotobtns[gt],'aim-target-wizard',mwizard);
                       //_.Log("Goto Buttons target wizard set to "+mwizard);
                       gotobtns[gt].Assign('click',function(e){
                           e.stopPropagation();
                       var gtbtn = e.currentTarget
                       _.Engine.Proccessor.Modules['aim-wizard'].Run(gtbtn);

                       });
                   }
               }
            }},
            Init:function(ielem){
                //_.Log("***Init***");
                var proc = _.Engine.Proccessor.Modules['aim-wizard'];
                //if(typeof proc.Param[ielem.ID] == _.UND){
                    proc.Param[ielem.ID] = {
                     CurrentPage:"",
                     TotalPages:0,
                     FirstPage:"",
                     
                    }
               // }
               //if the elem to initialize is a wizard page (meaning initialize the wizard page child aim objects only)
               if(ielem.InClass("aim-wizard-page")){
                   //_.Log('Wizard is a wizard-page = '+ielem.ID)
                  //get the paraent aim wizard object
                  var pelem = ielem;
                  var seen = false;
                  while(seen == false){
                    var ielem = ielem.parentElement;
                    if(ielem.InClass("aim-wizard") || ielem == document.body){
                        seen = true;
                        //_.Log('Wizard found = '+ielem.ID);
                    }
                  }

               }else{
                //_.Log('Wizard is a real wizard object = '+ielem.ID)
                //get the first wizard page to display
                var allWizardPages = ielem._('aim-wizard-page');
                if(_.IsFound(allWizardPages)){//if wizard object contain pages
                    //_.Log('Wizard Pages Found');
                    if(!_.IsArray(allWizardPages)){//if contain only one page
                        //_.Log('Only one found');
                        _.Attribute(allWizardPages,"aim-wizard-object",ielem.ID);
                        proc.Param[ielem.ID].CurrentPage = allWizardPages.ID;
                        proc.Param[ielem.ID].TotalPages = 1;
                    }else{//if multiple pages
                        //var firstPage = "";//will hold the id of the first page to display
                        //_.Log(allWizardPages.length+ ' Pgaes Found');
                        for(var wp=0;wp<allWizardPages.length;wp++){
                            //if the current loop page is set to be the first page and no current page set, set it(the ID) as both the current page and the first page
                                if(allWizardPages[wp].InClass("aim-wizard-first") && proc.Param[ielem.ID].CurrentPage.Trim() == ""){
                                    //_.Log('First and Current Page = '+allWizardPages[wp].ID); 
                                    proc.Param[ielem.ID].CurrentPage = proc.Param[ielem.ID].FirstPage = allWizardPages[wp].ID
                                }else{ //else hide it
                                    allWizardPages[wp].Hide();
                                    //_.Log(allWizardPages[wp].ID + ' Hidden'); 
                                }
                                _.Attribute(allWizardPages[wp],"aim-wizard-object",ielem.ID);
                                //initialize the content of the wizard-page if not already done
                                var wpageinit = _.Attribute(allWizardPages[wp],"aim-object-init") || false
                                if(wpageinit === false || wpageinit == "false"){ //if not already initialized, or initialization is required
                                //1. First initialize the goto buttons inside it
                                //_.Log("Initializing Goto Buttons in page "+allWizardPages[wp].ID);
                                proc.Param.AssignGoto(allWizardPages[wp]);
                                //var gotobtns = typeof pelem == _.UND?ielem._('aim-wizard-goto'):pelem._('aim-wizard-goto');
                               /* var gotobtns = allWizardPages[wp]._('aim-wizard-goto'); //get all goto buttons in page
                                if(_.IsFound(gotobtns)){ //if goto button found in page
                                    _.Log("Goto Buttons Found");
                                    gotobtns = _.IsArray(gotobtns)?gotobtns:[gotobtns];
                                    for(var gt=0;gt<gotobtns.length;gt++){
                                        _.Attribute(gotobtns[gt],'aim-target-wizard',ielem.ID);
                                        _.Log("Goto Buttons target wizard set to "+ielem.ID);
                                        gotobtns[gt].Assign('click',function(e){
                                            e.stopPropagation();
                                        var gtbtn = e.currentTarget
                                        _.Engine.Proccessor.Modules['aim-wizard'].Run(gtbtn);

                                        });
                                    }
                                }*/

                                //2. Initialize any other aim-object in it
                               // _.Engine.Proccessor.Init(allWizardPages[wp]);

                                //3. Set the initialized flag
                                _.Attribute(allWizardPages[wp],"aim-object-init","true");
                            }


                        }
                        //if no first page manually set use the first loop page found
                        if(proc.Param[ielem.ID].CurrentPage.Trim() == ""){
                            //_.Log('No First page set manually'); 
                            allWizardPages[0].Show();
                            proc.Param[ielem.ID].CurrentPage = proc.Param[ielem.ID].FirstPage = allWizardPages[0].ID;
                            //_.Log('First and Current Page = '+allWizardPages[0].ID);
                        }
                        //set the total number of pages found
                        proc.Param[ielem.ID].TotalPages = allWizardPages.length;
                        //_.Log("Total Pages = "+proc.Param[ielem.ID].TotalPages);
                    }
                }
            }

                _.Engine.Proccessor.Finish();
            },
            Run:function(ielem){
                var iproc = _.Engine.Proccessor;
                var proc = iproc.Modules['aim-wizard'];
                var nielem = null;
                var nextpgID = "";
                //if invalid wizard run object sent return
                //accepted object are aim-wizard object or aim-wizard-goto object (which must be inside aim-wizard-page)
                if(!ielem.InClass('aim-wizard-goto') && !ielem.InClass('aim-wizard')){
                  return;
                }
                //if a goto button
                if(ielem.InClass('aim-wizard-goto')){
                    nielem = ielem;
                    ielem = _(_.Attribute(nielem,'aim-target-wizard'));
                    nextpgID = iproc.GetAttr(_.Attribute(nielem,'aim-wizard-page') || "");
                }
                
                
                //_.Log(ielem.ID + ":"+proc.Param[ielem.ID].CurrentPage);
                  //get the current displayed wizard page
                var currentPage = _(proc.Param[ielem.ID].CurrentPage);
               
               // _.Log("Current: "+currentPage.ID)
                //get the attributes
                //check if last page, next page must be first page
                if(nextpgID == ""){
                if(currentPage.InClass('aim-wizard-last')){
                    nextpgID= proc.Param[ielem.ID].FirstPage;
                }else{
                     nextpgID = iproc.GetAttr(_.Attribute(currentPage,'aim-wizard-next') || "");
                     //_.Log(_.Attribute(currentPage,'aim-wizard-next'));
                     if(nextpgID == ""){ //if no next page set
                        //get the next sibling element
                        //#Limitation #Wizard
                        //Using the next elemnt siblings to get the next element if not set is not getting the write one when page reloads
                        nextpgID =  currentPage.nextElementSibling != null?currentPage.nextElementSibling.ID:proc.Param[ielem.ID].FirstPage
                     }
                }
            }
               
                //if the next element is the first page(meaning wizard is restarting)
                if(nextpgID == proc.Param[ielem.ID].FirstPage){
                    //clear all field element in the wizard
                }
               
                //the next page
                var nextpgObj = _(nextpgID);
                
                //get all the wizard pages and hide them
                var allwizardPages = _("#"+ielem.ID+ " .aim-wizard-page");
                
                if(_.IsFound(allwizardPages))allwizardPages.Hide();
               
                //perform a trigger operation on the page (incase any aim action is assign to it)
                _.Engine.Proccessor.Run(nextpgObj);
                
                //display it
                nextpgObj.Show();
                
                proc.Param[ielem.ID].CurrentPage = nextpgID;//reset the current page
                

                
            }
        },

        //Aim #Toggler
        'aim-toggler':{
            Param:{SysObj:function(targ){
                if(targ.Trim() == "aim-alert"){
                    var popind = _('aim-alert-ind');
                    if(_.IsFound(popind)){
                     return popind.nextElementSibling.ID;
                    }
                }
                return targ;
            },
            //function to get special aim keyword
            Special:function(name,elem){
                
              if(typeof name == _.UND || name.Trim() == "")return [];
               if(name.Trim() == "aim-body")return document.body;
               if(typeof elem == _.UND)return _(name);
               elem = _.Engine.RP(elem);
               if(!_.IsFound(elem))return _(name);
               if(name.Trim() == "aim-this")return elem;
              var nname = name.Trim();
               if(nname.substr(0,10) == "aim-parent"){
                   //break down parents
                   var parentsarr = nname.split("-");
                   var rtnparent = elem;
                   for(var pp=1;pp<parentsarr.length;pp++){
                    var pr = parentsarr[pp];
                    if(pr.Trim() == "parent"){
                        rtnparent = rtnparent.parentElement;
                    }else{
                        return _(name);
                    }
                   }
                   return rtnparent;
               }
               if(name.Trim() == "aim-next-sibling")return elem.nextElementSibling;
               if(name.Trim() == "aim-previous-sibling")return elem.previousElementSibling;
               //alert(name + ": "+JSON.stringify(_(name)));
               return _(name);
            },
            Handler:function(relem){
                //if(e.target !== e.currentTarget) return false;
               // _.Log('Clicked');
                //var relem = e.currentTarget; //get the toggler element
                //get the set parameters
                 var objparam = _.Engine.Proccessor.Modules['aim-toggler'].Param;
                var params = objparam[relem.ID];
              
                //get the target object
                params.Target = params.Target.Trim() == "" && params.Hides.Trim() == "" && params.Shows.Trim() == "" && params.Remove.Trim() == "" && params.Insert.Trim() == ""?relem.ID:params.Target;
                var elemtarget = objparam.Special(params.Target.Trim(),relem);
                //elemtarget = elemtarget != null?elemtarget:params.Target.Trim() == ""?[]:_(params.Target);
                if(!_.IsFound(elemtarget)){ //if target not found
                    //try get as an alert indicator
                   var elemtargetalert = _('aim-alert-ind-'+params.Target.Trim());
                   //_.Log('aim-alert-ind-'+params.Target.Trim());
                   //if found set the alert element
                   if(_.IsFound(elemtargetalert))elemtarget = elemtargetalert.nextElementSibling;
                }

                if(_.IsFound(elemtarget)){
                    //_.Log(elemtarget)
                    elemtarget = _.IsArray(elemtarget)?elemtarget:[elemtarget];
                    //loop through the found target objects
                    for(var tg=0;tg<elemtarget.length;tg++){
                        if(params.Class.Trim() == ""){ //if no toggle class set, toggle the show/hide of the element
                            elemtarget[tg].ToggleShow();
                        }else{
                            //check for special classes
                            if(params.Class.Trim() == "aim-fullscreen-mode"){
                              _.Screen.ToggleFullMode();
                            }else{
                               // _.Log(params.ClassAlt);
                             if(params.ClassAlt.Trim() != ""){ //if alternate class exist (i.e replace the alternate class with the toggle class)
                                //1. get the data using the aim-datafill GetData function
                            // var proData = _.Engine.Proccessor.Modules['aim-datafill'].Param.GetData(params.ClassAlt);
                             
                           
                                 //remove all altclass
                               var altclassarr = params.ClassAlt.split(" ").Exact();
                                for(var sss=0;sss<altclassarr.length;sss++){
                                    var acl = altclassarr[sss];
                                    
                                 if(acl.Trim() != ""){elemtarget[tg].classList.remove(acl);}
                                }
                            
                               

                             }
                                 //if class set toggle the class name
                            var classarr = params.Class.split(" ").Exact();
                            for(var sss=0;sss<classarr.length;sss++){
                                var cl = classarr[sss];
                                if(params.ClassAlt.Trim() != ""){ //if altnate class set add the new class
                                    elemtarget[tg].classList.add(cl);
                                }else{
                                elemtarget[tg].classList.toggle(cl);
                                }
                            }
                             
                            
                            
                            }
                        }
                    }
                }

                //handle hides and show operation
                //alert(params.Hides);
                
                var hides = params.Hides.Trim() == ""?[]:objparam.Special(params.Hides,relem);
                //alert(hides);
                var shows = params.Shows.Trim() == ""?[]:objparam.Special(params.Shows,relem);
                var remove = params.Remove.Trim() == ""?[]:objparam.Special(params.Remove,relem);
                var insert = params.Insert.Trim() == ""?[]:objparam.Special(params.Insert,relem);
                if(!_.IsFound(hides)){
                    var hidesalertind = _("aim-alert-ind-"+params.Hides);
                    if(_.IsFound(hidesalertind))hides = hidesalertind.nextElementSibling;
                }
               
                if(!_.IsFound(shows)){
                    var showsalertind = _("aim-alert-ind-"+params.Shows);
                    if(_.IsFound(showsalertind))shows = showsalertind.nextElementSibling;
                }


                if(_.IsFound(hides))hides.Hide();
                
                if(_.IsFound(shows))shows.Show();
                //alert(params.Remove);
                if(_.IsFound(remove))remove.parentElement.removeChild(remove);

                if(_.IsFound(insert)){
                    
                    insert = _.IsArray(insert)?insert[insert.length - 1]:insert;
                    //get a copy(clone) of the insert element
                    cloneinsert = insert.Cloner(true);
                    cloneinsert.classList.add('error-input');
                    var nelem = insert.parentElement.insertAdjacentElement("beforeend",cloneinsert);
                    //clear the id of every aim object in new element
                    for (var modulname in _.Engine.Proccessor.Modules) {
                        if (_.Engine.Proccessor.Modules.hasOwnProperty(modulname)) {
                            var getobj = nelem._(modulname);
                            if(_.IsFound(getobj)){//if the item is found
                                getobj = _.IsArray(getobj)?getobj:[getobj];
                                getobj.Each(function(eobj){
                                    eobj.id="";
                                });
                            }
                        }
                    }
                    _.Engine.Proccessor.Init(nelem);
                
                }
               
            }},
            Init:function(ielem){
                //get the target and class
                
                var proc = _.Engine.Proccessor;
                var mParam = proc.Modules['aim-toggler'].Param;
                if(typeof mParam[ielem.ID] == _.UND){
                    mParam[ielem.ID] = {
                        Target:proc.GetAttr(_.Attribute(ielem,'aim-toggler-target') || ""),
                        Class:proc.GetAttr(_.Attribute(ielem,'aim-toggler-class') || ""),
                        ClassAlt:proc.GetAttr(_.Attribute(ielem,'aim-toggler-altclass') || ""),
                        Hides:proc.GetAttr(_.Attribute(ielem,'aim-toggler-hide') || ""),
                        Shows:proc.GetAttr(_.Attribute(ielem,'aim-toggler-show') || ""),
                        Remove:proc.GetAttr(_.Attribute(ielem,'aim-toggler-remove') || ""),
                        Insert:proc.GetAttr(_.Attribute(ielem,'aim-toggler-insert') || "")
                    }
                    var hidesInit = mParam[ielem.ID].Hides.Trim() == ""?[]:_(mParam[ielem.ID].Hides);
                    if(_.IsFound(hidesInit))hidesInit.Hide();
                }
               var ev = "click";
               var tagname = ielem.tagName.toLowerCase();
               //check for checkbox select or radio
              //_.Log(ielem.tagName);
               if(tagname == "select" || (tagname == "input" && (ielem.type == "checkbox" || ielem.type == "radio"))){
                   ev = "change";
               }

                //asign the onclick handler to the object
               // ielem.Assign(ev,mParam.Handler);
                _.Engine.Proccessor.Finish();
            },
            Run:function(ielem){
                //_.Log('Run Toggler');
                var mParam = _.Engine.Proccessor.Modules['aim-toggler'].Param;
                mParam.Handler(ielem);
                //ielem.click();
            }
        },

        //Aim #Trigger
        'aim-trigger':{
            Param:{Handler:function(e){
                //_.Log("Trigger Run: "+e.currentTarget.ID);
               _.Engine.Proccessor.Modules['aim-trigger'].Run(e.currentTarget);
               e.preventDefault();
            }},
            Init:function(ielem){
                var proc = _.Engine.Proccessor;
                var param = proc.Modules['aim-trigger'];
                param[ielem.ID] = typeof param[ielem.ID] == _.UND?{}:param[ielem.ID]
                param[ielem.ID].Target = proc.GetAttr(_.Attribute(ielem,"aim-trigger-target") || ielem.ID);
                param[ielem.ID].Data = proc.GetAttr(_.Attribute(ielem,"aim-trigger-data") || "");
                param[ielem.ID].Action = proc.GetAttr(_.Attribute(ielem,"aim-trigger-action") || "");
                var events = proc.GetAttr(_.Attribute(ielem,"aim-trigger-event") || "");
                
                    var tagname = ielem.tagName.toLowerCase();
                    
                    if(_.Trim(events) == ""){
                        events = "click"
                        if(tagname == "select" || (tagname == "input" && (ielem.type == "checkbox" || ielem.type == "radio"))){
                        events = "change";
                        }else if((tagname == "input" && (ielem.type == "text" || ielem.type == "password" || ielem.type == "")) || tagname == "textarea" || (tagname == "div" && ielem.contentEditable == 'true')){
                            
                            events = "input";
                        }
                    }
                    
                    //alert(ielem.id);
                    //_.Log("Trigger Init: "+ielem.ID);
                    _.Assign(events,ielem,proc.Modules['aim-trigger'].Param.Handler);
                    proc.Finish();
                
            },
            Run:function(ielem){
                
                var proc = _.Engine.Proccessor;
                var param = proc.Modules['aim-trigger'];
                var target = param[ielem.ID].Target;
                var overwrite = param[ielem.ID].Data;
                var taction = param[ielem.ID].Action.Trim();
                //get the trigger targets if multiple target
                var targetarr = target.split(",");
                //alert('Triggered');
                for(var df=0;df<targetarr.length;df++){
                    target = targetarr[df];
                if(_.Trim(target) != ""){
                    if(overwrite != ""){ //if trigger data is to be send
                      var triggerdata = ielem.Value
                      triggerdata = triggerdata == ""?ielem.Text:triggerdata;
                      if(typeof proc.Memory[target] == _.UND)proc.Memory[target] = {};
                      proc.Memory[target][overwrite] = triggerdata;
                      //_.Log(JSON.stringify(target));
                      //@@@@@stop here trigger data not gotten in datafill run module@@@@@
                    }
                   // alert(_.IsFound(_(target)));
                   //_.Log(target);
                  var targobj = _(target);
                  if(_.IsFound(targobj)){
                     targobj = _.IsArray(targobj)?targobj:[targobj]
                     for(var s=0;s<targobj.length;s++){
                        _.Attribute(targobj[s],'aim-trigger-id',ielem.ID);
                        //check if target is an aim object
                        if(typeof proc.Objects[targobj[s].ID] != _.UND){
                            if(taction != "" && taction != "aim-click"){ //check if trigger is set to trigger a particular aim object
                             proc.Run(targobj[s],taction);
                            }else{ //trigger all aim object assign to it
                              proc.Run(targobj[s]);  
                            }
                            if(taction == "aim-click"){ //if click action is set
                                targobj[s].click();
                            }
                           
                        }else{
                           //just click the object
                           targobj[s].click();
                        }
                        
                     }
                     
                  }
                  
                }
            }
            }
        },

        //Aim Databind
        //#aim-databind
        'aim-databind':{
           Param:{
            Operation:function(exp,operator){
                // Get the operator (+,-,/,*) default = -
                operator = typeof operator == _.UND?"-":operator;
               
                exp = _.Engine.Proccessor.Modules['aim-databind'].Param.ProccessBracket(exp);
               // _.Log("proccessed: "+exp)
                var exparr = exp.split(operator);
                var nextop = (operator == "-")?"+":(operator == "+")?"*":(operator == "*")?"/":"";
               // _.Log("Operator:"+operator+" ; Next:"+nextop);
                var rstmin = null;
                for(var min=0;min<exparr.length;min++){
                    var minstr = exparr[min].Trim();
                    if(minstr == "")minstr = "0";
                    if(nextop != ""){ //if next operator still exist
                       var pluscalc = _.Engine.Proccessor.Modules['aim-databind'].Param.Operation(minstr,nextop);
                      // _.Log("Operator:"+operator+" ; Value:"+pluscalc);
                    }else{ //if no more operator
                        var pluscalc = 0;
                     //try convert to number
                     var strconvert = parseFloat(minstr.Replace(",",""));
                     if(isNaN(strconvert)){//if is not a number
                        var escapearr = ["##@@$!","@@##%","$$%%@","%%@@#","!!##%"];//-,+,*,/
                       var ops = ["-","+","*","/","?"];
                       for(var es=0;es<ops.length;es++){
                        minstr = minstr.Replace(escapearr[es],ops[es]);
                       }
                       //_.Log(minstr);
                       //try to use aim finder to get elemnt
                       var oprelement = _(minstr);
                       if(_.IsFound(oprelement)){
                           if(!_.IsArray(oprelement)){
                              // return the value of the element (Numeric value)
                             pluscalc = oprelement.Value.Replace(",","").ToNumber();
                           }else{
                               for(var s=0;s<oprelement.length;s++){
                                   pluscalc += oprelement[s].Value.Replace(",","").ToNumber();
                               }
                           }
                       }
                     }else{
                        pluscalc = strconvert;  
                     }
                    }
                    
                    rstmin = rstmin == null?pluscalc:(operator == "-")?rstmin-pluscalc:(operator == "+")?rstmin+pluscalc:(operator == "*")?rstmin*pluscalc:rstmin/pluscalc;
                }
                return rstmin == null?0:rstmin;
            },
            ProccessBracket:function(formular){
                 var end=false;
                while(end == false){
                    var openseen = 0;
                var closeseen = 0; var firstopenind = null; var lastcloseind = null;
                end = true;
                for(var bs=0;bs<formular.length;bs++){
                    var xchar = formular.charAt(bs);
                    if(xchar == "("){
                        if(firstopenind == null)firstopenind=bs;
                        openseen++;
                    }else if(xchar == ")"){
                        lastcloseind = bs;
                        closeseen++;
                        if(openseen == closeseen){ //if the clossing braket found
                            //get the barcket formular
                            var brformular = formular.substr(firstopenind + 1,lastcloseind - firstopenind - 1);
                            
                            if(brformular.Trim() == ""){
                                formular = formular.Replace("("+brformular+")","0"); 
                            }else{
                                //perform calculations on it
                                var calcrst = _.Engine.Proccessor.Modules['aim-databind'].Param.Operation(brformular);
                                formular = formular.Replace("("+brformular+")",calcrst.toString());
                                
                            }
                            end = false;
                            break;
                        }
                    }
                }

            }
            return formular;
            },
            Bind:function(e){
            var sercelem = e.currentTarget;
            
            //get the owners id
            var ownerID = _.Attribute(sercelem,'aim-databind-owner') || "";
            if(ownerID.Trim() != ""){
                //get the data type
                var dtype = _.Engine.Proccessor.Modules['aim-databind'].Param[ownerID].Type;
                var stagn = sercelem.tagName.toLowerCase();
                    var stype = sercelem.type || "";
                    stype = stype.toLowerCase();
                   //if text value is to binded
                   //if(dtype == "text"){
                       var mParam = _.Engine.Proccessor.Modules['aim-databind'].Param;
                       var $tosetval;
                       
                       //check if src is input (radio or check - bolean data)
                       if(stagn == "input" && (stype == "radio" || stype == "checkbox")){
                        $tosetval = sercelem.checked;
                       }else if(stagn == "img" || (stype == "image" && stagn == "input")){
                        $tosetval = sercelem.src; 
                       }else if(stagn == "input" || stagn == "textarea"  || stagn == "select"){
                        $tosetval = dtype == "text"?sercelem.Text:sercelem.Value;
                        if(mParam[ownerID].Format.toLowerCase() == "currency"){
                           // _.Log('djd')
                            //sercelem.Value = sercelem.Value.Replace(",","");
                            
                        }
                        //sercelem.focus();
                       }else{
                        //_.Log('djd')
                           $tosetval = sercelem.innerHTML;
                           //if(mParam[ownerID].Format.toLowerCase() == "currency")sercelem.Value = sercelem.Value.Replace(",","");
                        //sercelem.focus();
                       }
            
                    
                       for(var fm=0;fm<mParam[ownerID].TargetFormular.length;fm++){
                           var TargetFormular = mParam[ownerID].TargetFormular[fm];
                       
                    //check if formular is set
                    if(TargetFormular.Formular.Trim() != ""){
                        //_.Log("Formular = "+TargetFormular.Formular);
                       //insert the src val
                       var formproc = TargetFormular.Formular.Trim();
                       
                       var escapearr = ["##@@$!","@@##%","$$%%@","%%@@#","!!##%"];//-,+,*,/
                       var ops = ["-","+","*","/","?"];
                       for(var es=0;es<ops.length;es++){
                        formproc = formproc.Replace("\\"+ops[es],escapearr[es]);  
                       }
                      // _.Log("Formular = "+formproc);
                        formproc = formproc.Replace("?",$tosetval.toString());
                        
                        $tosetval = mParam.Operation(formproc);
                    }
                //get the target element
                //mParam[ielem.ID].Target = _(mParam[ielem.ID].Target);
                var DTarget = TargetFormular.Target;
               // var DTarget = _.Engine.Proccessor.Modules['aim-databind'].Param[ownerID].Target,td;
               //_.Log("Formular New = "+$tosetval);
                //set the target
                for(td=0;td<DTarget.length;td++){
                    var targetElem = DTarget[td];
                    var ttagn=targetElem.tagName.toLowerCase(),ttype = targetElem.type || "";
                    ttype = ttype.toLowerCase();
               if(mParam[ownerID].Format.toLowerCase() == "currency"){
                   $curr = sercelem.ID != targetElem.ID;
                  // _.Log($tosetval);
                   $tosetval = $tosetval.ToMoney($curr);
               }
                       //set the target
                       if(ttagn == "input" && (ttype == "radio" || ttype == "checkbox")){
                        targetElem.checked = Boolean($tosetval);
                       }else if(ttagn == "img" || (ttype == "image" && ttagn == "input")){
                        targetElem.src = $tosetval; 
                       }else if(ttagn == "input" || ttagn == "textarea"  || ttagn == "select"){
                        if(dtype == "text"){
                            targetElem.Text = $tosetval;
                        }else{
                            targetElem.Value = $tosetval;
                        }  
                       }else{
                        targetElem.innerHTML = $tosetval
                        //initialize all element of the container
                        _.Engine.Proccessor.Init(targetElem);
                       }
                }
            }
            }
           }},
           Init:function(ielem){
              // alert('dbb');
             
               //Get the target elem
               var proc = _.Engine.Proccessor;
               var mParam = proc.Modules['aim-databind'].Param;
               //if(typeof mParam[ielem.ID] == _.UND){
                   mParam[ielem.ID] = {
                       Target:proc.GetAttr(_.Attribute(ielem,'aim-databind-target') || ""),
                       Format:proc.GetAttr(_.Attribute(ielem,'aim-databind-format') || ""),
                       Src:proc.GetAttr(_.Attribute(ielem,'aim-databind-src') || ""),
                       Type:proc.GetAttr(_.Attribute(ielem,'aim-databind-type') || "text"),
                       Direction:proc.GetAttr(_.Attribute(ielem,'aim-databind-direction') || "simplex"),
                       TargetFormular:[]
                   }

                   //_.Log('init: '+mParam[ielem.ID].Target);
                  
                   if(mParam[ielem.ID].Target.Trim() == "")return; //return if no target set
                   //break if multiple target/formular set
                   var multipleTargetF = mParam[ielem.ID].Target.split(";");
                 for(var mf=0;mf<multipleTargetF.length;mf++){
                     var targfstr = multipleTargetF[mf];
                    //split to seperate target from formular
                var targetformular = targfstr.split("=");
                var mtarget = targetformular[0].Trim();
                var mformular = typeof targetformular[1] != _.UND?targetformular[1].Trim():"";
                //Get the Target Elements and update in param, so as to make it available in Bind method(optimize, did not need to do the getting again)
                     //make it one type (array type)
                var DTarget = _(mtarget);
                   if(!_.IsFound(DTarget))continue; //if not found return;
                   DTarget = _.IsArray(DTarget)?DTarget:[DTarget];
                   mParam[ielem.ID].TargetFormular.push({"Target":DTarget,"Formular":mformular});
                  // mParam[ielem.ID].Formular = mformular;
                 }
                 
                     
                
                   //Get the Src element, if not set use the current element
                   var SrcElement = mParam[ielem.ID].Src.Trim() != ""?_(mParam[ielem.ID].Src):ielem;
                   SrcElement = _.IsFound(SrcElement)?_.IsArray(SrcElement)?SrcElement:[SrcElement]:ielem;
                   //loop through all the current element 
                   var g;
                    for(g=0;g<SrcElement.length;g++){
                        if(SrcElement[g] == mParam[ielem.ID].Target)continue; //if src is target return
                        //set the owner id to it
                        _.Attribute(SrcElement[g],"aim-databind-owner",ielem.ID);
                        var tagn = SrcElement[g].tagName.toLowerCase();
                        var type = SrcElement[g].type || "";
                        //ielem.Assign('DOMChange', _.Engine.Proccessor.Modules['aim-databind'].Param.Bind);
                        //the onchange element
                        var tevent = "";
                        //assign the Bind operation
                        if((tagn == "input" && (type == "radio" || type == "checkbox" || type == "file")) || tagn == "select"){
                           tevent = "change";
                        }else if((tagn == "input" && type =="image") || tagn == "img"){
                            tevent = "load";
                        }else if(tagn == "input" || tagn == "textarea" || (typeof SrcElement[g].contentEditable != _.UND && SrcElement[g].contentEditable.toString() == "true")){
                            tevent = "input";
                        }else{
                            tevent = "DOMChange";
                        }
                        
                        //_.Log(JSON.stringify(tevent));
                        SrcElement[g].Assign(tevent, _.Engine.Proccessor.Modules['aim-databind'].Param.Bind);
                    }

                _.Engine.Proccessor.Finish();
               },
               Run:function(ielem){

               }
           
        },

        

        //Aim File picker object
        //#aim-filepicker
        'aim-filepicker':{
           Param:{Reset:function(ielem,init){
               init = init || false;
            var proc = _.Engine.Proccessor;param = proc.Modules['aim-filepicker'].Param;
            if(param[ielem.ID]['Default'].Trim() != ""){
                targetobj = param[ielem.ID]['TargetObject'];
                for(var d=0;d<targetobj.length;d++){
                    if(targetobj[d].tagName.toLowerCase() == 'img'){
                        param[ielem.ID]['ForceToFalse'] = true; //make sure that the filepicker object laod status is not set to true, cos the image loaded is the default
                        if(init){ //if aready set dont set durring init
                            varsplit = targetobj[d].src .UrlSplit();
                              var ext = _.Trim(varsplit.Ext.toLowerCase()) //get file extention
                             // if(ext != "" && ['jpg','jpeg','png','gif','bmp'].IndexOf(ext) > -1){ //if image file
                            if(typeof targetobj[d].src == _.UND || targetobj[d].src.Trim() == "" || ext == "" || ['jpg','jpeg','png','gif','bmp'].IndexOf(ext) == -1){
                                targetobj[d].src = param[ielem.ID]['Default'];
                            }
                        }else{
                       // if(typeof targetobj[d].src == _.UND || targetobj[d].src.Trim() == "" ){
                         targetobj[d].src = param[ielem.ID]['Default'];
                        }
                       // }
                    }else{
                        //alert(targetobj[d].Value);
                        if(!init || (targetobj[d].Value.Trim() == "" && targetobj[d].innerHTML.Trim() == "")){
                            targetobj[d].Value = param[ielem.ID]['Default'];
                        }
                        
                      
                    }
                }
            }else{
               // _.Attribute(ielem,'aim-filepicker-loaded',"false");
            }
            _.Attribute(ielem,'aim-filepicker-loaded',"false"); //hold the state of the file picker if loaded or not (default:false)
           },SetTarget:function(ielem,val){
            val= val || "";
            var proc = _.Engine.Proccessor;
            var param = proc.Modules['aim-filepicker'].Param;
            if(val.Trim() != ""){
                targetobj = param[ielem.ID]['TargetObject'];
                for(var d=0;d<targetobj.length;d++){
                    if(targetobj[d].tagName.toLowerCase() == 'img'){
                       // param[ielem.ID]['ForceToFalse'] = true; //make sure that the filepicker object laod status is not set to true, cos the image loaded is the default
                        targetobj[d].src = val;
                    }else{
                        //check if multiple allowed
                        if(param[ielem.ID]['Multiple']){
                           //brack down data (seperated with semi-colum)- limitation not a good standard cos some data coul contain semicolmn *** Work on a better approach ****
                           var valarr = val.split(";");
                           targetobj[d].innerHTML = "";
                           for(var df=0;df<valarr.length;df++){
                               //get type
                               valpart = valarr[df];
                               if(valpart.Trim() == "")continue;
                               varsplit = valpart.UrlSplit();
                              var ext = _.Trim(varsplit.Ext.toLowerCase()) //get file extention
                              if(ext != "" && ['jpg','jpeg','png','gif','bmp'].IndexOf(ext) > -1){ //if image file
                                var wraper = '<img  src="'+valpart+'" alt="Loading.."/>';
                              }else if(ext != ""){ //if other file type but not image
                                var wraper = '<object data="'+valpart+'" alt="Loading.." standby="Loading.." />';
                              }else{
                                var wraper = '<p>'+valpart+'</p>';
                              }
                              targetobj[d].insertAdjacentHTML("beforeend",wraper);
                           }
                        }else{
                        targetobj[d].Value = val;
                        }
                      
                    }
                }
            }else{
               // _.Attribute(ielem,'aim-filepicker-loaded',"false");
            }
           // _.Attribute(ielem,'aim-filepicker-loaded',"false"); //hold the state of the file picker if loaded or not (default:false)
           }},
           Init:function(ielem){
            var proc = _.Engine.Proccessor;param = proc.Modules['aim-filepicker'].Param;
           // var rtnobj = {};
            //Get the target element
            var targetID  =proc.GetAttr(_.Attribute(ielem,'aim-filepicker-target') || "");
            var targetobj = targetID != ""?_(targetID):ielem;targetobj = _.IsFound(targetobj)?_.IsArray(targetobj)?targetobj:[targetobj]:ielem;
            if(typeof param[ielem.ID] == _.UND)param[ielem.ID] = {};
            param[ielem.ID]['FileID'] =  ielem.ID + "_file";
             //get the type of file that will be accept
             param[ielem.ID]['Accept']  =proc.GetAttr(_.Attribute(ielem,'aim-filepicker-accept') || "");
             param[ielem.ID]['MaxSize'] = proc.GetAttr(_.Attribute(ielem,'aim-filepicker-max') || 0).ToNumber();
             param[ielem.ID]['MinSize']= proc.GetAttr(_.Attribute(ielem,'aim-filepicker-min') || 0).ToNumber();
             param[ielem.ID]['Multiple'] = targetobj.length > 1?true:Boolean(proc.GetAttr(_.Attribute(ielem,'aim-filepicker-multiple') || false));
             param[ielem.ID]['Default']  =proc.GetAttr(_.Attribute(ielem,'aim-filepicker-default') || "");
             param[ielem.ID]['ReadType'] = proc.GetAttr(_.Attribute(ielem,'aim-filepicker-readtype') || "FileName");
             
             

            if(targetobj.length == 1 && targetobj[0].tagName.toLowerCase() == 'img'){
             param[ielem.ID]['ReadType'] = 'DataURL'; 
            }
            
            param[ielem.ID]['TargetObject'] = targetobj;

            param[ielem.ID]['ForceToFalse'] = false;
            
                //if default set
                param.Reset(ielem,true);
            
            
            param[ielem.ID]['OnStart'] = function(nparam){
                param[ielem.ID]['ForceToFalse'] = false;
                /*if(nparam.Index == 0){ //if the first file item
                    var proc = _.Engine.Proccessor;param = proc.Modules['aim-filepicker'].Param;
                        var fileobjid = nparam.File.ID.TrimRight("_file");
                        //alert();
                        //Get the object(filepicker)
                        var fileowner = _(fileobjid);
                        if(_.IsFound(fileowner)){
                        // param[ielem.ID]['TargetObject']
                        //if allow multiple file and to be loaded into one block object (clear it first)
                            if(param[fileobjid]['Multiple'] && param[fileobjid].TargetObject.length == 1 && typeof param[fileobjid].TargetObject[0].innerHTML != _.UND){ //if to browse into
                                param[fileobjid].TargetObject[0].innerHTML = "";
                            }
                            //set state to true
                        var targetelemID =_.Attribute(fileowner,'aim-filepicker-target');

                        }
                }*/
                
            }
            param[ielem.ID]['OnLoad'] = function(nparam){
                var proc = _.Engine.Proccessor;param = proc.Modules['aim-filepicker'].Param;
                var fileobjid = nparam.File.ID.TrimRight("_file");
                //Get the object(filepicker)
                var fileowner = _(fileobjid);
                if(_.IsFound(fileowner)){
                   // _.Log("Default:"+param[fileobjid].Default + " : Src"+ nparam.Element.src);
                    //set state to true
                   if(param[fileobjid]['ForceToFalse'] == false) { //if not default loaded set the status to true
                       _.Attribute(fileowner,'aim-filepicker-loaded',"true");
                   }else{ //if status is to be forsed to false i.e it is the defualt loaded
                  //  _.Attribute(nparam.Element,'aim-filepicker-defaultset','false');
                    _.Attribute(ielem,'aim-filepicker-loaded',"false");
                   // param[ielem.ID]['fileobjid'] = true; //reset back to true
                   }
                }
            }
            param[ielem.ID]['OnError'] = function(nparam){
                var fileobjid = nparam.File.ID.TrimRight("_file");
                //remove the placeholder if multiple file to be loaded
                var curobj = _(nparam.File.ID+nparam.Index); //get the current file placeholder
                if(_.IsFound(curobj)){
                    curobj = _.IsArray(curobj)?curobj:[curobj];
                    curobj.Each(function(plobj){
                        plobj.parentElement.removeChild(plobj);
                    });
                }
                //Get the object(filepicker)
                var fileowner = _(fileobjid);
                if(_.IsFound(fileowner)){
                    //turn to array
                    fileowner = _.IsArray(fileowner)?fileowner:[fileowner]
                    fileowner.Each(function(fo){
                        fo.classList.add("error-input");
                        fo.ReplaceWith(fo.Cloner(true));
                       // _.Engine.Proccessor.Modules['aim-filepicker'].Reset(fo,true);
                    })
                }
                _.Alert(nparam.Error);
            }
            _.Engine.Proccessor.Finish();
           },
           Run:function(ielem){
            var proc = _.Engine.Proccessor;param = proc.Modules['aim-filepicker'].Param;
              if(typeof param[ielem.ID] != _.UND){
                  var multiple = param[ielem.ID]['Multiple'];
                 // alert(JSON.stringify(param[ielem.ID]));
                  if(multiple && param[ielem.ID].TargetObject.length == 1 && typeof param[ielem.ID].TargetObject[0].innerHTML != _.UND){
                    param[ielem.ID].TargetObject.BrowseInto(param[ielem.ID]);
                  }else{
                    param[ielem.ID].TargetObject.Browse(param[ielem.ID]);  
                  }
                
              }
               
               

           }
        },

        //#aim-input-reset
        'aim-input-reset':{
            Param:{},
            Init:function(ielem){
                var resetid = "aim-input-reset-"+ielem.ID;
                var resetobj = _(resetid);
                if(!_.IsFound(resetobj)){
                    //1. Create an hidden reset input element
                 var resetinput = document.createElement("input");
                resetinput.id = "aim-input-reset-"+ielem.ID;
                 resetinput.type = "reset";
                 resetinput.style.display = "none";
                 //2. Inser it imediately after the ielem
                 ielem.insertAdjacentElement('afterend',resetinput);
                }
                 
                _.Engine.Proccessor.Finish();
            },
            Run:function(ielem){
              //Get the created inputelement
              var resetobj = _("aim-input-reset-"+ielem.ID);
              if(_.IsFound(resetobj))resetobj.click();

              //reset all filepicker object
              //get the parent form
              var pform = resetobj.form || resetobj.parentElement;
              
              var filepickers = pform._('aim-filepicker');
              
              if(_.IsFound(filepickers)){
                  filepickers = _.IsArray(filepickers)?filepickers:[filepickers];
                  filepickers.forEach(function(filpick){
                     // alert(filpick);
                    _.Engine.Proccessor.Modules['aim-filepicker'].Param.Reset(filpick);
                  })
              }

            }
        },
        //#aim-input
        'aim-input':{
            Param:{},
            Init:function(ielem){
                var proc = _.Engine.Proccessor;
              proc.Modules['aim-input'].Param[ielem.ID] = {
                Type:proc.GetAttr(_.Attribute(ielem,"aim-input-type") || "")
            }
            //alert(ielem.ID);
            ielem.Assign("blur",function(e){
             var elem = e.currentTarget;
             
             var etype = _.Engine.Proccessor.Modules['aim-input'].Param[elem.ID].Type;
             if(etype.Trim().toLowerCase() == "currency"){
                //alert(elem.ID);
                 curval = elem.Value.ToMoney(true);
                 elem.Value = curval;
             }
            })
                _.Engine.Proccessor.Finish();
            }
        },
        //#aim-slideshow #slideshow
        'aim-slideshow':{
            Param:{},
            Init:function(ielem){
                
              var proc = _.Engine.Proccessor;
              proc.Modules['aim-slideshow'].Param[ielem.ID] = {
                  Index:0,
                Duration:_.ToInteger(proc.GetAttr(_.Attribute(ielem,"aim-duration") || 1))*1000,
                Timmer:null
            }
            
            _.Engine.Proccessor.Finish();
            
            },
            Run:function(ielem){
                
               var param = _.Engine.Proccessor.Modules['aim-slideshow'].Param[ielem.ID];
               //if the slide timmer is still set, unset/clear it
               if(param.Timmer != null){
                clearTimeout(param.Timmer);
                param.Timmer = null;
              }

              //try it again after 100 milisec, if slideshow initialization is not complete
             //check if the slideshow object is also a datafill object and the datafill not complete
             
            if(!_.Engine.Proccessor.InitEnd || (ielem.InClass("aim-datafill") && _.Engine.Proccessor.Modules['aim-datafill'].Param[ielem.ID].Complete === false)){
                    param.Timmer = setTimeout("_.Engine.Proccessor.Modules['aim-slideshow'].Run(_('"+ielem.ID+"'))",100);
                    return;
            }
              var i;
              //get all slide element in the slideshow object
              var x = ielem._(".aim-slide");
              //var x = _("mySlides");
              //_.Log(x.length);
             if(!_.IsFound(x)){ //if none found
                return;
             }
             x = _.IsArray(x)?x:[x];
             var narr = [];
             //_.Log(x.length);
             for (i = 0; i < x.length; i++) {
                 if(typeof x[i] != _.UND && _.IsElement(x[i]) && !x[i].InClass("aim-template")){
                     
                    x[i].style.display = "none";
                    narr.push(x[i]);
                 }
                
                 
             }
            // _.Log(JSON.stringify(narr));
            // _.Log(x.length);
            // _.Log(param.Index);
              if (param.Index == narr.length) {param.Index = 0}    
              if (param.Index < 0) {param.Index = narr.length - 1}
             
              
              
              var dur = param.Duration;
              var cindex = param.Index;
              param.Index++;
              //_.Log(param.Index);
              if(typeof narr[cindex] != _.UND){
                //if(typeof x[param.Index] != _.UND && !x[param.Index].InClass("aim-tempmlate")){

                narr[cindex].style.display = "block";
                param.Timmer = setTimeout("_.Engine.Proccessor.Modules['aim-slideshow'].Run(_('"+ielem.ID+"'))",dur);              
              }else{
                //_.Engine.Proccessor.Modules['aim-slideshow'].Run(ielem);
              }
              
            }
        },
        //#aim-focus - cause the element to recieve focus
        "aim-focus":{
          Param:{},
          Init:function(ielem){
              if(_.IsElement(ielem)){
                  ielem.focus();
              }
              _.Engine.Proccessor.Finish();
          }
        },
        //#aim-localstore - use to store data in cookie and session, which will be available in code behiend
        "aim-localstore":{
           Param:{Virtual:{}},
           Init:function(ielem){
            _.Engine.Proccessor.Finish();
           },
           Run:function(ielem){
               //_.Log('Aim localstore run '+ ielem.ID);
              // return;
               //1. get the data using the aim-datafill GetData function
            var proData = _.Engine.Proccessor.Modules['aim-datafill'].Param.GetData(_.Attribute(ielem,"aim-localstore-data") || "");
            if(proData === false)return;
            
            //2. get the curent cookie info
            var localData = _.Cookie('aim-local-data');
            
            var localDataObj = {};
            if(localData.Trim() != ""){ //if local data exist
                //3. convert to object
                 localDataObj = JSON.parse(localData);
                if(localDataObj){
                    //4. merge the with the new proData
                    for (var key in proData) {
                        if (proData.hasOwnProperty(key)) {
                            localDataObj[key] = proData[key];
                            
                        }
                    }

                }else{
                    localDataObj = proData;
                }  
            }else{
                localDataObj = proData; 
            }
            
            //5. Turn object back to string
            localData = JSON.stringify(localDataObj);
            
            //6. Set Cookie back
            var data = _.Cookie('aim-local-data',localData,5*31*24*60*60*1000);//expires after 5 month
            
           }
        },

        //#calendar #aim-calendar #aim-datepicker #datepicker 
        "aim-calendar":{
           Param:{},
           Init:function(ielem){
               var iproc = _.Engine.Proccessor;
             var param = iproc.Modules['aim-datafill'].Param;
             param[ielem.ID] = {};
             param[ielem.ID].Target = iproc.GetAttr(_.Attribute(ielem,"aim-calendar-target") || ielem.ID);
             param[ielem.ID].Display = iproc.GetAttr(_.Attribute(ielem,"aim-calendar-container") || '');
             param[ielem.ID].Range = iproc.GetAttr(_.Attribute(ielem,"aim-calendar-range") || 'false').toLowerCase() == "true"?true:false;
             param[ielem.ID].BodyClass = iproc.GetAttr(_.Attribute(ielem,"aim-calendar-body-class") || 'calender-displaycont');
             param[ielem.ID].BodyStyle = iproc.GetAttr(_.Attribute(ielem,"aim-calendar-body-style") || '');
             param[ielem.ID].TableClass = iproc.GetAttr(_.Attribute(ielem,"aim-calendar-table-class") || 'tables');
             param[ielem.ID].InTransition = iproc.GetAttr(_.Attribute(ielem,"aim-calendar-in-class") || 'inanim');
             param[ielem.ID].OutTransition = iproc.GetAttr(_.Attribute(ielem,"aim-calendar-out-class") || 'outanim');
             param[ielem.ID].TodayClass = iproc.GetAttr(_.Attribute(ielem,"aim-calendar-today-class") || 'today');
             param[ielem.ID].SelectedClass = iproc.GetAttr(_.Attribute(ielem,"aim-calendar-selected-class") || 'selected');
             param[ielem.ID].Caption = iproc.GetAttr(_.Attribute(ielem,"aim-calendar-caption") || '');
             param[ielem.ID].SelectTo = _.Attribute(ielem,"aim-calendar-to") || '';
             //alert(param[ielem.ID].SelectTo);
           },
           Run:function(ielem){
               
            var iproc = _.Engine.Proccessor;
            var param = iproc.Modules['aim-datafill'].Param[ielem.ID];
            //create a new calendar object
            param['Calendar'] = new _.Engine.Calendar(param);
            param['Calendar'].Create();
           }
        },
        //#aim-autoload #autoload - must always be the last module - cos it depends on a complete initialization of some modules
        "aim-autoload":{
            Param:{},
            Init:function(ielem){
                var param = _.Engine.Proccessor.Modules['aim-autoload'].Param;
                if(typeof param[ielem.ID] == _.UND) param[ielem.ID] = {delayTimmer:null}
               // _.Log("Enter Auto Load");
               delay = _.ToInteger(_.Engine.Proccessor.GetAttr(_.Attribute(ielem,"aim-autoload-delay") || 0));
              // _.Log(ielem.ID + " : " +delay);
               if(delay > 0){
                   //if timmer is on clear it and create another
                   if(param[ielem.ID].delayTimmer != null){
                       clearTimeout(param[ielem.ID].delayTimmer);
                       param[ielem.ID].delayTimmer = null;
                   }
                   param[ielem.ID].delayTimmer = setTimeout("_.Engine.Proccessor.Run(_('"+ielem.ID+"'))",delay*1000);
               }else{
                  _.Engine.Proccessor.Run(ielem); 
               }
                
                
                _.Engine.Proccessor.Finish();
            },
            Run:function(ielem){
               // _.Log("Enter Auto Load");
            }
        }
      },
      InitEnd : false, //indicate if initialization has been completed or not
      InitCounter:0,//hold the total number of init module object that has finish execution, which will be use to confirm if all the init objecs has actually finish execution.
      //NB: in every init module fuction, the proccessor finish(_.Engine.Proccessor.Finish()) method must be called in order to inform proccessor of a complete proccess
      Objects:[],//holds array of all aim object on page, using the object id as key and array of the object modules as value
      InitObjects:[], //hold all the aim object to execute during page load
      //[{ObjectID:id,ModuleName:mname},....]
      //Method to register aim objects
      Register:function(cobj,modulename){
        
        var proc = _.Engine.Proccessor;
        var oid = cobj.ID;
        var news = true;
        //if already registered
        if(typeof proc.Objects[oid] != _.UND){
            if(proc.Objects[oid].Contains(modulename) === false){
                //add the modulename to its modulname array
               proc.Objects[oid].push(modulename);
           // proc.Objects[oid] = proc.Objects[oid].Exact();
            }else{
                news = false; 
            }
            
            
        }else{
            
            //if new, asign an array containig the modulname
            proc.Objects[oid] = [modulename];
           
        }
       

        //check if module has initialization
        if(typeof proc.Modules[modulename].Init != _.UND){
            //add to init objects
            proc.InitObjects.push({ObjectID:oid,ModuleName:modulename});
        }
        

        /*if(proc.InitModules.Contains(modulename) !== false){
            //add to initobject array
            
        }*/
        
        return news;
      },
      //function to run a module on an object
      Run:function(objid,modulename){
          
          var proc = _.Engine.Proccessor;
        var obj = _.Engine.RP(objid);
       
        //check if module is set
        if(typeof modulename != _.UND && _.IsString(modulename)){
            //run module
            if (typeof proc.Modules[modulename] != _.UND)proc.Modules[modulename].Run(obj);
        }else{ //if module name not sent
            //run all module registered for the object
            //get the object registration
            //alert(obj.ID);
            if(typeof proc.Objects[obj.ID] != _.UND){
                var objReg = proc.Objects[obj.ID];
               
                //loop through all modulenames and run the module
                for(var mn=0;mn<objReg.length;mn++){
                    var nmodulename = objReg[mn];
                    if(nmodulename == "aim-trigger")continue; //run not allowed for trigger-object, it migth cause infinite trigger
                    //if the run is initiated from trigger and the current modulename is toggler, trigger can/should not run toggler, cos toggler trigers it operation it self
                    if (typeof proc.Modules[nmodulename] != _.UND && _.IsFunction(proc.Modules[nmodulename].Run))proc.Modules[nmodulename].Run(obj);
                   
                }
            }
            
        }

      },
      //Initailize all aim object in the html document, by registerin all aim object on page and run all init modules
      Init:function(base){
         // _.Log("**Processor Init**");
          var proc = _.Engine.Proccessor;
          var baseType = typeof base;
          //if base not send (meaning it is the main aim initialization)
          if(baseType == _.UND){
              proc.State = "Start"; 
          }else{
            // _.Log(base.ID);
          }
          var LocalInitObj = []; //holds objects to initialize including its modulename
                //1. craw through all modules and register all posible module objects 
                for (var modulename in proc.Modules) {
                    
                    if (proc.Modules.hasOwnProperty(modulename)) {
                        //get all aim object by its module name
                        var objs;
                        if(baseType == _.UND){ //if main aim initialization 
                             objs = _(modulename);
                        }else{ //if initialization is element withen base?
                          base = _.Engine.RP(base); //get base element
                          if(_.IsFound(base)){
                           if(_.IsArray(base)){ //if multiple base element found, run init on each base element
                               base.Each(function(bs){_.Engine.Proccessor.Init(bs)});
                               return;
                           }else{//if single base
                               //if base object is aim object of the current module, register it for initialization
                               if(_.IsElement(base) && base.InClass(modulename) && modulename != "aim-autoload"){
                                var newreg = proc.Register(base,modulename);
                                // _.Log("Base obj : "+cobj.ID);
                                 //check if module has initialization
                                 if(typeof proc.Modules[modulename].Init != _.UND){
                                     //add to init objects
                                     LocalInitObj.push({ObjectID:base.ID,ModuleName:modulename});
                                 }
                               }
                                objs = base._(modulename);
                           }
                          }else{
                             objs = _(modulename); 
                          }
                        }
                        
                        
                        
                        //if object(s) exist
                        if(_.IsFound(objs)){
                            
                                                       //if multiple object found
                            if(_.IsArray(objs)){
                                //loop through each object an register it
                                for(var aob = 0; aob <objs.length; aob++){
                                    var cobj = objs[aob]; //get the object
                                    //register it
                                    
                                   var newreg = proc.Register(cobj,modulename);
                                   // _.Log("Base obj : "+cobj.ID);
                                    //check if module has initialization
                                    if(typeof proc.Modules[modulename].Init != _.UND){
                                        //add to init objects
                                        LocalInitObj.push({ObjectID:cobj.ID,ModuleName:modulename});
                                    }
                                    
                                }
                            }else{//if just one object exist for the modulename
                                
                                //register it
                                proc.Register(objs,modulename);
                               // _.Log("Base obj : "+objs.ID);
                                if(typeof proc.Modules[modulename].Init != _.UND){
                                    //add to init objects
                                    LocalInitObj.push({ObjectID:objs.ID,ModuleName:modulename});
                                }
                            }
                        }
                    }
                    
                }
                //_.Log(JSON.stringify(LocalInitObj))
                //alert(JSON.stringify(LocalInitObj))
                //2. Run all register init objects
                if(LocalInitObj.length > 0){
                for(var k=0 ; k < LocalInitObj.length; k++){
                 var oid=LocalInitObj[k];
                 //get all object that requires initialization
                 if (typeof proc.Modules[oid.ModuleName] != _.UND)proc.Modules[oid.ModuleName].Init(_(oid.ObjectID)); //perform initialization of all registered object
                }
            }else{
                proc.Finish();
            }
           
          
      },
      State:"End",
      //method to finish proccess initialization process
      Finish:function(){
        var proc = _.Engine.Proccessor;
        //increament counter
        proc.InitCounter++;
        //if all int object are true running
        if(proc.InitCounter >= proc.InitObjects.length){
            //prompt InitManager of proccessor initialization completion
            proc.InitEnd = true;
            _.Engine.InitManager.Complete("Proccessor");
        }
      }
      //End of Proccessor Int
  }
  //End of Aim Proccessor
  //************************************************** */
  //The Aim Calender Object
,
Calendar: function(param){
    this.TargetID = param.Target;
    this.Display = typeof param.Display != "undefined" ? param.Display : '';
    
    this.Target = typeof param.Target != "undefined" ? document.getElementById(param.Target) : null;
    if(this.Target != null){
        if(typeof this.Target.value == _UND){
          Object.defineProperty(this.Target,"value",{
              set:function(val){this.textContent = val},
              get:function(){return this.textContent}
          });
        }
    }
    //alert(this.Target)
    this.Range = typeof param.Range != "undefined" ? param.Range : false;
    this.RangeStart = null;
    this.BodyClass = typeof param.BodyClass != "undefined" ? param.BodyClass : "calender-displaycont";
    this.BodyStyle = typeof param.BodyClass != "undefined" ? param.BodyStyle : "";
    this.TableClass = typeof param.TableClass != "undefined" ? param.TableClass : "tables";
    this.InTransition = typeof param.InTransition != "undefined" ? param.InTransition : "inanim";
    this.OutTransition = typeof param.OutTransition != "undefined" ? param.OutTransition : "outanim";
    this.TodayClass = typeof param.TodayClass != "undefined" ? param.TodayClass : "today";
    this.SelectedClass = typeof param.SelectedClass != "undefined" ? param.SelectedClass : "selected";
    this.Caption = typeof param.Caption != "undefined" ? param.Caption : "";
    this.SelectTo = typeof param.SelectTo != "undefined" ? param.SelectTo : "";
    if(this.SelectTo != "" && this.Range == false){ //if selectto is set and range not set, set it
        this.Range = true;
    }

    this.AutoRemove = false;

    // Converts a date into '12-Oct-1984' format
    this.getDateString = function (dt) {
        return dt.getDate() + '-' +
            ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'][dt.getMonth()] +
            '-' + dt.getFullYear();
    }

    // Converts a date into 'July 2010' format
    this.getMonthYearString = function (dt) {
        return ['January', 'February', 'March', 'April', 'May', 'June', 'July',
            'August', 'September', 'October', 'November', 'December'][dt.getMonth()] +
            ' ' + dt.getFullYear();
    }
    var calobj = this;

    this.Remove = function () {
       // alert('remove')
        // if(this.AutoRemove){
        var cont = document.getElementsByClassName(this.BodyClass);

        if (cont != null) {
            var cont = Array.prototype.slice.call(cont);
            // alert(cont.length);
            for (var x = 0; x < cont.length; x++) {
                // alert(cont[x])
                if (cont[x].classList.contains('aim-maincont-popup')) {
                    cont[x].parentElement.removeChild(cont[x]);
                }

            }

            //alert('removed');
        }
        // }

    }

    //trim spaces
    this.Clean = function (val) {
        return val.replace(/^\s+|\s+$/g, '');
    }

    this.ClearTarget = function(){
        if(calobj.Target != null)calobj.Target.value = "";
    }

    this.Destroy = function (e) {
        var targ; // Crossbrowser way to find the target (http://www.quirksmode.org/js/events_properties.html)
        if (!e) var e = window.event;
        if (e.target) targ = e.target;
        else if (e.srcElement) targ = e.srcElement;
        if (targ.nodeType == 3) targ = targ.parentNode; // defeat Safari bug
        if (!targ.classList.contains("aim-calender-ctr")) {
            if(calobj.RangeStart != null){
                if(calobj.Target != null)calobj.Target.value = calobj.Clean(calobj.Target.value.replace("-",""));
                calobj.RangeStart = null;
            }
            calobj.Remove();
        }
    }

    //function to select range
    this.SelectRange = function (MinDate, MaxDate) {
        var loopMinDate = new Date(MinDate.getFullYear() + "-" + (MinDate.getMonth() + 1)+ "-" + MinDate.getDate());
        var loopMaxDate = new Date(MaxDate.getFullYear() + "-" + (MaxDate.getMonth() + 1)+ "-" + MaxDate.getDate());
        if (loopMinDate.getTime() > loopMaxDate.getTime()) {
            var temp = loopMinDate;
            loopMinDate = loopMaxDate;
            loopMaxDate = temp;
        } else if (loopMinDate.getTime() == loopMaxDate.getTime()) {
            //id
            var btn = this.WeekDisplay.getElementsByClassName(loopMinDate.getDate() + "_" + (loopMinDate.getMonth() + 1) + "_" + loopMinDate.getFullYear());
            if (btn != null) btn[0].classList.add(this.SelectedClass);
            return;
        }
        
        while (1) {
            var btn = this.WeekDisplay.getElementsByClassName(loopMinDate.getDate() + "_" + (loopMinDate.getMonth() + 1) + "_" + loopMinDate.getFullYear());
            if (btn != null && btn.length > 0) btn[0].classList.add(this.SelectedClass);

            if (loopMinDate.getDate() == loopMaxDate.getDate() && loopMinDate.getMonth() == loopMaxDate.getMonth() && loopMinDate.getFullYear() == loopMaxDate.getFullYear()) {
                break;
            }

            loopMinDate.setDate(loopMinDate.getDate() + 1);
        }
    }

    this.SelectRangeMonth = function (MinDate, MaxDate) {
        var loopMinDate = new Date(MinDate.getFullYear() + "-" + (MinDate.getMonth() + 1));
        var loopMaxDate = new Date(MaxDate.getFullYear() + "-" + (MaxDate.getMonth() + 1));
        if (loopMinDate.getTime() > loopMaxDate.getTime()) {
            var temp = loopMinDate;
            loopMinDate = loopMaxDate;
            loopMaxDate = temp;
        } else if (loopMinDate.getTime() == loopMaxDate.getTime()) {
            //id
            var btn = this.MonthDisplay.getElementsByClassName((loopMinDate.getMonth() + 1) + "_" + loopMinDate.getFullYear());
            if (btn != null) btn[0].classList.add(this.SelectedClass);
            return;
        }
        
        while (1) {
            var btn = this.MonthDisplay.getElementsByClassName((loopMinDate.getMonth() + 1) + "_" + loopMinDate.getFullYear());
            if (btn != null && btn.length > 0) btn[0].classList.add(this.SelectedClass);

            if (loopMinDate.getMonth() == loopMaxDate.getMonth() && loopMinDate.getFullYear() == loopMaxDate.getFullYear()) {
                break;
            }

            loopMinDate.setMonth(loopMinDate.getMonth() + 1);
        }
    }

    this.SelectRangeYear = function (MinDate, MaxDate) {
        var loopMinDate = new Date(MinDate.getFullYear()+"-1");
        var loopMaxDate = new Date(MaxDate.getFullYear()+"-1");
        if (loopMinDate.getTime() > loopMaxDate.getTime()) {
            var temp = loopMinDate;
            loopMinDate = loopMaxDate;
            loopMaxDate = temp;
        } else if (loopMinDate.getTime() == loopMaxDate.getTime()) {
            //id
            var btn = this.YearDisplay.getElementsByClassName(loopMinDate.getFullYear());
            if (btn != null) btn[0].classList.add(this.SelectedClass);
            return;
        }
        
        while (1) {
            var btn = this.YearDisplay.getElementsByClassName(loopMinDate.getFullYear());
           // _.Log(loopMinDate.getFullYear());
            if (btn != null && btn.length > 0) btn[0].classList.add(this.SelectedClass);

            if (loopMinDate.getFullYear() == loopMaxDate.getFullYear()) {
                break;
            }

            loopMinDate.setFullYear(loopMinDate.getFullYear() + 1);
        }
    }

    //check validity
    this.DateIsValid = function(dateobj){
        return isNaN(dateobj.getTime())?false:true;
    }


    //create the week calender *****************************************************
    this.Create = function (tbvalue) {
        targetval = this.Target == null ? '' : this.Target.value;
        if (typeof tbvalue == "undefined") {
            tbvaluearr = this.Clean(targetval).split("-");
            tbvalue = tbvaluearr[0];

        }

        var tbvaluemax = null;
        //check if range selection
        if (this.Range) {
            tbvaluearr = this.Clean(targetval).split("-");
            if (tbvaluearr.length > 0) {
                tbvaluemin = this.Clean(tbvaluearr[0]);
                if (typeof tbvaluearr[1] != 'undefined') {
                    tbvaluemax = this.Clean(tbvaluearr[1]);
                    tbvaluemax = tbvaluemax == "" ? null : tbvaluemax;
                }
            }

        }

        //get the current date
        //tbvalue = typeof tbvalue == "undefined"?event.target.getAttribute('data-date'):tbvalue
        // alert(tbvalue);
        var curdatestr = this.ParseMyDate(tbvalue);
        // alert(curdatestr);
        var CurDate = new Date(curdatestr);
        // alert(CurDate);
        var CurDateMax = null, CurDateMin = null;
        if (this.Range) {
            //alert(tbvaluemax);
            if (tbvaluemin != null) CurDateMin = new Date(this.ParseMyDate(tbvaluemin));
            if (tbvaluemax != null) CurDateMax = new Date(this.ParseMyDate(tbvaluemax));
        }
        var TodayDate = new Date();

        //create the main table
        var maintb = document.createElement('table');

        if(this.Caption != ""){
    //add the caption
            var caption = maintb.createCaption();
            caption.textContent = this.Caption;
            caption.className = 'aim-calender-ctr';
        }
        
        //maintb.cellPadding = "10px";
        //maintb.cellSpacing ="0px";
        //maintb.border ="1px";
        maintb.className = 'maintb aim-calender-ctr ' + this.TableClass;
        var thead = maintb.createTHead();

        //add the header row ************************

        var headerrw = thead.insertRow();
        headerrw.className = ' aim-calender-ctr';
        //insert the header text cell
        var htxt = headerrw.insertCell();
        htxt.className = ' aim-calender-ctr';
        htxt.style.textAlign = "left";
        htxt.colSpan = 4;
        var btn = document.createElement('button');
        //alert(CurDate);
        btn.className = 'aim-calender-ctr';
        btn.textContent = this.getMonthYearString(CurDate);
        btn.title="View Month Calendar";
        btn.setAttribute('data-date', CurDate.getDate() + '/' + (CurDate.getMonth() + 1) + '/' + CurDate.getFullYear());
        btn.onclick = this.CreateMonthCalender;
        btn.type = "button";
        htxt.appendChild(btn);
        //htxt.textContent = this.getMonthYearString(CurDate);
        //htxt.textContent = CurDate.getMonth();
        //insert the prev / next control
        var prevctr = headerrw.insertCell();
      prevctr.className = ' aim-calender-ctr';
      prevctr.title = "Previous";
      var pbtn = document.createElement('button');
      pbtn.className = 'aim-calender-ctr';
      pbtn.innerHTML = '&#10094';
      pbtn.style.transform = "rotate(90deg)";
      pbtn.type = "button";
      prevctr.appendChild(pbtn);
      //prevctr.innerHTML = '&#10094';
      var prvdate = new Date(CurDate.getFullYear() + '-' + (CurDate.getMonth() + 1) + '-' + CurDate.getDate());
      prvdate.setMonth(prvdate.getMonth() - 1);
      //prvdate = new Date(CurDate.getFullYear()+'-'+CurDate.getMonth()+"-"+CurDate.getDate());
      pbtn.setAttribute('data-date', this.FormatDate(prvdate));
      pbtn.onclick = this.ReCreate;

      var nextctr = headerrw.insertCell();
      nextctr.className = ' aim-calender-ctr';
      nextctr.title = "Next";
      var nbtn = document.createElement('button');
      nbtn.className = 'aim-calender-ctr';
      nbtn.innerHTML = '&#10095';
      nbtn.style.transform = "rotate(90deg)";
      nbtn.type = "button";
      nextctr.appendChild(nbtn);
      //nextctr.innerHTML = '&#10095';
      var nextdate = new Date(CurDate.getFullYear() + '-' + (CurDate.getMonth() + 1) + '-' + CurDate.getDate());
      nextdate.setMonth(nextdate.getMonth() + 1);
      nbtn.setAttribute('data-date', nextdate.getDate() + '/' + (nextdate.getMonth() + 1) + '/' + nextdate.getFullYear());
      nbtn.onclick = this.ReCreate;

      var cleartd = headerrw.insertCell();
      cleartd.title = "Clear";
        //cleartd.className = ' aim-calender-ctr';
        var clbtn = document.createElement('button');
        //clbtn.className = 'aim-calender-ctr';
        clbtn.innerHTML = '&#9974';
        clbtn.type = "button";
        cleartd.appendChild(clbtn);
        clbtn.onclick = this.ClearTarget;

        //add the header row ************************

        //add the week days row ************************
        var tbody = maintb.createTBody();
        var wkd = tbody.insertRow();
        wkd.className = ' aim-calender-ctr';
        var weekdayarr = ['Su', 'Mo', 'Te', 'We', 'Th', 'Fr', 'Sa'];
        for (var w = 0; w < weekdayarr.length; w++) {
            /* var sp = document.createElement('span');
               sp.className = 'aim-calender-ctr';
               sp.textContent = weekdayarr[w]; */
            var wkdk = wkd.insertCell();
            wkdk.className = 'aim-calender-ctr';
            wkdk.innerHTML = '<div class="aim-calender-ctr">' + weekdayarr[w] + '</div>';
            //wkd.insertCell().appendChild(btn);
        }
        /* wkd.insertCell().textContent = 'Su';
        wkd.insertCell().textContent = 'Mo';
        wkd.insertCell().textContent = 'Te';
        wkd.insertCell().textContent = 'We';
        wkd.insertCell().textContent = 'Th';
        wkd.insertCell().textContent = 'Fr';
        wkd.insertCell().textContent = 'Sa'; */
        //add the week days row ************************

        // get the first day of the curDate month
        var date = new Date(CurDate.getFullYear(), CurDate.getMonth(), 1, 0, 0, 0, 0);

        //get the week day the month starts with
        var wkday = date.getDay();
        //get the previous month days that will enter this month calendar
        var prevmontDays = wkday;

        //let the day start from the prev month day that enters this month
        var date = new Date(CurDate.getFullYear(), CurDate.getMonth(), 1 - prevmontDays, 0, 0, 0, 0);

var totalwk = this.Caption != ""?2.5:2;
        //loop to form each week of the month
        while (1) {
            //create the week row
            var wkrw = tbody.insertRow();
            wkrw.className = ' aim-calender-ctr';
            totalwk++;
            //loop through all days of the week
            for (var d = 0; d < 7; d++) {
                //get the current day
                var curday = date.getDate();
                //insert to the week row
                var dtb = wkrw.insertCell();
                dtb.className = 'aim-calender-ctr';
                var btn = document.createElement('button');
                btn.className = (TodayDate.getDate() == date.getDate() && TodayDate.getMonth() == date.getMonth() && TodayDate.getFullYear() == date.getFullYear()) ? 'aim-calender-ctr ' + this.TodayClass : 'aim-calender-ctr';
                btn.textContent = curday;
                btn.setAttribute('data-date', date.getDate() + '/' + (date.getMonth() + 1) + '/' + date.getFullYear());
                btn.className += " " + date.getDate() + '_' + (date.getMonth() + 1) + '_' + date.getFullYear();
                if (date.getMonth() != CurDate.getMonth()) {
                    btn.style.opacity = "0.4";
                }
                btn.type = "button";
                btn.onmouseout = function(){
                    var dts = this.getAttribute('data-date');
                    if (calobj.Range == true) {
                        if (calobj.RangeStart != null) {
                            var maxDatess = new Date(calobj.ParseMyDate(dts));
                            //exclude class name
var exclclsnm = calobj.RangeStart.getDate() + '_' + (calobj.RangeStart.getMonth() + 1) + '_' + calobj.RangeStart.getFullYear();
                            var des = calobj.DeselectAll(calobj.WeekDisplay,exclclsnm);
                        }
                    }
                }
                btn.onmouseover = function(){
                    var dts = this.getAttribute('data-date');
                    if (calobj.Range == true) {
                        if (calobj.RangeStart != null) {
                            var maxDatess = new Date(calobj.ParseMyDate(dts));
                            //exclude class name
//var exclclsnm = calobj.RangeStart.getDate() + '_' + (calobj.RangeStart.getMonth() + 1) + '_' + calobj.RangeStart.getFullYear();
                           // var des = calobj.DeselectAll(calobj.WeekDisplay,exclclsnm);
                           // _.Log("Start Deselection Date: "+calobj.FormatDate(calobj.RangeStart));
                           if(maxDatess.getTime() > calobj.RangeStart.getTime()){
                               calobj.SelectRange(calobj.RangeStart, maxDatess);
                           }else{
                            calobj.SelectRange(maxDatess, calobj.RangeStart);
                           }
                            
                            //_.Log("End Deselection Date: "+calobj.FormatDate(calobj.RangeStart));
                        }
                    }
                }
                btn.onclick = this.SetDate;
                dtb.appendChild(btn);
                //increment the date
                date.setDate(curday + 1); // Increment a day
            }

            //if the date is not the current month terminate
            if (date.getMonth() != CurDate.getMonth()) break;

        }
        //get the container
        if (this.Display != "") {
            var maincont = document.getElementById(this.Display);
            //maincont.className = "";
            //this.AutoRemove = false;
        } else {
            //geet the target next sibling
            var sibling = this.Target.nextSibling;
            if (sibling != null && typeof sibling.classList != "undefined" && sibling.classList.contains('aim-calender-ctr')) {
                sibling.parentElement.removeChild(sibling);
            }

            //create the display box (popup)
            var maincont = document.createElement('div');
            maincont.id = 'mc_' + Math.random() + CurDate.getTime();
            maincont.className = "aim-maincont-popup ";
            //maincont.className = ;
            maincont.style.position = "absolute";
            this.Target.parentNode.insertBefore(maincont, this.Target.nextSibling);
            this.Display = maincont.id;
            ///this.AutoRemove = true;
            // this.Target.insertAdjacentHTML('afterend'.)
        }
        maincont.className += this.BodyClass + ' aim-calender-ctr';
        maincont.style.minHeight = (totalwk * 50) + "px";
        //set the dynamic style
        maincont.style.cssText += "; "+ this.BodyStyle;
        //maincont.style.height = "200px";
        //get all generated calender
        var allcal = document.getElementsByClassName("aim-calender-maincont");
        if (allcal.length > 0) {
            for (var s = 0; s < allcal.length; s++) {
                mtb = allcal.item(s);
                if (mtb.parentElement == maincont) {
                    maincont.removeChild(mtb);
                }

            }
        }

        //add the display opjects to the main object
        this.MainDisplay = maincont;
        //create the Caption div
        
        
        //create calendar container if not exist
        var calcont = document.createElement('div');
        calcont.className = "aim-calender-maincont";
        //create weekcalendar
        var weekcal = document.createElement('div');
        weekcal.className = "weekcalendar " + this.InTransition;
        weekcal.style.cssText = "position:absolute;z-index:4";
        this.WeekDisplay = weekcal;
        //add the week calender
        weekcal.appendChild(maintb)
        //create monthcalendar
        var monthcal = document.createElement('div');
        monthcal.className = "monthcalendar " + this.OutTransition;
        monthcal.style.cssText = "position:absolute;z-index:3;display:none";
        this.MonthDisplay = monthcal;

        //create yearcalendar
        var yearcal = document.createElement('div');
        yearcal.className = "yearcalendar " + this.OutTransition;
        yearcal.style.cssText = "position:absolute;z-index:2;display:none";
        this.YearDisplay = yearcal;

        calcont.appendChild(weekcal);
        calcont.appendChild(monthcal);
        calcont.appendChild(yearcal);
        maincont.appendChild(calcont);

        if (this.Range) {
            //get the target
            if (CurDateMax != null) {
                this.SelectRange(CurDateMin, CurDateMax);
            } else {
                var clname = CurDateMin.getDate() + '_' + (CurDateMin.getMonth() + 1) + '_' + CurDateMin.getFullYear();
                var sobj = this.WeekDisplay.getElementsByClassName(clname);
                if (sobj != null && typeof sobj[0] != "undefined"){
                    sobj[0].classList.add(this.SelectedClass);
                if(this.RangeStart != null){
                    sobj[0].classList.add('startblink');
                }
                    
                }
            }
        } else {
            var tdate = new Date(this.ParseMyDate(targetval));
            var clname = tdate.getDate() + '_' + (tdate.getMonth() + 1) + '_' + tdate.getFullYear();
            var sobj = this.WeekDisplay.getElementsByClassName(clname);
            if (sobj != null && typeof sobj[0] != "undefined"){
                sobj[0].classList.add(this.SelectedClass);
            }
            
        }
    }

    //function to handule date button click
    this.SetDate  = function (dt) {
        //alert(dt);
        var dt = typeof dt != "string"?this.getAttribute('data-date'):dt;
        if (calobj.Range != true) {
            calobj.Target.value = dt;
            calobj.DeselectAll(calobj.WeekDisplay);
            this.classList.add(calobj.SelectedClass);
            calobj.Remove();
        } else { //if range selection
            if (calobj.RangeStart == null) { //if range start not set meaning first selection
                calobj.RangeStart = new Date(calobj.ParseMyDate(dt));
                calobj.Target.value = dt + " - ";
               // _.Log("Start Range: "+dt);
                calobj.DeselectAll(calobj.WeekDisplay);
                this.classList.add(calobj.SelectedClass);
                this.classList.add('startblink');
                
                //alert(calobj.SelectTo);
                if(calobj.SelectTo != ""){
                    //alert('selectto')
                    //check if increamental
                    //var fchar = calobj.SelectTo.substr(0,1);
                    //if(fchar == "+"){
                        var selectto = _.Engine.Proccessor.GetAttr(calobj.SelectTo);
                        if(calobj.Clean(selectto) != ""){
                            var num = Number.parseInt(selectto);
                            //alert(num);
                            if(!isNaN(num)){ //if increament
                                var ndate = new Date(calobj.RangeStart.getFullYear() + "-" + (calobj.RangeStart.getMonth() + 1) + "-" + calobj.RangeStart.getDate());
                                ndate.setDate(ndate.getDate() + num);
                                
                                calobj.SetDate(ndate.getDate() + "/" +(ndate.getMonth() + 1)+"/"+ndate.getFullYear());
                            }else{ //if to date
                                var ndate = new Date(calobj.ParseMyDate(selectto));
                                if(calobj.DateIsValid(ndate)){
                                    calobj.SetDate(ndate.getDate() + "/" +(ndate.getMonth() + 1)+"/"+ndate.getFullYear());
                                }
                            }
                        }
                        
                    //}
                }
            } else {
               // _.Log("End Range: "+dt);
                var maxDate = new Date(calobj.ParseMyDate(dt));
                //_.Log("Start RangeDate: "+calobj.FormatDate(calobj.RangeStart));
                //_.Log("End RangeDate: "+calobj.FormatDate(maxDate));
                var rtnstr = '';
                if (calobj.RangeStart.getTime() < maxDate.getTime()) {
                    rtnstr = calobj.FormatDate(calobj.RangeStart) + " - " + calobj.FormatDate(maxDate);
                } else if (calobj.RangeStart.getTime() > maxDate.getTime()) {
                    rtnstr = calobj.FormatDate(maxDate) + " - " + calobj.FormatDate(calobj.RangeStart);
                } else {
                    rtnstr = calobj.FormatDate(maxDate);
                }

                calobj.Target.value = rtnstr;
                calobj.DeselectAll(calobj.WeekDisplay);
                calobj.SelectRange(calobj.RangeStart, maxDate);
                calobj.RangeStart = null;
            calobj.RemoveBlink();
                //this.classList.add(calobj.SelectedClass);
                calobj.Remove();
            }
        }

    }

    this.ReCreate = function (e) {
        var targ; // Crossbrowser way to find the target (http://www.quirksmode.org/js/events_properties.html)
        if (!e) var e = window.event;
        if (e.target) targ = e.target;
        else if (e.srcElement) targ = e.srcElement;
        if (targ.nodeType == 3) targ = targ.parentNode; // defeat Safari bug
        tod = targ.getAttribute('data-date');

        calobj.Create(tod);
    }

    this.DeselectAll = function (calendar,exclude) {
        //get all selected in  the supplied calendar
        var sels = calendar.getElementsByClassName(this.SelectedClass);
        if (sels != null) {
            //alert(sels.length)
            var arrRtn = Array.prototype.slice.call(sels);
            for (var ee = 0; ee < arrRtn.length; ee++) {
                var el = arrRtn[ee];
                if(typeof exclude == "undefined" || !el.classList.contains(exclude)){
                  el.classList.remove(this.SelectedClass);
                }
                
            }
        }
        return true;
    }

    this.RemoveBlink = function(){
        var sels = this.WeekDisplay.getElementsByClassName('startblink');
        if (sels != null) {
            //alert(sels.length)
            var arrRtn = Array.prototype.slice.call(sels);
            for (var ee = 0; ee < arrRtn.length; ee++) {
                var el = arrRtn[ee];
                el.classList.remove('startblink');
            }
        }
    }

    //parse my date format
    this.ParseMyDate = function (dt) {
        var today = new Date();
        if (dt == '') {
            return this.Today();
        }
        var dtarr = dt.split("/");
        var day=today.getDate(),month=today.getMonth() + 1,year = today.getFullYear();
       if(dtarr.length > 2){ //day/month/year
        day = Number.parseInt(dtarr[0]);
        day = Number.isNaN(day)?1:day;
        month = Number.parseInt(dtarr[1]);
        month = Number.isNaN(month)?(today.getMonth()+1):month;
        year = Number.parseInt(dtarr[2]);
        year = Number.isNaN(year)?today.getFullYear():year;
       }else if(dtarr.length == 2){
           day = 1;
        month = Number.parseInt(dtarr[0]);
        month = Number.isNaN(month)?(today.getMonth()+1):month;
        year = Number.parseInt(dtarr[1]);
        year = Number.isNaN(year)?today.getFullYear():year; 
       }else if(dtarr.length == 1){
        day = 1;
        month = today.getMonth()+1;
        year = Number.parseInt(dtarr[0]);
        year = Number.isNaN(year)?today.getFullYear():year;
       }

       //get the last day of the date supplied
       var newdate = new Date(year,month,0,0,0,0,0);
       var lastday = newdate.getDate();
       day = day > lastday?lastday:day;
        return year + '-' + month + '-' + day;
    }

    //get todays date
    this.Today = function () {
        var dt = new Date();
        return dt.getFullYear() + '-' + (dt.getMonth() + 1) + '-' + dt.getDate();
    }

    this.FormatDate = function (dateobj) {
        return dateobj.getDate() + '/' + (dateobj.getMonth() + 1) + '/' + dateobj.getFullYear();
    }

    this.Init = (function (param, obj) {
        //alert(obj.Destroy);
        if(obj.Target != null)obj.Target.classList.add('aim-calender-ctr');
        obj.Remove();
        document.addEventListener("click", obj.Destroy);
    })(param, this);

    //Create the Month Calender *************************************
    this.CreateMonthCalender = function () {
        var formbtn = function (txt) {
            var nbtn = document.createElement('button');
            nbtn.className = 'aim-calender-ctr';
            nbtn.innerHTML = txt;
            nbtn.type = "button";
            return nbtn;
        }
        var cdate = this.getAttribute('data-date');
        //process range value
        var targetval = calobj.Target == null ? '' : calobj.Target.value;
        var tbvaluemax = null, tbvaluemin = null;
        var CurDateMax = null, CurDateMin = null;
        //check if range selection
        if (calobj.Range) {
            tbvaluearr = calobj.Clean(targetval).split("-");
            if (tbvaluearr.length > 0) {
                tbvaluemin = calobj.Clean(tbvaluearr[0]);
                if (typeof tbvaluearr[1] != 'undefined') {
                    tbvaluemax = calobj.Clean(tbvaluearr[1]);
                    tbvaluemax = tbvaluemax == "" ? null : tbvaluemax;
                }
            }

            if (tbvaluemin != null) CurDateMin = new Date(calobj.ParseMyDate(tbvaluemin));
            if (tbvaluemax != null) CurDateMax = new Date(calobj.ParseMyDate(tbvaluemax));

        }
        //alert(cdate);
        //get the date object
        var CdateObj = new Date(calobj.ParseMyDate(cdate))

        var TodayDate = new Date();

        //get date from target
        var targetval = calobj.Target == null ? '' : calobj.Target.value;
        if (calobj.Range) {
            //if(targetval != ""){
            var targetvalarr = targetval.split("-");
            targetval = calobj.Clean(targetvalarr[0]);

        }
        var targetDate = targetval == "" ? CdateObj : new Date(calobj.ParseMyDate(targetval))

        //get the content box
        var contbx = calobj.MonthDisplay;

        //create the main table
        var wktable = document.createElement('table');
        wktable.className = 'aim-calender-ctr ' + calobj.TableClass;

        if(calobj.Caption != ""){
            //add the caption
                    var caption = wktable.createCaption();
                    caption.textContent = calobj.Caption;
                    caption.className = 'aim-calender-ctr';
                }
        //wktable.cellPadding = "10px";
        //wktable.cellSpacing ="0px";
        //wktable.border ="1px";

        wkthead = wktable.createTHead();
        //add the header row
        var wkheadrw = wkthead.insertRow();
        wkheadrw.className = 'aim-calender-ctr';

        var headertxt = wkheadrw.insertCell();
        headertxt.colSpan = 1;
        var hbtn = formbtn(CdateObj.getFullYear());
        hbtn.title="View Year Calendar";
        hbtn.setAttribute('data-date', CdateObj.getDate() + '/' + (CdateObj.getMonth() + 1) + '/' + CdateObj.getFullYear());
        hbtn.onclick = calobj.CreateYearCalender;
        headertxt.appendChild(hbtn);

        var prevbtn = formbtn('&#10094');
        prevbtn.style.transform = "rotate(90deg)";
        prevbtn.setAttribute('data-date', CdateObj.getDate() + '/' + (CdateObj.getMonth() + 1) + '/' + (CdateObj.getFullYear() - 1));
        prevbtn.onclick = calobj.CreateMonthCalender;
        wkheadrw.insertCell().appendChild(prevbtn);

        var nxtbtn = formbtn('&#10095');
        nxtbtn.style.transform = "rotate(90deg)";
        nxtbtn.setAttribute('data-date', CdateObj.getDate() + '/' + (CdateObj.getMonth() + 1) + '/' + (CdateObj.getFullYear() + 1));
        nxtbtn.onclick = calobj.CreateMonthCalender;
        wkheadrw.insertCell().appendChild(nxtbtn);

        var cleartd = wkheadrw.insertCell();
        cleartd.title = "Clear";
          //cleartd.className = ' aim-calender-ctr';
          var clbtn = document.createElement('button');
          //clbtn.className = 'aim-calender-ctr';
          clbtn.innerHTML = '&#9974';
          clbtn.type = "button";
          cleartd.appendChild(clbtn);
          clbtn.onclick = calobj.ClearTarget;

        wktbody = wktable.createTBody();
        //add the month  row
        var wkmth = wktbody.insertRow();
        var mtharr = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec', 'Jan', 'Feb', 'Mar', 'Apr'];
        var totrw = 4;
        var cnt = 0;
        for (var d = 0; d < mtharr.length; d++) {
            var mnt = mtharr[d];
            if (cnt == totrw) {
                var wkmth = wktbody.insertRow();
                cnt = 0;
            }
            mntcell = wkmth.insertCell();
            //mntcell.colSpan = 2;

            var mbtn = formbtn(mnt);
            var y = CdateObj.getFullYear();
            var m = d + 1
            if (d > 11) { //new year
                mbtn.style.opacity = "0.4";
                y++;
                m = m - 12;
            }
            mbtn.setAttribute('data-date', CdateObj.getDate() + '/' + m + '/' + y);
            mbtn.classList.add(m+"_"+y);
            //selected
            if (targetDate.getMonth() == d && targetDate.getFullYear() == y) {
                mbtn.classList.add(calobj.SelectedClass);
            }

            //today
            if (TodayDate.getMonth() == d && TodayDate.getFullYear() == y) {
                mbtn.classList.add(calobj.TodayClass);
            }
            mbtn.onmouseout = function(){
                var dts = this.getAttribute('data-date');
                if (calobj.Range == true) {
                    if (calobj.RangeStart != null) {
                        var maxDatess = new Date(calobj.ParseMyDate(dts));
                        //exclude class name
var exclclsnm = (calobj.RangeStart.getMonth() + 1) + '_' + calobj.RangeStart.getFullYear();
                        var des = calobj.DeselectAll(calobj.MonthDisplay,exclclsnm);
                    }
                }
            }

            mbtn.onmouseover = function(){
                var dts = this.getAttribute('data-date');
                if (calobj.Range == true) {
                    if (calobj.RangeStart != null) {
                        var maxDatess = new Date(calobj.ParseMyDate(dts));
                        //exclude class name
/* var exclclsnm = (calobj.RangeStart.getMonth() + 1) + '_' + calobj.RangeStart.getFullYear();
                        var des = calobj.DeselectAll(calobj.MonthDisplay,exclclsnm); */
                       // _.Log("Start Deselection Date: "+calobj.FormatDate(calobj.RangeStart));
                       if(maxDatess.getTime() > calobj.RangeStart.getTime()){
                           calobj.SelectRangeMonth(calobj.RangeStart, maxDatess);
                       }else{
                        calobj.SelectRangeMonth(maxDatess, calobj.RangeStart);
                       }
                        
                        //_.Log("End Deselection Date: "+calobj.FormatDate(calobj.RangeStart));
                    }
                }
            }
            mbtn.onclick = calobj.ReCreate;
            mntcell.appendChild(mbtn);
            cnt++;
        }

        contbx.innerHTML = '';
        contbx.appendChild(wktable);

        calobj.WeekDisplay.style.display = 'none';
        calobj.YearDisplay.style.display = 'none';
        calobj.MonthDisplay.style.display = 'block';
        contbx.style.zIndex = "200";
        calobj.MainDisplay.style.minHeight = calobj.Caption != ""?(5.5 * 70) + "px":(5 * 70) + "px";

        //select all range month
        if (calobj.Range) {
            //get the target
            if (CurDateMax != null) {
                calobj.SelectRangeMonth(CurDateMin, CurDateMax);
            } else {
                var clname = (CurDateMin.getMonth() + 1) + '_' + CurDateMin.getFullYear();
                var sobj = calobj.MonthDisplay.getElementsByClassName(clname);
                if (sobj != null && typeof sobj[0] != "undefined"){
                    sobj[0].classList.add(calobj.SelectedClass);
                if(calobj.RangeStart != null){
                    sobj[0].classList.add('startblink');
                }
                    
                }
            }
        }

    }

    //Create the Month Calender **********************************
    this.CreateYearCalender = function () {
        var formbtn = function (txt) {
            var nbtn = document.createElement('button');
            nbtn.className = 'aim-calender-ctr';
            nbtn.innerHTML = txt;
            nbtn.type = "button";
            return nbtn;
        }
        var cdate = this.getAttribute('data-date');

        //proccess range value
        var targetval = calobj.Target == null ? '' : calobj.Target.value;
        var tbvaluemax = null, tbvaluemin = null;
        var CurDateMax = null, CurDateMin = null;
        //check if range selection
        if (calobj.Range) {
            tbvaluearr = calobj.Clean(targetval).split("-");
            if (tbvaluearr.length > 0) {
                tbvaluemin = calobj.Clean(tbvaluearr[0]);
                if (typeof tbvaluearr[1] != 'undefined') {
                    tbvaluemax = calobj.Clean(tbvaluearr[1]);
                    tbvaluemax = tbvaluemax == "" ? null : tbvaluemax;
                }
            }

            if (tbvaluemin != null) CurDateMin = new Date(calobj.ParseMyDate(tbvaluemin));
            if (tbvaluemax != null) CurDateMax = new Date(calobj.ParseMyDate(tbvaluemax));

        }

        //get the date object
        var CdateObj = new Date(calobj.ParseMyDate(cdate));

        //get target date
        //get date from target
        var targetval = calobj.Target == null ? '' : calobj.Target.value;
        if (calobj.Range) {
            //if(targetval != ""){
            var targetvalarr = targetval.split("-");
            targetval = calobj.Clean(targetvalarr[0]);

        }
        var targetDate = targetval == "" ? CdateObj : new Date(calobj.ParseMyDate(targetval))

        var TodayDate = new Date();

        //get the content box
        var contbx = calobj.YearDisplay;

        //current Year
        var year = CdateObj.getFullYear();
        var minyear = year - (year % 12);
        var maxyear = minyear + 11;

        //create the main table
        var wktable = document.createElement('table');
        wktable.className = 'aim-calender-ctr ' + calobj.TableClass;

        if(calobj.Caption != ""){
            //add the caption
                    var caption = wktable.createCaption();
                    caption.textContent = calobj.Caption;
                    caption.className = 'aim-calender-ctr';
                }
        //wktable.cellPadding = "10px";
        //wktable.cellSpacing ="0px";
        //wktable.border ="1px";
        var wkthead = wktable.createTHead()
        //add the header row
        var wkheadrw = wkthead.insertRow();
        wkheadrw.className = 'aim-calender-ctr';

        var headertxt = wkheadrw.insertCell();
        headertxt.colSpan = 1;
        headertxt.appendChild(formbtn(minyear + '-' + maxyear));

        var prevbtn = formbtn('&#10094');
        prevbtn.style.transform = "rotate(90deg)";
        prevbtn.setAttribute('data-date', CdateObj.getDate() + '/' + (CdateObj.getMonth() + 1) + '/' + (minyear - 1));
        prevbtn.onclick = calobj.CreateYearCalender;
        wkheadrw.insertCell().appendChild(prevbtn);

        var nxtbtn = formbtn('&#10095');
        nxtbtn.style.transform = "rotate(90deg)";
        nxtbtn.setAttribute('data-date', CdateObj.getDate() + '/' + (CdateObj.getMonth() + 1) + '/' + (maxyear + 1));
        nxtbtn.onclick = calobj.CreateYearCalender;
        wkheadrw.insertCell().appendChild(nxtbtn);

        var wktbody = wktable.createTBody()
        //add the month  row
        var wkmth = wktbody.insertRow();

        var cleartd = wkheadrw.insertCell();
        cleartd.title = "Clear";
          //cleartd.className = ' aim-calender-ctr';
          var clbtn = document.createElement('button');
          //clbtn.className = 'aim-calender-ctr';
          clbtn.innerHTML = '&#9974';
          clbtn.type = "button";
          cleartd.appendChild(clbtn);
          clbtn.onclick = calobj.ClearTarget;
        //var mtharr = ['Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec'];
        var totrw = 4;
        var cnt = 0;
        var plusextrayear = maxyear + 4
        for (var d = minyear; d <= plusextrayear; d++) {
            //var mnt = mtharr[d];
            if (cnt == totrw) {
                var wkmth = wktbody.insertRow();
                cnt = 0;
            }
            mntcell = wkmth.insertCell();
            //mntcell.colSpan = 2;
            var mbtn = formbtn(d);
            if (d > maxyear) {
                mbtn.style.opacity = "0.4";
            }
            mbtn.classList.add(d);
            mbtn.setAttribute('data-date', CdateObj.getDate() + '/' + (CdateObj.getMonth() + 1) + '/' + d);
            if (targetDate.getFullYear() == d) { //if current year select it
                mbtn.classList.add(calobj.SelectedClass);
            }

            if (TodayDate.getFullYear() == d) { //if current year select it
                mbtn.classList.add(calobj.TodayClass);
            }

            mbtn.onmouseout = function(){
                var dts = this.getAttribute('data-date');
                if (calobj.Range == true) {
                    if (calobj.RangeStart != null) {
                        var maxDatess = new Date(calobj.ParseMyDate(dts));
                       
                        //exclude class name
var exclclsnm =  calobj.RangeStart.getFullYear();
                        var des = calobj.DeselectAll(calobj.YearDisplay,exclclsnm);
                    }
                }
            }


            mbtn.onmouseover = function(){
                var dts = this.getAttribute('data-date');
                if (calobj.Range == true) {
                    if (calobj.RangeStart != null) {
                        var maxDatess = new Date(calobj.ParseMyDate(dts));
                       
                        //exclude class name
/* var exclclsnm =  calobj.RangeStart.getFullYear();
                        var des = calobj.DeselectAll(calobj.YearDisplay,exclclsnm); */
                       // _.Log("Start Deselection Date: "+calobj.FormatDate(calobj.RangeStart));
                       if(maxDatess.getTime() > calobj.RangeStart.getTime()){
                           calobj.SelectRangeYear(calobj.RangeStart, maxDatess);
                       }else{
                        calobj.SelectRangeYear(maxDatess,calobj.RangeStart );
                       }
                        
                        //_.Log("End Deselection Date: "+calobj.FormatDate(calobj.RangeStart));
                    }
                }
            }
            mbtn.onclick = calobj.CreateMonthCalender;
            mntcell.appendChild(mbtn);
            cnt++;
        }

        contbx.innerHTML = '';
        contbx.appendChild(wktable);
        calobj.WeekDisplay.style.display = 'none';
        calobj.MonthDisplay.style.display = 'none';
        calobj.MonthDisplay.className = "monthcalendar " + calobj.InTransition;
        calobj.YearDisplay.style.display = 'block';
        contbx.style.zIndex = "200";
        calobj.MainDisplay.style.minHeight = calobj.Caption != ""?(5.5 * 70) + "px":(5 * 70) + "px";
        //select all range month
        if (calobj.Range) {
            //get the target
            if (CurDateMax != null) {
                calobj.SelectRangeYear(CurDateMin, CurDateMax);
            } else {
                var clname = CurDateMin.getFullYear();
                var sobj = calobj.YearDisplay.getElementsByClassName(clname);
                if (sobj != null && typeof sobj[0] != "undefined"){
                    sobj[0].classList.add(calobj.SelectedClass);
                if(calobj.RangeStart != null){
                    sobj[0].classList.add('startblink');
                }
                    
                }
            }
        }

    }



}


//##

        
    }
    Aim.Engine.Url.Init(); //#initialize the #Url object
    
        //End Engine
       //************************************************* */
       //AIM Engine



       //AIM Include
       /*************************************************** */
       //Will be used to add functionality to the Aim Object
       //#_.Include
       Object.prototype.Include = function(inc){_.Engine.Include(inc,this);}
       Array.prototype.Include = function(inc){_.Engine.Include(inc,this);}
       String.prototype.Include = function(inc){_.Engine.Include(inc,this.toString());}
       //inc - the object containing all method/properties(functionality) to be added
      //this - the base/target object (Array, String Allowed)
      //If array add all functionality to every element of the array
      //if string, get the element(s) using aim getter and perform the Include operation on the get element(s)
       /*************************************************** */
       //AIM Include
       

      win._ = win.Aim = Aim; //add aim to window object
    }
)(window);



//Generic Function to perform globalization
String.prototype.Globalize = function(func,BaseObject){
    _.Engine.Globalize(BaseObject,this.toString(),func);
}
//function to process this keyword as required for globalization
//Converting String object to String
function This(thisobj){
  return (thisobj instanceof String)?thisobj.toString():thisobj;
}





//Main Aim Methods allow for user calls are included here.
//NB - Main Method is an improved TaquaLB Basic.js
//NB - most reference the Aim Engine
//#Basic Opertaions
/**************************************************** */
_.Include({

    //console.log
    Log:function(txt){
       console.log("Aim: "+txt);
    },
    
    //Perform Show/Hide/Both on an Element
    //ID - Holds the Element or its id - Required (Array allowed)
    //NB - if array, perform the showhide operation on all the item of the array
    //Show - Holds which operation to perform on the Element (1 => Show, 0 => Hide, Any Other Value => Toggle) - Required
    //display - Holds the Element CSS display value ('block','inline','inline-block','table' e.t.c) - Default => 'block' (true = 'block', false = 'inline')
    //Show an html element
    //Globalized (ID.Show(display))
    //#_.Show
    Show:function(ID,display){
      _.Engine.ShowHide(ID,1,display);
    },

//Perform Validation
//input - the input element to validate
//#_.Validate
Validate:function(input){
    return _.Engine.Validate(input);
  },

  //Cloner/Copy an element
  //elem - the elment to copy
  //withevent - include the event
  //deep - true|false => determine if decendant children will be copy as well
  //#_.Cloner
  Cloner:function(elem,withevent,deep){
    withevent = withevent || false;
    deep = deep || true;
     return _.Engine.Cloner(elem,withevent,deep);
  },

  //Replace element(s) with another element(s)
  //oldelem - the element(s) to be replaced
  //newelem - the element(s) to replace oldelem
  ReplaceWith:function(oldelem,newelem){
    _.Engine.ReplaceWith(oldelem,newelem);
  },

    //Hide an html element
    //Globalized (ID.Hide(display))
    //#_.Hide
    Hide:function(ID){
        _.Engine.ShowHide(ID,0);
      },

      //Toggle show and hide of an html elemet
      //Globalized (ID.ToggleShow(display))
      //#_.ToggleShow
    ToggleShow:function(ID,display){
        _.Engine.ShowHide(ID,2,display);
    },

    //Show an html element(visibility)
    //Globalized (ID.Appear())
    //#_.Appear
    Appear:function(ID){
        _.Engine.VisibleHide(ID,1);
      },
  
      //Hide an html element(visibility)
      //Globalized (ID.Disappear())
      //#_.Hide
      Disappear:function(ID){
          _.Engine.VisibleHide(ID,0);
        },
  
        //Toggle show and hide of an html elemet (visibility)
        //Globalized (ID.Toggle(display))
        //#_.Toggle
      ToggleAppear:function(ID){
          _.Engine.VisibleHide(ID,2);
      },


    //Replace all ocuurence of a string in another string
    //Globalized (str.Replace(strSearch,strReplace))
    //#_.Replace
    Replace:function(strSearch,strReplace,str){
    //strSearch - the search string to replace - Required
    //strReplace - the string to replace search string - Required
    //str - the domain string - string where the replacement will be done (Array Allowed) - Required
    //NB - if str is array, will perform replace on all item of str recursively and return array of replaced string
        return _.Engine.Replace(strSearch,strReplace,str);
    },

    //Get the textContent / value of an html element as required
    //Globalized (objs.Text)
    //#_.Text
    Text:function(objs,set,optionval){
    //objs - the object to get its textContent or value (string - classname, id, tagname, css selector | object - DOM Object | array - array items could be string,object or both) - Required
    //set - if set, set the textContent or value(input) of the objs
    //optionval - hold a flag indicating if the option value is to be gotten or the textcontent (true or false)
     return _.Engine.Text(objs,set,optionval);
    },

    //Get the value of an html element as required (specifically for select element)
    //Globalized (objs.Value)
    //#_.Value
    Value:function(objs,set){
        //objs - the object to get its textContent or value (string - classname, id, tagname, css selector | object - DOM Object | array - array items could be string,object or both) - Required
        //set - if set, set the textContent or value(input/select) of the objs
        set = typeof set == _.UND?null:set;
         return _.Engine.Text(objs,set,true);
        },


    //Specific Function that checks type using the CheckType function
    //----------------------------------------
    //IsArray return true if obj is array
    //#_.IsArray 
    IsArray:function(obj){return (_.Engine.CheckType(obj) == "array")?true:false;},
    //IsString return true if obj is string
    //#_.IsString
    IsString:function(obj){return (_.Engine.CheckType(obj) == "string")?true:false;},
    //IsNumber return true if obj is numeric
    //#_.IsNumber
    IsNumber:function(obj){return (_.Engine.CheckType(obj) == "number")?true:false;},
    //IsObject return true if obj is object or html element
    //#_.IsObject
    IsObject:function(obj){var rtn = _.Engine.CheckType(obj);return (rtn == "object" || rtn == "element")?true:false;},
    //IsFunction return true if obj is a function
    //#_.IsFunction
    IsFunction:function(obj){return (_.Engine.CheckType(obj) == "function")?true:false;},
    //IsNull return true if obj is null
    //#_.IsNull
    IsNull:function(obj){return (obj == null)?true:false;},
    //IsElement return true if obj is an html element
    //#_.IsElement
    IsElement:function(obj){return (_.Engine.CheckType(obj) == "element")?true:false;},

    //IsFound, use to determine if Finder found element
    //Globalized (finderObj.Found())
    //#_.IsFound
    IsFound:function(finderobj){
       // alert(finderobj);
    return _.IsArray(finderobj) && finderobj.length == 0?false:true;
    },


    //Trim trailing or leading character from a string
    //-----------------------------------------------
    //obj - represent the object/String to trim (string,number,DOM object) (Array allowed) - Required
    //NB - if DOM object, will get the textContent or value(input) and return the trimed string
    //NB - if obj is array, the trim operation will be perform on all items of the array and return array of the trimed item

    //n - represent the number of character or string to trim (Array allowed)
    //NB - if n is not sent - trim spaces
    //NB - if n is an array, use each value of n and perform trim on the main string as required

    //trim leading and trailing character
    //Globalized (obj.Trim(n))
    //#_.Trim #Trim
    Trim:function(obj,n){return _.Engine.StrTrimDir(obj,n)},

    //trim leading characters
    //Globalized (obj.Trim(n))
    //#_.TrimLeft #TrimLeft
    TrimLeft:function(obj,n){return _.Engine.StrTrimDir(obj,n,'l')},

    //trim trailing characters
    //Globalized (obj.Trim(n))
    //#_.TrimRight #TrimRight
    TrimRight:function(obj,n){return _.Engine.StrTrimDir(obj,n,'r')},


    //Aim Template (Template.Add - add template, Template.Fill - fill a template with data and return the result)
    //#_.Template 

    //#_.Template.Add(TID,TemplateStr) - add a template string to aim template lookup
    //TID - the key of the template string in Aim.Engine.Template object
    //TemplateStr - string containing placeholder(optional) to be filled
    //NB - if TIB alredy exist in _.Template, will overwrite

    //#_.Template.Fill - fill the template whose key is supplied with data
    //TID - the key of the template string in Aim.Engine.Template object
    //FillData - the object containing key=>data to fill, (key-placeholder name, data - data to replace)
    Template:_.Engine.Template,

    //Check Phone number (returns true or false)
    //Globalized (number.IsPhoneNumber(mindigit,maxdigit))
    //#_.IsPhoneNumber
    IsPhoneNumber:function(number,mindigit,maxdigit){
        //number - the number to check its validity (Array Allowed) - Required
        //NB - if number is an array, check if all the items of the array are valid phone number
        //NB - if number is DOM object, perform check on its textContent / value(input)
        //mindigit - minimum number of of digit expected - default => 6
        //maxdigit - maximum number of of digit expected - default => 15
       return _.Engine.ChkPhoneNum(number,mindigit,maxdigit);

       
       
    },

    //Check Email Address (return true or false)
    //Globalized (obj.IsEmail())
    //#_.IsEmail
    IsEmail:function(obj){
        //obj - holds the user sent email (string, object) (Array Allowed) - Required
        //NB - if obj is array, will check if all obj items are valid email address recursivly
        //NB - if obj is object, will get the textContent / value(input) and check if valid email
        return _.Engine.ChkEmail(obj);
    },

    //Check Date
    //#_.IsDate
    IsDate:function(dt){
      return _.Engine.IsDate(dt);
    },
    //check if IE 11 or older
    IsIE:function() {
        var ua = window.navigator.userAgent; //Check the userAgent property of the window.navigator object
        var msie = ua.indexOf('MSIE '); // IE 10 or older
        var trident = ua.indexOf('Trident/'); //IE 11
    
        return (msie > 0 || trident > 0);
    },
   //Check Year
    //#_.IsYear
    IsYear:function(dt){
        return _.Engine.IsYear(dt);
      },
    //Checks if an array , object, Dom Element, string contain items
    //Globalized (obj.HasItem(strict))
    //#_.HasItem
     HasItem:function(obj,strict){
      //obj - the object to check if it contain items in it - Required
     //strict - ignore spaces while counting string character and count elements (not nodes) while counting dom object items - Default - true
       return _.Engine.HasItem(obj,strict);
     },

     //Checks if an array , object, Dom Element, string does not contain items
     //#_.IsEmpty
     IsEmpty:function(obj,strict){
        //obj - the object to check if it does not contain items in it - Required
       //strict - ignore spaces while counting string character and count elements (not nodes) while counting dom object items - Default - true
         return !_.Engine.HasItem(obj,strict);
       },

     //Check if search item exist in base item
     //Return the index of searchitem in baseItem if found, else return false
     //note if searchitem not found inside the first children(generattion) for deep search, return the heirachical indexes seperated with inderscore e.g 1_2_1
     
     //#_.InItem
     InItem:function(baseItem,searchItem,deep){
         //baseItem - the item(search domain) where search will be done - Required
         //searchItem - the item to search for in baseItem - Required
         //deep - if a deep search will be done, i.e if not exist in the first child item, further search inside each first child item and so on. (default - false)
         //Type Senerios
         //1. baseItem=>Array, searchItem=>anytype(string,object)
         //search if the item exist in array
         //2. baseItem=>String, searchItem=>String(Char)
         //check if searchItem-string exist in baseItem-string
         //3. baseItem=>String, searchItem=>Object
         //check if searchItem-object's Text(textContent or value(input)) exist in baseItem-string
         //4. baseItem=>String, searchItem=>Array
         //check if all searchItem-Array element(each array element could be string or object) exist in baseItem-string
         //5. baseItem=>Object, searchItem=>String(Char)
         //check if searchItem-string exist in any of baseItem-object's children(Text(textContent/value))
         //6. baseItem=>Object, searchItem=>Object
         //check if searchItem-object exist in baseItem-object
         return _.Engine.InItem(baseItem,searchItem,deep);
     },

     //InItem (Alias)
     //Globalized (baseitem.Contains(searchitem,deep))
     //#_.Contains
     Contains:function(baseItem,searchItem,deep){
        return _.Engine.InItem(baseItem,searchItem,deep);
     },

     //Globalized (searchitem.In(baseitem,deep))
     //#_.In
     In:function(baseItem,searchItem,deep){
        return _.Engine.InItem(baseItem,searchItem,deep);
     },


     //Combine all arguments as one array (i.e unified all arguments as one array)
     //#_.Merge
     Merge:function(){
       return _.Engine.Merge(arguments);
     },

     //Form an array without duplicate and invalid items (null, empty string and empty array)
     //Globalized (arr.Exact())
     //#_.Exact
     Exact:function(arr,strict){
        //arr - the array to remove all invalid item to form a new array - Required
        //strict - mode (true - remove duplicate, null empty string; false(default) - duplicate only)
        return _.Engine.ArrayExact(arr,strict);
     },

     //UNION Operation on Arrays
     //NB- null and empty string will be removed
    //#_.Union
    Union:function(){
        return _.Engine.Merge(arguments).Exact(true);
    },

    //Peform Intersection on array elements sents as arguments
    //#_.Intersect
    Intersect:function(){
        return _.Engine.Intersect(arguments);
    },

    //Performe Difference operation on array elements sents as arguments
    //#_.Difference
    Difference:function(){
     return _.Engine.Difference(arguments);
    },

    //Walk through every element of the suplied object runing a perticular function on each element
    //Globalized (elemarr.Walk(funct,passval))
    //#_.Walk
    Walk: function(elemarr,funct,passval){
        //elemarr => the array/object/element to loop through - Required
        //funct => the function to perform on each item of the array/object/element
        //paassval => holds value that will be passed to the function, hense can be used in function for all items of the array/element/object
        //NB: the signature of argument recieved by funct is
        //funct(key,item,passval)
       _.Engine.Walk(1,elemarr,funct,passval);
    },


     //Globalized (elemarr.Each(funct,passval))
    //#_.Each
    Each: function(elemarr,funct,passval){
        //Walk description applicable
        //NB: the signature of argument recieved by funct is
        //funct(item,passval,key)
        _.Engine.Walk(2,elemarr,funct,passval);
     },

      //Globalized (elemarr.Each(funct,passval))
    //#_.Loop
    Loop: function(elemarr,funct,passval){
         //Walk description applicable
         //NB: the signature of argument recieved by funct is
        //funct({Item:item,Key:key,Param:passval})
        _.Engine.Walk(3,elemarr,funct,passval);
     },


     //Check if an element(s) is in a suplied class (class name)
     //Globalized (obj.InClass(classname))
     //#_.InClass
     InClass:function(obj,classN){
        //obj - holds the object/element to confirm if exist in class (classN) - Required
        //classN - the class name - Required
        //Check Senarios
        //1. obj => String/Element ; classN => String
        //Use aim finder on the obj(if string) to get the element(s) then check if it is in Class (classN)

        //2. obj => String/Element ; classN => Element
        //Check if obj-Element is in the same class with classN-Element

        //3. obj => String/Element ; classN => array
        //Check if obj is in the same class with any of classN item (if classN item is an Element) or if obj is in class (if classN item is a string)

        //4. obj => Array ; classN => any of the above
        //Perform the check on all item of obj-array
        //if any of obj item evaluate to false return false, else true

        return _.Engine.ClassNameIs(obj,classN);
     },

     //Covert String, Data String, object to array
     //Globalized (obj.ToArray(del,kvdel))
     //#_.ToArray
     ToArray:function(obj,del,kvdel,ktype){
       //obj the object/item to convert to array - Required
       //del - (for string convertion) if set use it to split the string to array
       //kvdel - (for string convertion where string contain key value pair) - holds the delimeter that seperates key and value in string 
       //keyType => the type of key to return
        //0=>Asscociate key ; 1=>Numeric key; 2=>Both(default)
       return _.Engine.ToArray(obj,del,kvdel,ktype);
     },
//Covert Number to Money, curency (only default format alowed)
     //Globalized (obj.ToMoney())
     //#_.ToMoney
     ToMoney:function(obj,addzero){
        //obj the object/item to convert to array - Required
        //del - (for string convertion) if set use it to split the string to array
        //kvdel - (for string convertion where string contain key value pair) - holds the delimeter that seperates key and value in string 
        //keyType => the type of key to return
         //0=>Asscociate key ; 1=>Numeric key; 2=>Both(default)
        return _.Engine.ToMoney(obj,addzero);
      },
//Covert CSS Rule String to array using ToArray method
     //Globalized (css.ToStyleArray())
     //#_.ToStyleArray
     ToStyleArray:function(css){
       //css the css rule string/Element style to convert to array - Required
       css = _.IsElement(css)?css.style.cssText:css;
       //alert(css); 
       if(!_.IsString(css) || _.Trim(css) == ""){
         return [];
       }
       //keyType is 1=Associate key only
       return _.Engine.ToArray(css,";",":",0);
     },

     
//Covert Data String to array using ToArray method
     //Globalized (css.ToDataArray())
     //#_.ToDataArray
     ToDataArray:function(data){
        //data - the data string to convert to array - Required
        data = _.IsElement(data)?_.Text(data):data;
        //alert(css); 
        if(!_.IsString(data) || _.Trim(data) == ""){
          return [];
        }
        return _.Engine.ToArray(data,"&","=",0);
      },


      //Convert an object(assoc array) to a string
      //Globalized (obj.ToString(objdel,kvdel))
     //#_.ToString
      ToString:function(obj,objdel,kvdel){
          //obj => hold the object/item to convert to string - Required
          //objdel(String) => holds the delimeter that joins all items of obj
          //kvdel(String) => holds the delimeter that joins individual items key and value
          return _.Engine.ToString(obj,objdel,kvdel);
      },

      //Convert Array or Object to Css String
      //Globalized (obj.ToStyleString())
     //#_.ToStyleString
    ToStyleString:function(obj){
        //obj => hold the object/item to convert to css string - Required
        return _.Engine.ToString(obj,";",":");
    },

     //Convert Array or Object to Data String
      //Globalized (obj.ToDataString())
     //#_.ToDataString
     ToDataString:function(obj){
        //obj => hold the object/item to convert to css string - Required
        return _.Engine.ToString(obj,"&","=");
    },

    //Set the syle of an element
    //NB: note will not overwrite existing style will only update and insert if not exist
    //Globalized (elem.Style(sty))
    //#_.Style
    Style:function(elem,sty){
        //elem => the element(s) to set its style attribute (Array Allowed) -Required
    //NB: if elem is String - uses aim finder to get the element(s)
    //sty => the css rule to set -Required
    //NB: Style method updates rules or insert rules if not exist, does not delete existing rules
       return _.Engine.SetStyle(elem,sty);
    },

    //Convert value to numeric type
    //Globalized (val.ToNumber(type))
//#_.ToNumber
 ToNumber: function(val, type){
    //val => the value to convert (Array Allowed) -Required
    //type => the numeric type to convert to
    //1=>float Number(default); 2=>Integer Numbers
    //NB: if convertion failed, 0 is returned
    return _.Engine.ToNum(val,type); 
 },

 //Conver value to float
 //Globalized (val.ToFloat())
 //#_.ToFloat
 ToFloat:function(val){
     //ToNumber Description Applicable
   return  _.Engine.ToNum(val);
 },

 //Conver value to float
 //Globalized (val.ToInteger())
 //#_.ToInteger
 ToInteger:function(val){
    //ToNumber Description Applicable
   return _.Engine.ToNum(val,2);
},

//Function to get / set attribute of elements and javascript objects
//Globalized (obj.Attribute(attr,value))
//#_.Attribute
Attribute:function(obj,attr,value){
    //obj => the element to set -Required (Array Allowed)
    //attr => Attribute Name -Required
    //value => the attribute value to set
   // alert(obj)
    return _.Engine.Attr(obj,attr,value);
},

//Function to break down a valid url into the individual component
//returns object containing -
//{Hash:"the hash part",Data:"the get data part",Url:"the real url without hash and data part",File:"the file name",Host:"host name",Ext:"the file extention",Port:"the host port"}
//Globalize (url.UrlSplit())
//#_.UrlSplit #Url #split #urlsplit
UrlSplit:function(url){
    //url => the url to split
    return _.Engine.Url.Resolve(url);
},

//Url Object - perform all url manipulations, including url hash history system
//#_.Url
Url:_.Engine.Url,

//Cookie Management
 //#_.Cookie
 Cookie:function(name,value,expire){
     //name => the cookie name to set or get - Required
     //value => the value to set
     //expire => the expiring datetime

     //if value not sent (it is a Get operation)
     //if value sent (it is a set and get opertaion)
     if(_.IsEmpty(name) || !_.IsString(name))return;

     //if value not sent perform a get operation only
     if(typeof value == _.UND || value == null){
       return _.Engine.Cookie.Get(name);
     }

     //perform set operation
     value = _.IsElement(value)?_.Text(value):value.toString();
     _.Engine.Cookie.Set(name,value,expire);
     return _.Engine.Cookie.Get(name);
 },

 //Handle Random Number and String generation
 //#_.Random
 Random:function(max,charset){
  //maxLen => Represent the maximum number of character to generate (Default = 1)
  //charset => a string containing characters to be used for generation (Default = all alphabet (lower and upper))
  return _.Engine.Rand.String(max,charset);
 },
 //#_.RandomNumber
 RandomNumber:function(max){
    //maxLen => Represent the maximum number to generate (Default = 1)
    return _.Engine.Rand.Number(max);
 },

 //Get or Generate new id if not exist of an element
 //Globalized (obj.ID())
 //#_.ID
 ID:function(obj){
     //obj => the element (Array Allowed) -Required
     return _.Engine.GetId(obj);
 },

 //The File Browse method
 //#_.Browse
 Browse:function(param){
   //param - local file browsing parameters - Object
   //*FObject - the object to load the file into
        //*FileID - the id of the input file element that will be generated (must be unique);

        //* OnStart: function that will be executed on individual file selected before reading the file.
        //OnStart(param) - param =>all user set parameters + param.File,param.Index,param.Length

        //* OnLoad: function to run (individually) on selected file when read complete 
        //OnLoad(param) - param =>all user set parameters + param.File,param.Index,param.Length,param.Reader,param.Result

        //* OnError: function to run when error occur on individual file selected
        //OnError(param) - param =>all user set parameters + param.File,param.Index,param.Length,param.Error

        //* MinSize: the minimum file size allowed (in Byte)

        //* MaxSize: the maximum file size allowed (in Byte)

        //* Accept: the file type or extention allowed (File Element Accept attribute)

        //* Multiple: if multiple selection is allowed or not (true/false) 

        //* ReadType: the format file will be read, (Text, DataURL, ArrayBuffer, BinaryString, FileName) -Default => Text
  
       return  _.Engine.File.Local(param);
 },

  //global variable to hold each file Index
  GFilesParm:[],

 //Set the obj Attribute from a local file using Aim Browse method
 //Globallized - obj.Browse(params)
 //#_.BrowseSetFile #BrowseSetFile
 BrowseSetFile:function(obj,objparam){
    
     //obj => the object to load with data from the client system

     //objparam => User defined parameters
     
     //1. SetAttribute => the obj attribute to set with the read data.
     //Default: image => src, others => aim.Text()
     //2. ReadType: the format file will be read as (Aim Browse ReadTypes)
     //Default: image => DataURL, others => FileName
     //3. Accept: the type of file to filter out in dialog display (File element Accept Attribute)
     //Default: image => "image/*", all file
     //4. MaxSize => the maximum allowed file size
     //Default: any size
     //5. MinSize => the minimum allowed file size
     //Default: any size
     //6. Multiple => determine if multiple item selection is allowed (true/false)
     //Default: if obj is more than 1(array of obj)=> true, if one obj to set=> false
     //NB: if obj is more than one and client item selected is more than one, will automatically set individual client selection to individual obj
     //7. OnLoad => the method to call when obj is set successfully
     //OnLoad(Aim Browse OnLoad Param + Param.Element-the element to set)
     //NB: if image: onload is called when the image set has completely loaded in the image element
     //8. OnStart => the method to call when the reading/setting operation starts 
     //OnStart(Aim Browse OnStart Param + Param.Element-the element to set)
     //9. FileID => the id of the newly created file input element
     
     obj = _.Engine.RP(obj);
     objparam = typeof objparam == _.UND?{}:objparam;
     //get the first file selected
     var fobj = _.IsArray(obj)?obj[0]:obj;
     //the object attribute to set
     var objattr = typeof objparam.SetAttribute == _.UND?"":objparam.SetAttribute;
     //the read DataType to use
     var objreadDataT = typeof objparam.ReadType == _.UND?"":objparam.ReadType;
     
     //the accept file type
     if(typeof objparam.Accept == _.UND){
        objparam.Accept = _.IsElement(fobj) && fobj.tagName.toLowerCase() == 'img'?"image/*":"";
     }
     //
     //var readType = 
     //if multiple image to set
     if(_.IsFound(obj)){
        return _.Browse({
             FObject:obj, //the object to load data into (Array Allowed)
             FileID:typeof objparam.FileID == _.UND?"":objparam.FileID,
              //Maximum File size allowed (default - any size)
             MaxSize:typeof objparam.MaxSize == _.UND?0:objparam.MaxSize,
              //Minimum File size allowed (default - 0)
             MinSize:typeof objparam.MinSize == _.UND?0:objparam.MinSize,
             OReadType:objreadDataT,
            //Multiple Selection (default - false)
             Multiple:typeof objparam.Multiple == _.UND?_.IsArray(obj)?true:false:objparam.Multiple,
             //OnFinish is use to send user defined Onload to method
             OnFinish:typeof objparam.OnLoad == _.UND?function(){}:objparam.OnLoad,
             //OnBigin use to send user define OnStart to method
             OnBigin:typeof objparam.OnStart == _.UND?function(){}:objparam.OnStart,
             //Type of file type to filter or display by the browse dialog (default - all)
             Accept:objparam.Accept,
             //The Element Attribute to set
             ObjectAttr:objattr,
             //OnFailed use to send user defined OnError Method
             OnFailed:typeof objparam.OnError == _.UND?function(){}:objparam.OnError,
             //OnStart Aim Browse OnStart Method (will run OnBigin in it)
             OnStart:function(param){ //the operation/action to perform before reading the file from client system
                //get the current object to set
                
                 var curobj = _.IsArray(param.FObject)?param.FObject[param.Index]:param.FObject;
                 var curobjID = _.ID(curobj);
                
                 //if the current object is an image or object element, set the read type to DataURL
               if(_.IsElement(curobj) && (curobj.tagName.toLowerCase() == 'img' || curobj.tagName.toLowerCase() == 'object')){
                //force the ReadType to be DataUrl if not set
                 _.Engine.File.Param[param.File.id].ReadType = _.Trim(param.OReadType) == ""? "DataURL":param.OReadType;
                
               }else{
                 //force the ReadType to be FileName if not set
                 _.Engine.File.Param[param.File.id].ReadType = _.Trim(param.OReadType) == ""? "FileName":param.OReadType; 
               }
               //Globally keep the index of the current file in a global array
            //Workaround for getting the loaded file index inside its onload handler if image or object
            if(typeof _.GFilesParm[curobjID] == _.UND){
                //set the current file index globally using the current element id as the key
                _.GFilesParm[curobjID] = param.Index;
            }
            //set the current params global as well
            _.Engine.File.Param[curobjID] = param;

              // run the user defined OnLoad Method( sent as OnBigin) sending the following parameters as an object Element,Index,File and Type
               param.OnBigin({Element:curobj,Index:param.Index,File:param.File,Type:param.File.files[param.Index].type});//User define function (OnStart)
              
               
             },
             //Aim Browse OnLoad Handler
             OnLoad:function(paramu){
                 
                var curobj = _.IsArray(paramu.FObject)?paramu.FObject[paramu.Index]:paramu.FObject;
                //get the current elements tagname
                var tgn = curobj.tagName.toLowerCase();
                //if the current object ia an image, set the src attribute
                if(_.IsElement(curobj) && (tgn == 'img' || tgn == 'object')){
                    var tgNAttr = {'img':'src','object':'data'}
                    var nattr = _.Trim(paramu.ObjectAttr) == ""?tgNAttr[tgn]:paramu.ObjectAttr
                    if(nattr == "data" || nattr == "src"){
                        var dofinish = true;
                        //keep the current image id and the parameter details in the global param array object for use in the image onload event handler
                        //var curobjID = _.ID(curobj);
                       // _.Engine.File.Param[curobjID] = param;
                       //alert(typeof curobj.onload)
                       if(typeof curobj.onload != _.UND){ //if the current element curobj supports onload event handlers
                        curobj.onload = function(){
                            var obj = {};
                            obj.Element = this;
                            obj.Index = _.GFilesParm[this.id];
                            obj.File = _.Engine.File.Param[this.id].File;
                            obj.Type = obj.File.files[obj.Index].type
                            
                             _.Engine.File.Param[this.id].OnFinish(obj);    
                        }
                        dofinish = false;
                      }
                      
                        //_('ee').innerHTML += '<br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><p style="color:green">'+paramu.Result+'</p>';
                        curobj[nattr] = paramu.Result;
                        if(dofinish){
                            paramu.OnFinish({Element:curobj,Index:paramu.Index,File:paramu.File,Type:paramu.File.files[paramu.Index].type})
                        }
                        
                    }else{
                        curobj[paramu.ObjectAttr] = paramu.Result;
                        //param.Element = curobj;
                        paramu.OnFinish({Element:curobj,Index:paramu.Index,File:paramu.File,Type:paramu.File.files[paramu.Index].type});
                    }
                    
                }else{ //others set thier Text (value or textContent)
                    
                    if(_.Trim(paramu.ObjectAttr) == ""){ //if no attribute
                    _.Text(curobj,paramu.Result); //set the Text
                    }else{ //if attribute exist, set the attribute
                    curobj[paramu.ObjectAttr] = paramu.Result;
                    }
                    paramu.Element = curobj;
                    paramu.OnFinish({Element:curobj,Index:paramu.Index,File:paramu.File,Type:paramu.File.files[paramu.Index].type});
                }
                
             },
             //Aim Browse OnError Method (will run the User define OnError Method(OnFailed) if set)
             OnError:function(params){
              var curobj = _.IsArray(params.FObject)?params.FObject[params.Index]:params.FObject; //get the current obj
              //get the current elements tagname
              var tgn = curobj.tagName.toLowerCase();
               //Get the current file type
               var type =params.File.files[params.Index].type;
               //if user defined OnError is set (sent as OnFailed) run it sending an object of Element,File,Index,Type and Error
               if(typeof params.OnFailed != _.UND && params.OnFailed != null){
                  params.OnFailed({Element:curobj,File:params.File,Index:params.Index,Error:params.Error,Type:type});
                  return
               }
  
               //if no user defined Error handler sent
               
                  if(tgn == "img"){ //if type image
                    curobj.alt = params.Error;
                  }else if(tgn == "object"){ //if type object
                    curobj.alt = params.Error;
                    curobj.standBy = params.Error;
                  }else{ //others
                      _.Text(curobj,params.Error);
                      
                  }
  
              
  
             }
             
         });
     }
     return null;
 },



 //Browse file from client local system and load it with the appropriate html element to display it in the main container
 //for individual file, template can be set (uses aim Template Object)
 //Globalize mcont.BrowseInto(params)
 //#_.BrowseInto
 BrowseInto:function(mcont,param){
     //mcont: the html element to load with user selected/browsed files
     //NB: if container(mcont) object is array the first is used
     //param: is same as _.Browse Method + param.TemplateID
    //NB: the OnLoad,OnStart,OnError handler recieve object with the following attributes
    //1. Index=> the curent file index of the files selected loaded into the mcont
    //2. File=> the file object (Element) dynamically created by aim
    //3. Element=> the element representin the file loaded (if image:img(src), text:p(innerHTML), others:object(data))
    //4. Type => the type of the current file loaded (file element file type)
    //5. Error (for OnError only) => the eroor string

    //set defaults
     mcont = typeof mcont == _.UND || mcont == null?document.body:mcont;
     param = typeof param == _.UND?{}:param;
     param.TemplateID = typeof param.TemplateID == _.UND?"":param.TemplateID;
   
     //Use Aim Browse Method
     _.Browse({
         //ID of the newly created file input element
        FileID:typeof param.FileID == _.UND?"":param.FileID,
         //The Container to load the files into
        Container:_.Engine.RP(mcont),
        //Multiple Selection (default - false)
        Multiple:typeof param.Multiple == _.UND?false:param.Multiple,
        //Type of file type to filter or display by the browse dialog (default - all)
        Accept:typeof param.Accept == _.UND?"":param.Accept,
        //Maximum File size allowed (default - any size)
        MaxSize:typeof param.MaxSize == _.UND?0:param.MaxSize,
        //Minimum File size allowed (default - 0)
        MinSize:typeof param.MinSize == _.UND?0:param.MinSize,
        //Individual file html template id
        TemplateID:param.TemplateID,
        //OnFinish is use to send user defined Onload to method
        OnFinish:typeof param.OnLoad == _.UND?function(){}:param.OnLoad,
        //OnBigin use to send user define OnStart to method
        OnBigin:typeof param.OnStart == _.UND?function(){}:param.OnStart,
        //OnFailed use to send user defined OnError Method
        OnFailed:typeof param.OnError == _.UND?null:param.OnError,
        //OnStart Aim Browse OnStart Method (will run OnBigin in it)
        OnStart:function(params){
            //get the current file type
            var type =params.File.files[params.Index].type;
            //always use the first container element if multiple container is sent
            params.Container = _.IsArray(params.Container)?params.Container[0]:params.Container;
         //if it is the first (clear the container)
          if(params.Index == 0){
            params.Container.innerHTML = "";
          }
            //if the place holder not exist
            if(!_.IsFound(_(params.File.id+params.Index))){
            if(_.Trim(type) != ""){//if can identify type
                //break the type string
                var types = type.split("/")[0].toLowerCase();
                if(types == "text"){ //if type is a text file
                    //Change the Aim Browse ReadType to ReadAsText
                   _.Engine.File.Param[params.File.id].ReadType = "Text";
                   //Set the html elemnt (placeholder) that will display the file (Text - p element)
                   var wraper = '<p id="'+params.File.id+params.Index+'"></p>';
                }else if(types == "image"){//if type is image
                   //Set the html elemnt (placeholder) that will display the file (Image - img element)
                   var wraper = '<img id="'+params.File.id+params.Index+'" src="" alt="Loading.."/>';
                   //Change the Aim Browse ReadType to ReadAsDataURL
                   _.Engine.File.Param[params.File.id].ReadType = "DataURL"; 
                }else{//if type is any other element (try load it using html object element(placeholder))
                   var wraper = '<object id="'+params.File.id+params.Index+'" data="" alt="Loading.." standby="Loading.." />';
                   //Change the Aim Browse ReadType to ReadAsDataURL
                   _.Engine.File.Param[params.File.id].ReadType = "DataURL"; 
                }
            }else{
                //if cannot identify type
                //Read/Set as Text 
               _.Engine.File.Param[params.File.id].ReadType = "Text";
               var wraper = '<p id="'+params.File.id+params.Index+'"></p>';
            }
        }

            //Globally keep the index of the current file in a global array
            //Workaround for getting the loaded file index inside its onload handler if image or object
            if(typeof _.GFilesParm[params.File.id+params.Index] == _.UND){
                //set the current file index globally using the combination of the file element id and the curent index (which is also the placeholder html element id) as the key
                _.GFilesParm[params.File.id+params.Index] = params.Index;
            }
            //set the current params global as well
            _.Engine.File.Param[params.File.id+params.Index] = params;
            
            //If template ID is sent
            if(params.TemplateID != ""){
                //set the current html placeholder in an object (using the template id as key) - to be used to file the user created template
                var objpar = {};
                objpar[params.TemplateID] = wraper;
                //Fill the template and include the resultance html to the container element
                params.Container.insertAdjacentHTML('beforeend',_.Template.Fill(params.TemplateID,objpar));
                
            }else{
                //if no template to be use, just append the place holder to the container elements
               params.Container.insertAdjacentHTML('beforeend',wraper);
            }
            //if user defined OnStart is set (sent in as OnBigin) run it sending the Element,Index,Type and File as an object
            params.OnBigin({Element:_(params.File.id+params.Index),Index:params.Index,File:params.File,Type:params.File.files[params.Index].type});
           },
           //Aim Browse OnLoad Method (will run the User define OnLoad Method(OnFinsih) if set)
           OnLoad:function(params){
               //Get the current file type
               var type =params.File.files[params.Index].type;
               var curobj = _(params.File.id+params.Index); //get the current file placeholder
               //if can identify the type
               if(_.Trim(type) != ""){
                   var types = type.split("/")[0].toLowerCase();
                   if(types == "text"){ //if a text file
                    //set the innerHTML of the placeholder(p element) by it id (which was set as the combination of the file id and the current file index) to the reader result (read as Text)
                    curobj.innerHTML = params.Result;
                       //if user defined OnLoad is set (sent in as OnFinish) run it sending the Element,Index and File as an object
                       params.OnFinish({Element:curobj,Index:params.Index,File:params.File});
                    }else if(types == "image"){ //if file is an image
                        //Set the onload handler for the image
                        //forcing the User defined OnLoad(sent as OnFinish) method to run when image loads completely
                       curobj.onload = function(){
                          var obj = {};
                          obj.Element = this;
                          obj.Index = _.GFilesParm[this.id];
                          obj.File = _.Engine.File.Param[this.id].File;
                          obj.Type = obj.File.files[obj.Index].type
                         //if user defined OnLoad is set (sent in as OnFinish) run it sending the Element,Index and File as an object
                           _.Engine.File.Param[this.id].OnFinish(obj)
                       }

                       //set the src of the placeholder(img element)(which was set as the combination of the file id and the current file index) to the reader result (read as DataURL)
                       curobj.src = params.Result;
                    }else{
                        //if type of file selected is not text and image, i.e an object element is created to load the file. Hense, set the data attribute
                       var dofinish = false;
                        //if the html object onload handler is supported
                       if(typeof curobj.onload != _.UND){
                           //set the onload andler, same as that of image type
                        curobj.onload = function(){
                           var obj = {};
                           obj.Element = this;
                           obj.Index = _.GFilesParm[this.id];
                           obj.File = _.Engine.File.Param[this.id].File;
                           obj.Type = obj.File.files[obj.Index].type
                            _.Engine.File.Param[this.id].OnFinish(obj);
                        }
                        dofinish = false;
                       }
                           
                       
                       //set the curent html object element data attribute to the reader result (read as DataURL)
                        curobj.data = params.Result;
                        if(dofinish){
                           //if curobj.onload not supported just run the OnFinish sending required parameter
                           params.OnFinish({Element:curobj,Index:params.Index,File:params.File,Type:params.File.files[params.Index].type});
                        }
                     
                       
                    }
                }else{
                    //if cannot identify type, just insert the plain text as innerhtml of the created p element and run the user defined OnLoad method (sent as OnFinish)
                   curobj.innerHTML = params.Result;
                   params.OnFinish({Element:curobj,Index:params.Index,File:params.File,Type:params.File.files[params.Index].type});
                }
             return;
           },
           //Aim Browse OnError Method (will run the User define OnError Method(OnFailed) if set)
           OnError:function(params){
            var curobj = _(params.File.id+params.Index); //get the current file placeholder
            if(_.IsFound(curobj)){
             //Get the current file type
             var type =params.File.files[params.Index].type;
             //if user defined OnError is set (sent as OnFailed) run it sending an object of Element,File,Index and Error
             if(typeof params.OnFailed != _.UND && params.OnFailed != null){
                params.OnFailed({Element:curobj,File:params.File,Index:params.Index,Error:params.Error,Type:params.File.files[params.Index].type});
                return
             }

             //if no user defined Error handler sent
             if(_.Trim(type) != ""){ //if can identify type
                type = type.split('/')[0];
                if(type.toLowerCase() == "text"){ //if type text
                    curobj.innerHTML = params.Error;
                }else if(type.toLowerCase() == "image"){ //if type image
                    curobj.alt = params.Error;
                }else{ //if type is object
                    curobj.alt = params.Error;
                    curobj.standBy = params.Error;
                }
             }else{ //if cannot identify type
                curobj.innerHTML = params.Error;  
             }

            }

           }
    });
 },

 //Get the fit size of a dimention in a given containing dimention
 //#_.FitSize
 FitSize:function(padW,padH,width,height){
    //padW - the containers width 
    //padH - the containers height 
    //width - the width to recalculate
    //height - the height to recalculate
    //margin - margin around the fit dimension(element)
    //if the allowable space arround the ajusting dimention and the containing dimention
   return _.Engine.GetFitSize(padW,padH,width,height)
 },

 //get the dimention of an element
 //Globalized elem.Dimension
 //_.Dimention(elem)
 Dimension:function(elem){
     return _.Engine.GetDimension(elem);
 },

 //make an element fits into the parent element
 //Globalize elem.Fit(pelem)
 //#_.Fit
 Fit:function(elem,pelem){
     //NB:if elem or pelem css display is set to none (_.Hide), the width and height will be zero, use visibility (_.Disappear) instead
     //elem => the element to recalclate dimension base on the pelem
     //margin => the margin around the elem after  recalculaton (default => 0)
     //pelem =>the container or parent of the element to recalculate dimition(elem) - (default = the elem parent Element)
    pelem = typeof pelem == _.UND?elem.parentElement:pelem

    

     
     elem = _.Engine.RP(elem);
     pelem = _.Engine.RP(pelem);

     //get both element and the container's dimension
     var elemdime = _.Engine.GetDimension(elem);
     var pelemdim = _.Engine.GetDimension(pelem);
     
     //get the fit size
     var fitsi = _.FitSize(pelemdim.width,pelemdim.height,elemdime.width,elemdime.height);
     //reset element size
     elem.style.width = fitsi.Width+"px";
     elem.style.height = fitsi.Height+"px";
     

     return fitsi;
     
 },
 //Screen object
 Screen:_.Engine.ScreenMgr,

 //Make an element draggable
 //Globalized elem.Draggable(param)
 //#_.Draggable(elem,param)
 Draggable:function(elem,param){
     //elem => the element(s) to move when dragging (Array Allowed)
    //param
    //1. Handle => the element that user will click or drag to drag the obj.
    //NB: Handle is recormended to be inside obj
    //NB: if handle is not set the obj is used instead
    //2. MaximumX, MaximumY, MinimumX, MinimumY => use to set the maximum drag level of X and Y and the Minimum level of X and Y respectively
    //NB: if the mouse cursur moves beyond or below the limit level the drag operation will be terminated
    //3. Restricted: the confined drag area (usualy an element containing the drag element)
    //NB: if set as true will use the drag elment parentElement
    //NB: aim finder selector string is allowed
    //4. Direction: the direction of dragging ('Both'-default, X- move withen X axis only, Y- move withen Y axis only)
    //5. OnStart => event to trigger when drag starts (when mouse is press down for dragging). recieve (Element-moving element, ClientX and ClientY-current mouse loation) as argurment
    //6. OnDrag => event handler to be trigger durring drag. receive (Element,Top,Left)
    //7. OnFinsh => event handler to be trigger when drag ends (when mouse is released or drag is force to stop. receive (Element)
   _.Engine.Drag.Element(elem,param);
 },

 //get the key details of the event key
 //#_.KeyDetails
 KeyDetail:function(e){

    return _.Engine.Keyboard.KeyPress(e);
 },
 //assign an event handler to element(s)
 //Globalized element.Assign(eventName,handler,once)
 //#_.Assign
 Assign:function(eventName,element,handler,once){
    //eventname => the name of the user event (on prefix not required) - Required
    //element => The DOM element to attach event handler to -Required
    //handler => the function to run when user triggers the event
    //once => determine if the event handler is to be run once i.e after running remove attahced event handler
  _.Engine.Handlers.Assign(eventName,element,handler,once);
 },
 //unassign an event handler from element(s)
 //Globalized element.UnAssign(eventName,handler)
 //#_.UnAssign
 UnAssign:function(eventName,element,handler){
    //eventname => the name of the user event (on prefix not required) - Required
        //element => The DOM element to remove/detach event handler -Required
        //handler => the handler to remove
        //NB: if no handler sent, remove all element handlers
  _.Engine.Handlers.Assign(eventName,element,handler);
 },
//assign an event handler once to element(s)
//Run the event handlers onces
 //Globalized element.AssignOnce(eventName,handler)
 //#_.AssignOnce
 AssignOnce:function(eventName,element,handler){
    _.Engine.Handlers.Assign(eventName,element,handler,true);
 },

 //Convert HTML table to downloadable excel file
 //Globalize table.ToExcel(sheetname)
//#_.ToExcel
ToExcel:function(table,sheetname){
    //table => the html table element to export
    //NB: any supported aim finder selector can be use
    //NB: Array Allowed
    //sheetname => the name of the worksheet
   _.Engine.ToExcel(table,sheetname);

},
//Aim OnScroll Event Handler
//Globalize - obj.OnScroll(func)
//#_.OnScroll
OnScroll:function(func,obj){
     //obj => the object to assign a function to its onscroll event handler (Default - window)
    //NB: aim finder used 
    //func => the function to assign -Required
    _.Engine.Scroll.Attach(func,obj)
},
//Dom.Ready - loads the added function when dom loads completely
//#_.Ready
Ready:function(func,param){
 _.Engine.Dom.Ready(func,param);
},
//StopDefault - Stopd default effect of an element event
//#_.StopDefault
StopDefault:function(e){
   return _.Engine.StopDefault(e);
}

 


//###


});
//End Main Include- Basic Operation
/************************************************************ */


//Aim Ajax Method are included here
//#Ajax
_.Include({
 Post:function(param){
  var newaj = new _.Engine.Ajax();
  return newaj.Post(param);
 }
});

//Aim Animation Object Included here
//#Animation
_.Include({
    Animation:_.Engine.Animation,
    Timeline:_.Engine.Timeline,
    QuickAnimation:function(elem,param){
    if(typeof elem == _.UND)return;
    elem = _.Engine.RP(elem);
    if(!_.IsFound(elem))return;
     param = param || {};
     param.Target = elem;
      var eff = param.Effect || "FadeIn";
      var animNameType = "aim-Quick";
      if(typeof param.Name == _.UND || _.Trim(param.Name) == ""){
        if(_.IsString(eff)){
            animNameType += "-"+eff;
        }else{
            animNameType += "-Anim";
        }
        param.Name = animNameType + "-"+elem.ID;
      }
      
      var anim = typeof _.Engine.Animations[param.Name] == _.UND?new _.Animation(param):_.Engine.Animations[param.Name];
     
      anim.Play();
    },
    /*ZoomIn:function(elem){  
     _.QuickAnimation(elem,{Effect:"ZoomIn",
      Duration:0.8,OnStart:function(obj){obj.Target.Show()},OnEnd:function(obj){//obj.Target.Style = "transform: scale(0)"}});
    },
    ZoomOut:function(elem){  
     _.QuickAnimation(elem,{Effect:"ZoomOut",
      Duration:0.8,OnEnd:function(obj){obj.Target.Hide();//obj.Target.Style = "transform: scale(1)"}});
    },
    FadeIn:function(elem){  
     _.QuickAnimation(elem,{Effect:"FadeIn",
      Duration:0.8,OnStart:function(obj){obj.Target.Show()}});
    },
    FadeOut:function(elem){  
     _.QuickAnimation(elem,{Effect:"FadeOut",
      Duration:0.8,OnEnd:function(obj){obj.Target.Hide()}});
    },
    LeftIn:function(elem){  
     _.QuickAnimation(elem,{Effect:"LeftIn",
      Duration:0.8});
    },
    LeftOut:function(elem){  
     _.QuickAnimation(elem,{Effect:"LeftOut",
      Duration:0.8});
    },
    RightIn:function(elem){  
     _.QuickAnimation(elem,{Effect:"RightIn",
      Duration:0.8});
    },
    RightOut:function(elem){  
     _.QuickAnimation(elem,{Effect:"RightOut",
      Duration:0.8});
    },
    TopIn:function(elem){  
     _.QuickAnimation(elem,{Effect:"TopIn",
      Duration:0.8});
    },
    TopOut:function(elem){  
     _.QuickAnimation(elem,{Effect:"TopOut",
      Duration:0.8});
    },
    BottomIn:function(elem){  
     _.QuickAnimation(elem,{Effect:"BottomIn",
      Duration:0.8});
    },
    BottomOut:function(elem){  
     _.QuickAnimation(elem,{Effect:"BottomOut",
      Duration:0.8});
    }*/
})




//Making Functionality Global
//************************************************************ */
//Aim Finder
"_".Globalize(function(selector){return _.Engine.Finder.Find(selector,_.Engine.RP(This(this)))},[String,Object])

//_.Show()
/*String.prototype.Show = function(display){_.Show(this.toString(),display)}
Array.prototype.Show = function(display){_.Show(this,display)}
Object.prototype.Show = function(display){_.Show(this,display)}*/
"Show".Globalize(function(display){_.Show(This(this),display)},[String,Array,Object])


//_.Hide()
/*String.prototype.Hide = function(){_.Hide(this.toString())}
Array.prototype.Hide = function(){_.Hide(this)}
Object.prototype.Hide = function(){_.Hide(this)}*/
"Hide".Globalize(function(){_.Hide(This(this))},[String,Array,Object])

//_.ToggleShow()
String.prototype.ToggleShow = function(display){_.ToggleShow(this.toString(),display)}
Array.prototype.ToggleShow = function(display){_.ToggleShow(this,display)}
Object.prototype.ToggleShow = function(display){_.ToggleShow(this,display)}

//_.Appear()
"Appear".Globalize(function(){_.Appear(This(this))},[String,Array,Object])
//_.DisAppear()
"Disappear".Globalize(function(){_.Disappear(This(this))},[String,Array,Object]);
//_.Validate
"Validate".Globalize(function(){return _.Validate(This(this))},[String,Array,Object]);
//_.Cloner
"Cloner".Globalize(function(withevent,deep){return _.Cloner(This(this),withevent,deep)},[String,Array,Object]);
//_.ReplaceWith
"ReplaceWith".Globalize(function(newelwm){return _.ReplaceWith(This(this),newelwm)},[String,Array,Object]);

//_.ToggleAppear()
String.prototype.ToggleAppear = function(){_.ToggleAppear(this.toString())}
Array.prototype.ToggleAppear = function(){_.ToggleAppear(this)}
Object.prototype.ToggleAppear = function(){_.ToggleAppear(this)}

//_.Replace()
String.prototype.Replace = function(strSearch,strReplace){return _.Replace(strSearch,strReplace,this.toString());}
Number.prototype.Replace = function(strSearch,strReplace){return _.Replace(strSearch,strReplace,this);}

//_.Trim()
String.prototype.Trim = function(n){return _.Trim(this.toString(),n)}
Object.prototype.Trim = function(n){return _.Trim(this,n)}
Array.prototype.Trim = function(n){return _.Trim(this,n)}

//_.TrimLeft()
String.prototype.TrimLeft = function(n){return _.TrimLeft(this.toString(),n)}
Object.prototype.TrimLeft = function(n){return _.TrimLeft(this,n)}
Array.prototype.TrimLeft = function(n){return _.TrimLeft(this,n)}

//_.TrimRight()
String.prototype.TrimRight = function(n){return _.TrimRight(this.toString(),n)}
Object.prototype.TrimRight = function(n){return _.TrimRight(this,n)}
Array.prototype.TrimRight = function(n){return _.TrimRight(this,n)}

//_.Text()
"Text".Globalize({
    set:function(val){_.Text(This(this),val);},
    get:function(){return _.Text(This(this));}
},[Array,Object,String])

//_.Value()
"Value".Globalize({
    set:function(val){_.Value(This(this),val);},
    get:function(){return _.Value(This(this));}
},[Array,Object,String]);


//_.IsPhoneNumber()
String.prototype.IsPhoneNumber = function(mindigit,maxdigit){return _.IsPhoneNumber(this.toString(),mindigit,maxdigit)}
Object.prototype.IsPhoneNumber = function(mindigit,maxdigit){return _.IsPhoneNumber(this,mindigit,maxdigit)}
Array.prototype.IsPhoneNumber = function(mindigit,maxdigit){return _.IsPhoneNumber(this,mindigit,maxdigit)}
Number.prototype.IsPhoneNumber = function(mindigit,maxdigit){return _.IsPhoneNumber(parseInt(this),mindigit,maxdigit)}

//_.IsEmail
String.prototype.IsEmail = function(){return _.IsEmail(this.toString())}
Object.prototype.IsEmail = function(){return _.IsEmail(this)}
Array.prototype.IsEmail = function(){return _.IsEmail(this)}

//_.HasItem
String.prototype.HasItem = function(strict){return _.HasItem(this.toString(),strict)}
Object.prototype.HasItem = function(strict){return _.HasItem(this,strict)}
Array.prototype.HasItem = function(strict){return _.HasItem(this,strict)}

//_.IsEmpty
String.prototype.IsEmpty = function(strict){return _.IsEmpty(this.toString(),strict)}
Object.prototype.IsEmpty = function(strict){return _.IsEmpty(this,strict)}
Array.prototype.IsEmpty = function(strict){return _.IsEmpty(this,strict)}

//_.Contains
String.prototype.Contains = function(searchItem,deep){return _.Contains(this.toString(),searchItem,deep)}
Object.prototype.Contains = function(searchItem,deep){return _.Contains(this,searchItem,deep)}
Array.prototype.Contains = function(searchItem,deep){return _.Contains(this,searchItem,deep)}

//_.Contains (reused - In)
String.prototype.In = function(baseItem,deep){return _.Contains(baseItem,this.toString(),deep)}
Object.prototype.In = function(baseItem,deep){return _.Contains(baseItem,this,deep)}
Array.prototype.In = function(baseItem,deep){return _.Contains(baseItem,this,deep)}

//_.IsFound
"Found".Globalize(function(){_.IsFound(this)},[Array,Object])

//_.Walk
String.prototype.Walk = function(funct,passval){return _.Walk(this.toString(),funct,passval)}
Object.prototype.Walk = function(funct,passval){return _.Walk(this,funct,passval)}
Array.prototype.Walk = function(funct,passval){return _.Walk(this,funct,passval)}

//_.Each
String.prototype.Each = function(funct,passval){return _.Each(this.toString(),funct,passval)}
Object.prototype.Each = function(funct,passval){return _.Each(this,funct,passval)}
Array.prototype.Each = function(funct,passval){return _.Each(this,funct,passval)}

//_.Loop
String.prototype.Loop = function(funct,passval){return _.Loop(this.toString(),funct,passval)}
Object.prototype.Loop = function(funct,passval){return _.Loop(this,funct,passval)}
Array.prototype.Loop = function(funct,passval){return _.Loop(this,funct,passval)}

//_.Exact
Array.prototype.Exact = function(strict){return _.Exact(this,strict)}

//_.InClass
String.prototype.InClass = function(classN){return _.InClass(this.toString(),classN)}
Object.prototype.InClass = function(classN){return _.InClass(this,classN)}
Array.prototype.InClass = function(classN){return _.InClass(this,classN)}

//_.ToArray
String.prototype.ToArray = function(del,kvdel){return _.ToArray(this.toString(),del,kvdel)}
Object.prototype.ToArray = function(del,kvdel){return _.ToArray(this,del,kvdel)}

//_.ToMoney
Number.prototype.ToMoney = function(addzeros){return _.ToMoney(this,addzeros)}
String.prototype.ToMoney = function(addzeros){return _.ToMoney(this.toString(),addzeros)}

//_.ToStyleArray()
String.prototype.ToStyleArray = function(){return _.ToStyleArray(this.toString())}
Object.prototype.ToStyleArray = function(){return _.ToStyleArray(this)}

//_.ToDataArray()
String.prototype.ToDataArray = function(){return _.ToDataArray(this.toString())}
Object.prototype.ToDataArray = function(){return _.ToDataArray(this)}

//_.ToString
Array.prototype.ToString = function(del,kvdel){return _.ToString(this,del,kvdel)}
Object.prototype.ToString = function(del,kvdel){return _.ToString(this,del,kvdel)}

//_.ToStyleString
Array.prototype.ToStyleString = function(){return _.ToStyleString(this)}
Object.prototype.ToStyleString = function(){return _.ToStyleString(this)}

//_.ToDataString
Array.prototype.ToDataString = function(){return _.ToDataString(this)}
Object.prototype.ToDataString = function(){return _.ToDataString(this)}

//_.Style
/*Object.prototype.Style = function(styl){_.Style(this,styl)}
String.prototype.Style = function(styl){_.Style(this.toString(),styl)}
Array.prototype.Style = function(styl){_.Style(this,styl)}*/
"Style".Globalize({
    set:function(styl){_.Style(This(this),styl);},
    get:function(){return _.Style(This(this));}
},[Array,Object,String]);

"length".Globalize({
    get:function(){
        if (!Object.keys) {
        Object.keys = function (obj) {
            var keys = [],
                k;
            for (k in obj) {
                if (Object.prototype.hasOwnProperty.call(obj, k)) {
                    keys.push(k);
                }
            }
            return keys;
        };
    }
    return Object.keys(This(this)).length;
}
},[Object])



//_.ToNumber
String.prototype.ToNumber = function(type){return _.ToNumber(this.toString(),type);}
Object.prototype.ToNumber = function(type){return _.ToNumber(this,type);}
Array.prototype.ToNumber = function(type){return _.ToNumber(this,type);}
Number.prototype.ToNumber = function(type){return _.ToNumber(this.toString(),type);}

//_.ToFloat
String.prototype.ToFloat = function(){return _.ToNumber(this.toString());}
Object.prototype.ToFloat = function(){return _.ToNumber(this);}
Array.prototype.ToFloat = function(){return _.ToNumber(this);}
Number.prototype.ToFloat = function(){return _.ToNumber(this.toString());}

//_.ToInteger
String.prototype.ToInteger = function(){return _.ToNumber(this.toString(),2);}
Object.prototype.ToInteger = function(){return _.ToNumber(this,2);}
Array.prototype.ToInteger = function(){return _.ToNumber(this,2);}
Number.prototype.ToInteger = function(){return _.ToNumber(this.toString(),2);}

//#_.Attribute
"Attribute".Globalize(function(attr,value){return _.Attribute(This(this),attr,value);},[String,Array,Object]);

//_.UrlSplit
"UrlSplit".Globalize(function(){return _.UrlSplit(this.toString())},[String])

//#_.ID
"ID".Globalize({
    set:function(val){_.ID(This(this),val);},
    get:function(){return _.ID(This(this));}
},[Array,Object,String])
//"ID".Globalize(function(){return _.ID(This(this))},[String,Object,Array])

//_.BrowseSetFile
"Browse".Globalize(function(param){return _.BrowseSetFile(This(this),param)},[String,Object,Array])

//_.BrowseInto
"BrowseInto".Globalize(function(param){return _.BrowseInto(This(this),param)},[String,Object,Array])

//_.Fit
"Fit".Globalize(function(pelem){return _.Fit(This(this),pelem)},[String,Object])

//#_.Dimension
"Dimension".Globalize({
    get:function(){return _.Dimension(This(this))}
},[String,Object,Array]);

//_.Draggable
"Draggable".Globalize(function(param){return _.Draggable(This(this),param)},[String,Object,Array]);

//_.Assign
"Assign".Globalize(function(eventName,handler,once){return _.Engine.Handlers.Assign(eventName,This(this),handler,once);},[String,Object,Array]);

//_.UnAssign
"UnAssign".Globalize(function(eventName,handler){return _.Engine.Handlers.UnAssign(eventName,This(this),handler);},[String,Object,Array]);

//_.AssignOnce
"AssignOnce".Globalize(function(eventName,handler){return _.AssignOnce(eventName,This(this),handler);},[String,Object,Array]);

//_.ToExcel
"ToExcel".Globalize(function(sheetname){return _.ToExcel(This(this),sheetname);},[String,Object,Array]);

//_.OnScroll
"OnScroll".Globalize(function(func){return _.OnScroll(func,This(this));},[String,Object,Array]);

//_.ZoomIn
"ZoomIn".Globalize(function(){ 
    _.QuickAnimation(This(this),{
        Effect:"ZoomIn",
        Duration:0.8,
        OnStart:function(obj){obj.Target.Show()}
        //,OnEnd:function(obj){obj.Target.Style = "transform:scale(1)"}
    });
},[String,Object,Array]);
//_.ZoomOut
"ZoomOut".Globalize(function(){ 
    _.QuickAnimation(This(this),{
        Effect:"ZoomOut",
        Duration:0.6,
        OnEnd:function(obj){obj.Target.Hide();//obj.Target.Style = "transform:scale(0)"
    }
    });
},[String,Object,Array]);
//_.FadeIn
"FadeIn".Globalize(function(){ 
    _.QuickAnimation(This(this),{
        Effect:"FadeIn",
        Duration:0.8,
        OnStart:function(obj){obj.Target.Show()}
        //,OnEnd:function(obj){obj.Target.Style = "opacity:1"}
    });
},[String,Object,Array]);
//_.FadeOut
"FadeOut".Globalize(function(){ 
    _.QuickAnimation(This(this),{
        Effect:"FadeOut",
        Duration:0.6,
        OnEnd:function(obj){obj.Target.Hide()}
    });
},[String,Object,Array]);
//_.LeftIn
"LeftIn".Globalize(function(){ 
    _.QuickAnimation(This(this),{
        Effect:"LeftIn",
        Duration:0.8,
        OnStart:function(obj){obj.Target.Show()}
    });
},[String,Object,Array]);
//_.LeftOut
"LeftOut".Globalize(function(){ 
    _.QuickAnimation(This(this),{
        Effect:"LeftOut",
        Duration:0.6,
        OnEnd:function(obj){obj.Target.Hide()}
    });
},[String,Object,Array]);
//_.RightIn
"RightIn".Globalize(function(){ 
    _.QuickAnimation(This(this),{
        Effect:"RightIn",
        Duration:0.8,
        OnStart:function(obj){obj.Target.Show()}
    });
},[String,Object,Array]);
//_.RightOut
"RightOut".Globalize(function(){ 
    _.QuickAnimation(This(this),{
        Effect:"RightOut",
        Duration:0.6,
        OnEnd:function(obj){obj.Target.Hide()}
    });
},[String,Object,Array]);
//_.TopIn
"TopIn".Globalize(function(){ 
    _.QuickAnimation(This(this),{
        Effect:"TopIn",
        Duration:0.8,
        OnStart:function(obj){obj.Target.Show()}
    });
},[String,Object,Array]);
//_.TopOut
"TopOut".Globalize(function(){ 
    _.QuickAnimation(This(this),{
        Effect:"TopOut",
        Duration:0.6,
        OnEnd:function(obj){obj.Target.Hide()}
    });
},[String,Object,Array]);
//_.BottomIn
"BottomIn".Globalize(function(){ 
    _.QuickAnimation(This(this),{
        Effect:"BottomIn",
        Duration:0.8,
        OnStart:function(obj){obj.Target.Show()}
    });
},[String,Object,Array]);
//_.BottomOut
"BottomOut".Globalize(function(){ 
    _.QuickAnimation(This(this),{
        Effect:"BottomOut",
        Duration:0.6,
        OnEnd:function(obj){obj.Target.Hide()}
    });
},[String,Object,Array]);
//_.BounceIn
"BounceIn".Globalize(function(){ 
    _.QuickAnimation(This(this),{
        Effect:"BounceIn",
        Duration:0.8,
        OnStart:function(obj){obj.Target.Show()}
    });
},[String,Object,Array]);
//_.BounceOut
"BounceOut".Globalize(function(){ 
    _.QuickAnimation(This(this),{
        Effect:"BounceOut",
        Duration:0.6,
        OnEnd:function(obj){obj.Target.Hide()}
    });
},[String,Object,Array]);



//End Globals
//*********************** */


//Aim Usages
/*********************************** */
//Fontawsome Icons html - using Aim Template
_.Template.Add('FA','<i class="fa fa-{{FA}}" aria-hidden="true"></i>');
_.Include({
    Icon:function(FAstr){
      return _.Template.Fill('FA',{FA:FAstr})
    }
});
String.prototype.Icon = function(){return _.Icon(this.toString())}

//Include AIm Alert method (uses the user design alert else use js alert)
_.Include({
    Alert:function(abody,atitle,alertcont){
         if(typeof abody == _.UND || abody.Trim() == "")return; //if no body content found
         atitle = atitle || "Message"; //if no title sent, use 'Message'
         alertcont = alertcont || ""; 
         //if a specific alert is specified
         alertcont = alertcont.Trim() != ""?"-"+alertcont:"";
        //get the user desinged alert
        var popind = _('aim-alert-ind'+alertcont);
        if(_.IsFound(popind)){ //if exist
            popind = _.IsArray(popind)?popind[0]:popind; //if multiple gotten use the first one
           var userpopup = popind.nextElementSibling; //get the popup markup
           //get the total alert opened (so as to set the new alert z-index to be higher)
           var allalert = _('aim-alert-ind');
           var zind = 1000;
           //var zind = 
           if(_.IsArray(allalert)){
              // _.Log(userpopup.ID + " opened");
               for(var oal =0; oal<allalert.length;oal++){
                   //_.Log(allalert[oal].nextElementSibling.ID + " : "+ allalert[oal].nextElementSibling.style.display)
                  // var displayval = window.getComputedStyle(allalert[oal].nextElementSibling, null).getPropertyValue("display");
                   var nzind = _.ToInteger(allalert[oal].nextElementSibling.style.zIndex);
                   if(nzind > zind)zind=nzind;
                  // _.Log(allalert[oal].nextElementSibling.ID + " : "+ displayval);
               }
           }
           //get the popup title and fill it
           var poptit = _("#"+userpopup.ID+" .aim-alert-title"); //get the title
           if(_.IsFound(poptit)){//if title container exist
            poptit = _.IsArray(poptit)?poptit:[poptit];
            for(var pt=0;pt<poptit.length;pt++){
                poptit[pt].parentElement.innerHTML = '<input type="hidden" class="aim-alert-title" />'+atitle;
            }
            
           }
           
           //get the popup body and fill it
           var popbody = _("#"+userpopup.ID+" .aim-alert-body");
           if(_.IsFound(popbody)){
            popbody = _.IsArray(popbody)?popbody:[popbody];
            for(var pb=0;pb<popbody.length;pb++){
                popbody[pb].parentElement.innerHTML = '<input type="hidden" class="aim-alert-body" />'+abody;
            }
           }
           //document.getElementById().style.zIndex
           //set the zindex
           userpopup.style.zIndex = (zind + 1) + ""; 
           userpopup.Show();
           _.Engine.Proccessor.Init(userpopup);
        }else{
            if(alertcont != ""){ //if a specific alert specified
                _.Alert(abody,atitle); //try agian to use the first alert
                return;
            }
            //if no user alert exist
            alert(abody);
        }
    },
    //Method to display loading when aim object (datafill) is run
    StartWork:function(msg,workID,cancelfunc){
        if(typeof workID == _.UND)return;
        var Memory = _.Engine.Proccessor.Memory;
        var Param = _.Engine.Proccessor.Modules['aim-datafill'].Param[workID];
        msg = msg || "";
        cancelfunc = typeof cancelfunc == _.UND? function(){}:cancelfunc;
         //check if the work is currently on (Finish/Terminate it to start new)
         if(typeof Memory['aim-working-'+workID] != _.UND && Memory['aim-working-'+workID] != null){
            //i.e aim is still working on the object
            var finishwork = _.FinishWork(workID);
        }
        //keep the workID with cancel function in Memory
    Memory['aim-working-'+workID] = cancelfunc;

    if(typeof Param != _.UND && Param.Silent){
       return;
    }
        
        //display the message
        //Get the aim-loading markup (object)
        var aimloadingobj = _('aim-general-loading');
        if(_.IsFound(aimloadingobj)){ //if exist
            aimloadingobj = _.IsArray(aimloadingobj)?aimloadingobj[0]:aimloadingobj;
           
            //get/clone the inner item display
            var inneritem = aimloadingobj._('aim-general-loading-item');
            if(_.IsFound(inneritem)){ //if an inner template exist
                totav = 1; //hold the total item displayed including the hidden template
                if(_.IsArray(inneritem)){
                    totav = inneritem.length;
                    inneritem = inneritem[0];
                }
                //clone a copy
                var inneritemcopy = inneritem.Cloner();
                //set its id
                inneritemcopy.id = 'aim-general-loading-item-'+workID;
                //set its display state to show
                inneritemcopy.style.display='block';
                //set the id of its close element
                var closeelement = inneritemcopy._('aim-general-loading-close');
                if(_.IsFound(closeelement)){
                    closeelement = _.IsArray(closeelement)?closeelement[0]:closeelement;
                    closeelement.id = 'aim-general-loading-close-'+workID;
                    //assign function to the close element
                    closeelement.Assign('click',function(e){
                        var elem = e.currentTarget;
                        _.FinishWork(elem.id.TrimLeft('aim-general-loading-close-'));
                    })
                }
                //set the content item
                var contelement = inneritemcopy._('aim-general-loading-content');
                if(_.IsFound(contelement)){
                    contelement = _.IsArray(contelement)?contelement[0]:contelement;
                    contelement.id = 'aim-general-loading-content'+workID;
                    //set the message
                    contelement.innerHTML = msg;
                }
                //Add the item to the aim loading object
                aimloadingobj.insertAdjacentElement('beforeend',inneritemcopy);
                if(aimloadingobj.style.display = 'none')aimloadingobj.Show();
            }
        }
    },
    //Function to end aim work
    FinishWork:function(workID){
        var Memory = _.Engine.Proccessor.Memory;
        var Param = _.Engine.Proccessor.Modules['aim-datafill'].Param[workID];
        if(typeof Param != _.UND && Param.Silent){ //if silent mode (no loading popup displayed) , just terminate the operation
         //get the function to run sending the work id
         var rtn = Memory['aim-working-'+workID](workID);
        }else{
        //get the close button
        var aimloadingobj = _('aim-general-loading');
        if(_.IsFound(aimloadingobj)){ //if exist
            aimloadingobj = _.IsArray(aimloadingobj)?aimloadingobj[0]:aimloadingobj;
        var elem = aimloadingobj._('aim-general-loading-item-'+workID);
        if(_.IsFound(elem)){
            ///var elemid = elem.id;
                        //split the close element id to get the work id
                       /// var workid = elemid.TrimLeft('aim-general-loading-close-');
                        //var workid = elemidarr[4];
                        //alert(workid)
                        //get the function to run sending the work id
                        var rtn = Memory['aim-working-'+workID](workID);
                        if(rtn !== false){
                            //get all opened item including the template
                            var numofopened = elem.parentElement._('aim-general-loading-item');
                            //remove the item container
                            elem.parentElement.removeChild(elem);
                            
                            if(_.IsArray(numofopened) && numofopened.length > 1){ //if exist
                             
                            }else{
                                elem.parentElement.Hide();
                            }
                        }
        }

        }
    }
        Memory['aim-working-'+workID] = null; //set the working run function to null (indicating work ended)
        return true;
    }
})
/*********************************** */








//Work around function (Backward Compactibility)
/************************************************* */
var _UND = _.UND;
var Icon = _.Icon;
var IsArray = _.IsArray;
var IsNumber = _.IsNumber;
var IsString = _.IsString;
var IsObject = _.IsObject;
var IsFunction = _.IsFunction;
var IsNull = Null = _.IsNull;
var IsSet = _.IsSet;
String.prototype.StrTrimLeft = function(n){_.TrimLeft(this.toString(),n)}
Object.prototype.StrTrimLeft = function(n){_.TrimLeft(this,n)}
Array.prototype.StrTrimLeft = function(n){_.TrimLeft(this,n)}

String.prototype.StrTrimRight = function(n){_.TrimRight(this.toString(),n)}
Object.prototype.StrTrimRight = function(n){_.TrimRight(this,n)}
Array.prototype.StrTrimRight = function(n){_.TrimRight(this,n)}

var IsPhoneNumber = _.IsPhoneNumber;
Array.prototype.InArray = function(obj){
    var rst = _.InItem(this,obj);
  return rst === false?{"Exist":false,"Index":-1}:{"Exist":true,"Index":rst};
}
Array.prototype.IndexOf = function(obj){
    var rst = _.InItem(this,obj);
  return rst === false?-1:rst;
}
//**************************************** */



//The Main Aim Startup Script
/****************************************** */
//Starting Aim
//#Aim.Start #Start 
_.Engine.Dom.ReadyList = [];
  //1. The aim loader starts
var starter = _.Engine.Dom.Loader.Start();

if(starter){
    if(_.Engine.Dom.Loader.JSOnly == false){
    //When all DOM element are loaded
    _.Ready(function(){
        //NB: at the end of execution(all ajax are returned) of the Registered method _.Engine.InitManager.Complete() must be called

    //Register Printer Initialization Module
    _.Engine.InitManager.Register("Printer",_.Engine.Printer.Init);
    //Register Proccessor Initialization Module
    _.Engine.InitManager.Register("Proccessor",_.Engine.Proccessor.Init);

    //Start Initialization
    _.Engine.InitManager.Start();
    
    
      //mutationObserver.disconnect();
});
}
}


//************************************* */

/* if(!isset($_SESSION['UDet']))return ["Failed"=>["LoginName"=>"","Message"=>" Login Details not Found"]];
$uderdet = json_decode($_SESSION['UDet'],true);
$mdacond = $uderdet['MDAScope'] == "LIMITED"?"MinID=".$uderdet['MDAID']:""; */



